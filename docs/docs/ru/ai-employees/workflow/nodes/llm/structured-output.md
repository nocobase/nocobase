---
pkg: "@nocobase/plugin-ai-ee"
---
:::tip Уведомление о переводе ИИ
Эта документация была автоматически переведена ИИ.
:::


# Структурированный вывод

## Введение

В некоторых сценариях применения пользователи могут захотеть, чтобы модель LLM отвечала структурированным содержимым в формате JSON. Это можно реализовать, настроив «Структурированный вывод».

![](https://static-docs.nocobase.com/202503041306405.png)

## Настройка

- **JSON Schema** - Вы можете задать ожидаемую структуру ответа модели, настроив [JSON Schema](https://json-schema.org/).
- **Имя (Name)** - _Необязательно_, используется для того, чтобы помочь модели лучше понять объект, представленный JSON Schema.
- **Описание (Description)** - _Необязательно_, используется для того, чтобы помочь модели лучше понять назначение JSON Schema.
- **Strict** - Требует от модели генерировать ответ строго в соответствии со структурой JSON Schema. В настоящее время этот параметр поддерживается только некоторыми новыми моделями OpenAI. Пожалуйста, убедитесь, что ваша модель совместима, прежде чем включать его.

## Способ генерации структурированного содержимого

Способ генерации структурированного содержимого моделью зависит от используемой **модели** и её конфигурации **Response format**:

1. Модели, в которых Response format поддерживает только `text`
   - При вызове узел привяжет инструмент (Tool), который генерирует содержимое в формате JSON на основе JSON Schema, направляя модель на создание структурированного ответа путём вызова этого инструмента.

2. Модели, в которых Response format поддерживает режим JSON (`json_object`)
   - Если при вызове выбран режим JSON, вам необходимо явно указать модели в Prompt возвращать данные в формате JSON и предоставить описания для полей ответа.
   - В этом режиме JSON Schema используется только для разбора JSON-строки, возвращаемой моделью, и её преобразования в целевой JSON-объект.

3. Модели, в которых Response format поддерживает JSON Schema (`json_schema`)
   - JSON Schema напрямую используется для указания целевой структуры ответа для модели.
   - Необязательный параметр **Strict** требует от модели строго следовать JSON Schema при генерации ответа.

4. Локальные модели Ollama
   - Если настроена JSON Schema, при вызове узел передаст её в модель в качестве параметра `format`.

## Использование результата структурированного вывода

Структурированное содержимое ответа модели сохраняется в виде JSON-объекта в поле «Structured content» узла и может быть использовано последующими узлами.

![](https://static-docs.nocobase.com/202503041330291.png)

![](https://static-docs.nocobase.com/202503041331279.png)