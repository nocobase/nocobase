---
pkg: '@nocobase/plugin-workflow-response-message'
---
:::tip Уведомление о переводе ИИ
Эта документация была автоматически переведена ИИ.
:::


# Ответное сообщение

## Введение

Узел ответного сообщения используется для отправки пользовательских сообщений из рабочего процесса клиенту, инициировавшему действие, в определённых типах рабочих процессов.

:::info{title=Примечание}
В настоящее время поддерживается для использования в синхронном режиме в рабочих процессах типа «Событие перед действием» и «Пользовательское событие действия».
:::

## Создание узла

В поддерживаемых типах рабочих процессов вы можете добавить узел «Ответное сообщение» в любом месте рабочего процесса. Нажмите кнопку плюса («+») в рабочем процессе, чтобы добавить узел «Ответное сообщение».

![Добавление узла](https://static-docs.nocobase.com/eac2b3562e95e4ce59f340624062ed3d.png)

Ответное сообщение существует в виде массива на протяжении всего процесса запроса. При каждом выполнении узла ответного сообщения в рабочий процесс новое содержимое сообщения добавляется в этот массив. Когда сервер отправляет ответ, все сообщения отправляются клиенту вместе.

## Настройка узла

Содержимое сообщения представляет собой шаблонную строку, в которую можно вставлять переменные. Вы можете свободно организовывать содержимое этого шаблона в настройках узла.

![Настройка узла](https://static-docs.nocobase.com/d5fa5f4002d50baf3ba16048818fddfc.png)

Когда рабочий процесс достигает этого узла, шаблон анализируется, и генерируется содержимое сообщения. В приведённой выше конфигурации переменная «Локальная переменная / Цикл по всем продуктам / Объект цикла / Продукт / Заголовок» будет заменена конкретным значением в реальном рабочем процессе, например:

```
Продукт «iPhone 14 pro» отсутствует на складе
```

![Содержимое сообщения](https://static-docs.nocobase.com/06bd4a6b6ec499c853f0c39987f63a6a.png)

## Настройка рабочего процесса

Статус ответного сообщения зависит от успешного или неуспешного выполнения рабочего процесса. Сбой выполнения любого узла приведёт к сбою всего рабочего процесса. В этом случае содержимое сообщения будет возвращено клиенту со статусом сбоя и отображено.

Если вам нужно активно определить состояние сбоя в рабочем процессе, вы можете использовать «Конечный узел» и настроить его на состояние сбоя. При выполнении этого узла рабочий процесс завершится со статусом сбоя, и сообщение будет возвращено клиенту со статусом сбоя.

Если весь рабочий процесс не привёл к состоянию сбоя и успешно завершился, содержимое сообщения будет возвращено клиенту со статусом успеха.

:::info{title=Примечание}
Если в рабочем процессе определено несколько узлов ответных сообщений, выполненные узлы будут добавлять содержимое сообщения в массив. При окончательном возврате клиенту всё содержимое сообщения будет возвращено и отображено вместе.
:::

## Сценарии использования

### Рабочий процесс «Событие перед действием»

Использование ответного сообщения в рабочем процессе «Событие перед действием» позволяет отправлять соответствующую обратную связь клиенту после завершения рабочего процесса. Подробнее см. в разделе [Событие перед действием](../triggers/pre-action.md).

### Рабочий процесс «Пользовательское событие действия»

Использование ответного сообщения в «Пользовательском событии действия» в синхронном режиме позволяет отправлять соответствующую обратную связь клиенту после завершения рабочего процесса. Подробнее см. в разделе [Пользовательское событие действия](../triggers/custom-action.md).