:::tip Уведомление о переводе ИИ
Эта документация была автоматически переведена ИИ.
:::

## Расширенные возможности

### Нумерация страниц

#### 1. Обновление номеров страниц

##### Синтаксис
Просто добавьте его в вашем офисном приложении.

##### Пример
В Microsoft Word:
- Используйте функцию «Вставка → Номера страниц».  
В LibreOffice:
- Используйте функцию «Вставка → Поля → Номер страницы».

##### Результат
В сгенерированном отчете номера страниц будут обновляться автоматически.


#### 2. Создание оглавления

##### Синтаксис
Просто добавьте его в вашем офисном приложении.

##### Пример
В Microsoft Word:
- Используйте функцию «Вставка → Оглавление и указатели → Оглавление».  
В LibreOffice:
- Используйте функцию «Вставка → Оглавления и указатели → Оглавление, указатель или библиография».

##### Результат
Оглавление отчета будет автоматически обновляться в соответствии с содержимым документа.


#### 3. Повторяющиеся заголовки таблиц

##### Синтаксис
Просто добавьте его в вашем офисном приложении.

##### Пример
В Microsoft Word:
- Щелкните правой кнопкой мыши по заголовку таблицы → Свойства таблицы → Установите флажок «Повторять как строку заголовка на каждой странице».  
В LibreOffice:
- Щелкните правой кнопкой мыши по заголовку таблицы → Свойства таблицы → Вкладка «Обтекание» → Установите флажок «Повторять заголовок».

##### Результат
Когда таблица занимает несколько страниц, ее заголовок автоматически повторяется в верхней части каждой страницы.


### Интернационализация (i18n)

#### 1. Перевод статического текста

##### Синтаксис
Используйте тег `{t(текст)}` для интернационализации статического текста:
```
{t(meeting)}
```

##### Пример
В шаблоне:
```
{t(meeting)} {t(apples)}
```
Данные JSON или внешний словарь локализации (например, для "fr-fr") предоставляют соответствующие переводы, такие как "meeting" → "rendez-vous" и "apples" → "Pommes".

##### Результат
При генерации отчета текст будет заменен соответствующим переводом в зависимости от целевого языка.


#### 2. Перевод динамического текста

##### Синтаксис
Для содержимого данных используйте форматтер `:t`, например:
```
{d.id:ifEQ(2):show({t(monday)}):elseShow({t(tuesday)})}
```

##### Пример
В шаблоне:
```
{d.id:ifEQ(2):show({t(monday)}):elseShow({t(tuesday)})}
```
Данные JSON и словарь локализации предоставляют соответствующие переводы.

##### Результат
В зависимости от условия будет выведено «lundi» или «mardi» (на примере целевого языка).


### Сопоставление ключ-значение

#### 1. Преобразование перечислений (:convEnum)

##### Синтаксис
```
{данные:convEnum(имяПеречисления)}
```
Например:
```
0:convEnum('ORDER_STATUS')
```

##### Пример
В примере параметров API передается следующее:
```json
{
  "enum": {
    "ORDER_STATUS": ["pending", "sent", "delivered"]
  }
}
```
В шаблоне:
```
0:convEnum('ORDER_STATUS')
```

##### Результат
Выводит «pending»; если индекс выходит за пределы диапазона перечисления, выводится исходное значение.


### Динамические изображения
:::info
В настоящее время поддерживаются файлы типов XLSX и DOCX.
:::
Вы можете вставлять «динамические изображения» в шаблоны документов. Это означает, что изображения-заполнители в шаблоне будут автоматически заменены реальными изображениями во время рендеринга на основе данных. Этот процесс очень прост и требует всего лишь:

1. Вставить временное изображение в качестве заполнителя.

2. Отредактировать «Альтернативный текст» этого изображения, чтобы задать метку поля.

3. Отрендерить документ, и система автоматически заменит его фактическим изображением.

Ниже мы подробно рассмотрим методы работы с файлами DOCX и XLSX на конкретных примерах.


#### Вставка динамических изображений в файлы DOCX
##### Замена одного изображения

1. Откройте ваш шаблон DOCX и вставьте временное изображение (это может быть любое изображение-заполнитель, например, [однотонное синее изображение](https://static-docs.nocobase.com/solid-color-image-2025-04-14-11-00-26.png)).

:::info
**Инструкции по формату изображений**

- В настоящее время изображения-заполнители поддерживают только формат PNG. Рекомендуем использовать наш пример [однотонного синего изображения](https://static-docs.nocobase.com/solid-color-image-2025-04-14-11-00-26.png).
- Целевые изображения для рендеринга поддерживают только форматы PNG, JPG, JPEG. Изображения других типов могут не отображаться.

**Инструкции по размеру изображений**

Как для DOCX, так и для XLSX, окончательный размер изображения при рендеринге будет соответствовать размерам временного изображения в шаблоне. Это означает, что фактически заменяемое изображение будет автоматически масштабироваться до размера вставленного вами изображения-заполнителя. Если вы хотите, чтобы размер отрендеренного изображения был 150×150, используйте временное изображение в шаблоне и настройте его до этого размера.
:::

2. Щелкните правой кнопкой мыши по этому изображению, отредактируйте его «Альтернативный текст» и введите метку поля изображения, которое вы хотите вставить, например `{d.imageUrl}`:
   
![20250414211130-2025-04-14-21-11-31](https://static-docs.nocobase.com/20250414211130-2025-04-14-21-11-31.png)

3. Используйте следующие примеры данных для рендеринга:
```json
{
  "name": "Apple",
  "imageUrl": "https://images.pexels.com/photos/206959/pexels-photo-206959.jpeg",
}
```

4. В отрендеренном результате временное изображение будет заменено фактическим:

![20250414203444-2025-04-14-20-34-46](https://static-docs.nocobase.com/20250414203444-2025-04-14-20-34-46.png)

##### Замена нескольких изображений в цикле

Если вы хотите вставить группу изображений в шаблон, например, список товаров, вы также можете реализовать это с помощью циклов. Конкретные шаги следующие:
1. Предположим, ваши данные выглядят следующим образом:
```json
{
  "products": [
    {
      "name": "Apple",
      "imageUrl": "https://images.pexels.com/photos/206959/pexels-photo-206959.jpeg",
    },
    {
      "name": "Banana",
      "imageUrl": "https://images.pexels.com/photos/61127/pexels-photo-61127.jpeg",
    },
  ]
}
```

2. Настройте область цикла в шаблоне DOCX и вставьте временные изображения в каждый элемент цикла с альтернативным текстом, установленным как `{d.products[i].imageUrl}`, как показано ниже:

![20250414205418-2025-04-14-20-54-19](https://static-docs.nocobase.com/20250414205418-2025-04-14-20-54-19.png)

3. После рендеринга все временные изображения будут заменены соответствующими изображениями из данных:
   
![20250414205503-2025-04-14-20-55-05](https://static-docs.nocobase.com/20250414205503-2025-04-14-20-55-05.png)

#### Вставка динамических изображений в файлы XLSX

Метод работы в шаблонах Excel (XLSX) в основном тот же, просто обратите внимание на следующие моменты:

1. После вставки изображения убедитесь, что вы выбрали «изображение в ячейке», а не изображение, плавающее над ячейкой.

![20250414211643-2025-04-14-21-16-45](https://static-docs.nocobase.com/20250414211643-2025-04-14-21-16-45.png)

2. После выбора ячейки нажмите, чтобы просмотреть «Альтернативный текст» и ввести метку поля, например `{d.imageUrl}`.

### Штрихкоды
:::info
В настоящее время поддерживаются файлы типов XLSX и DOCX.
:::

#### Генерация штрихкодов (например, QR-кодов)

Генерация штрихкодов работает так же, как и динамические изображения, и требует всего трех шагов:

1. Вставьте временное изображение в шаблон, чтобы отметить местоположение штрихкода.

2. Отредактируйте «Альтернативный текст» изображения и введите метку поля формата штрихкода, например `{d.code:barcode(qrcode)}`, где `qrcode` — это тип штрихкода (см. список поддерживаемых типов ниже).

![20250414214626-2025-04-14-21-46-28](https://static-docs.nocobase.com/20250414214626-2025-04-14-21-46-28.png)

3. После рендеринга изображение-заполнитель будет автоматически заменено соответствующим изображением штрихкода:
   
![20250414214925-2025-04-14-21-49-26](https://static-docs.nocobase.com/20250414214925-2025-04-14-21-49-26.png)

#### Поддерживаемые типы штрихкодов

| Название штрихкода | Тип    |
| ------------------ | ------ |
| QR-код             | qrcode |