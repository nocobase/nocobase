---
pkg: '@nocobase/plugin-auth-wecom'
---
:::tip Уведомление о переводе ИИ
Эта документация была автоматически переведена ИИ.
:::



# Аутентификация: WeCom

## Введение

Плагин **WeCom** позволяет пользователям входить в NocoBase, используя свои аккаунты WeCom.

## Активация плагина

![](https://static-docs.nocobase.com/202406272056962.png)

## Создание и настройка собственного приложения WeCom

Перейдите в панель управления WeCom, чтобы создать собственное приложение.

![](https://static-docs.nocobase.com/202406272101321.png)

![](https://static-docs.nocobase.com/202406272102087.png)

Нажмите на приложение, чтобы перейти на страницу его сведений, прокрутите страницу вниз и нажмите «Авторизованный вход WeCom».

![](https://static-docs.nocobase.com/202406272104655.png)

Установите авторизованный домен обратного вызова на домен вашего приложения NocoBase.

![](https://static-docs.nocobase.com/202406272105662.png)

Вернитесь на страницу сведений о приложении и нажмите «Веб-авторизация и JS-SDK».

![](https://static-docs.nocobase.com/202406272107063.png)

Установите и подтвердите домен обратного вызова для функции веб-авторизации OAuth2.0 приложения.

![](https://static-docs.nocobase.com/202406272107899.png)

На странице сведений о приложении нажмите «Доверенный IP компании».

![](https://static-docs.nocobase.com/202406272108834.png)

Настройте IP-адрес приложения NocoBase.

![](https://static-docs.nocobase.com/202406272109805.png)

## Получение учетных данных из панели управления WeCom

В панели управления WeCom, в разделе «Моя компания», скопируйте «ID компании».

![](https://static-docs.nocobase.com/202406272111637.png)

В панели управления WeCom, в разделе «Управление приложениями», перейдите на страницу сведений о приложении, созданном на предыдущем шаге, и скопируйте AgentId и Secret.

![](https://static-docs.nocobase.com/202406272122322.png)

## Добавление аутентификации WeCom в NocoBase

Перейдите на страницу управления плагинами пользовательской аутентификации.

![](https://static-docs.nocobase.com/202406272115044.png)

Добавить - WeCom

![](https://static-docs.nocobase.com/202406272115805.png)

### Конфигурация

![](https://static-docs.nocobase.com/202412041459250.png)

| Параметр                                                                                              | Описание                                                                                                                                                                                      | Требования к версии |
| ----------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------- |
| Когда номер телефона не соответствует существующему пользователю, <br />следует ли автоматически создавать нового пользователя | Будет ли автоматически создан новый пользователь, если номер телефона не соответствует существующему.                                                                                        | -                   |
| ID компании                                                                                           | ID компании, полученный из панели управления WeCom.                                                                                                                                           | -                   |
| AgentId                                                                                               | Получено из конфигурации собственного приложения в панели управления WeCom.                                                                                                                  | -                   |
| Secret                                                                                                | Получено из конфигурации собственного приложения в панели управления WeCom.                                                                                                                  | -                   |
| Origin                                                                                                | Домен текущего приложения.                                                                                                                                                                    | -                   |
| Ссылка для перенаправления приложения рабочего стола                                                  | Путь приложения, на который будет выполнено перенаправление после успешного входа.                                                                                                            | `v1.4.0`            |
| Автоматический вход                                                                                   | Автоматический вход при открытии ссылки приложения в браузере WeCom. Если настроено несколько аутентификаторов WeCom, только один может иметь эту опцию включенной.                          | `v1.4.0`            |
| Ссылка на домашнюю страницу приложения рабочего стола                                                 | Ссылка на домашнюю страницу приложения рабочего стола.                                                                                                                                        | -                   |

## Настройка домашней страницы приложения WeCom

:::info
Для версий `v1.4.0` и выше, когда опция «Автоматический вход» включена, ссылка на домашнюю страницу приложения может быть упрощена до: `https://<url>/<path>`, например, `https://example.nocobase.com/admin`.

Вы также можете настроить отдельные ссылки для мобильных и настольных устройств, например, `https://example.nocobase.com/m` и `https://example.nocobase.com/admin`.
:::

Перейдите в панель управления WeCom и вставьте скопированную ссылку на домашнюю страницу приложения рабочего стола в поле адреса домашней страницы соответствующего приложения.

![](https://static-docs.nocobase.com/202406272123631.png)

![](https://static-docs.nocobase.com/202406272123048.png)

## Вход

Перейдите на страницу входа и нажмите кнопку под формой входа, чтобы начать вход через сторонний сервис.

![](https://static-docs.nocobase.com/202406272124608.png)

:::warning
Из-за ограничений разрешений WeCom на конфиденциальную информацию, такую как номера телефонов, авторизация может быть завершена только в клиенте WeCom. При первом входе с помощью WeCom, пожалуйста, следуйте инструкциям ниже, чтобы завершить первоначальную авторизацию в клиенте WeCom.
:::

## Первый вход

Из клиента WeCom перейдите в «Рабочий стол», прокрутите вниз и нажмите на приложение, чтобы перейти на домашнюю страницу, которую вы ранее настроили. Это завершит первоначальную авторизацию. После этого вы сможете использовать WeCom для входа в ваше приложение NocoBase.

<img src="https://static-docs.nocobase.com/202406272131113.png" width="400" />