---
pkg: "@nocobase/plugin-environment-variables"
---
:::tip Уведомление о переводе ИИ
Эта документация была автоматически переведена ИИ.
:::



# Переменные и секреты

## Введение

Централизованная настройка и управление переменными окружения и секретами для хранения конфиденциальных данных, повторного использования конфигурационных данных и изоляции конфигураций окружения.

## Отличия от `.env`

| **Характеристика**               | **Файл `.env`**                                                                                    | **Динамически настраиваемые переменные и секреты**                                                                                                                |
| ------------------------- | -------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Место хранения**      | Хранятся в файле `.env` в корневом каталоге проекта                                            | Хранятся в таблице `environmentVariables` базы данных                                                                                                      |
| **Метод загрузки**        | Загружаются в `process.env` с помощью таких инструментов, как `dotenv`, при запуске приложения                     | Динамически считываются и загружаются в `app.environment` при запуске приложения                                                                                   |
| **Метод изменения**   | Требуется прямое редактирование файла, изменения вступают в силу только после перезапуска приложения | Поддерживается изменение во время выполнения, изменения вступают в силу сразу после перезагрузки конфигурации приложения                                                    |
| **Изоляция окружений** | Каждое окружение (разработка, тестирование, производство) требует отдельного обслуживания файлов `.env`  | Каждое окружение (разработка, тестирование, производство) требует отдельного обслуживания данных в таблице `environmentVariables`                                   |
| **Сценарии применения**  | Подходит для фиксированных статических конфигураций, например, для основной информации о базе данных приложения    | Подходит для динамических конфигураций, требующих частых корректировок или связанных с бизнес-логикой, например, для информации о внешних базах данных, файловых хранилищах и т.д. |

## Установка

Это встроенный плагин, его не нужно устанавливать отдельно.

## Использование

### Повторное использование конфигурационных данных

Например, если в нескольких местах рабочего процесса требуются узлы электронной почты и настройка SMTP, общую конфигурацию SMTP можно сохранить в переменных окружения.

![20250102181045](https://static-docs.nocobase.com/20250102181045.png)

### Хранение конфиденциальных данных

Здесь можно хранить конфигурационную информацию различных внешних баз данных, ключи облачных файловых хранилищ и другие подобные данные.

![20250102103513](https://static-docs.nocobase.com/20250102103513.png)

### Изоляция конфигураций окружения

В различных окружениях, таких как разработка, тестирование и производство, используются независимые стратегии управления конфигурацией, чтобы настройки и данные каждого окружения не мешали друг другу. Каждое окружение имеет свои независимые настройки, переменные и ресурсы, что позволяет избежать конфликтов между окружениями разработки, тестирования и производства, а также гарантирует, что система работает должным образом в каждом из них.

Например, конфигурация для служб файлового хранилища может отличаться в окружениях разработки и производства, как показано ниже:

Окружение разработки

```bash
FILE_STORAGE_OSS_BASE_URL=dev-storage.nocobase.com
FILE_STORAGE_OSS_BUCKET=dev-storage
```

Рабочее окружение

```bash
FILE_STORAGE_OSS_BASE_URL=prod-storage.nocobase.com
FILE_STORAGE_OSS_BUCKET=prod-storage
```

## Управление переменными окружения

![20250102155314](https://static-docs.nocobase.com/20250102155314.png)

### Добавление переменных окружения

- Поддерживается добавление по одной и пакетное добавление
- Поддерживается хранение в открытом виде и в зашифрованном виде

![20250102155509](https://static-docs.nocobase.com/20250102155509.png)

Добавление по одной

![20250102155731](https://static-docs.nocobase.com/20250102155731.png)

Пакетное добавление

![20250102155258](https://static-docs.nocobase.com/20250102155258.png)

## Примечания

### Перезапуск приложения

После изменения или удаления переменных окружения вверху появится уведомление о необходимости перезапуска приложения. Изменения вступят в силу только после перезапуска.

![20250102155007](https://static-docs.nocobase.com/20250102155007.png)

### Зашифрованное хранение

Зашифрованные данные переменных окружения используют симметричное шифрование AES. ЗАКРЫТЫЙ КЛЮЧ для шифрования и дешифрования хранится в каталоге `storage`. Пожалуйста, храните его в безопасности; в случае потери или перезаписи зашифрованные данные не могут быть расшифрованы.

```bash
./storage/environment-variables/<app-name>/aes_key.dat
```

## Плагины, поддерживающие переменные окружения

### Действие: Пользовательский запрос

![20250102180751](https://static-docs.nocobase.com/20250102180751.png)

### Аутентификация: CAS

![20250102160129](https://static-docs.nocobase.com/20250102160129.png)

### Аутентификация: DingTalk

![20250102160205](https://static-docs.nocobase.com/20250102160205.png)

### Аутентификация: LDAP

![20250102160312](https://static-docs.nocobase.com/20250102160312.png)

### Аутентификация: OIDC

![20250102160426](https://static-docs.nocobase.com/20250102160426.png)

### Аутентификация: SAML

![20250102160652](https://static-docs.nocobase.com/20250102160652.png)

### Аутентификация: WeCom

![20250102160758](https://static-docs.nocobase.com/20250102160758.png)

### Источник данных: Внешняя MariaDB

![20250102160935](https://static-docs.nocobase.com/20250102160935.png)

### Источник данных: Внешний MySQL

![20250102173602](https://static-docs.nocobase.com/20250102173602.png)

### Источник данных: Внешний Oracle

![20250102174153](https://static-docs.nocobase.com/20250102174153.png)

### Источник данных: Внешний PostgreSQL

![20250102175630](https://static-docs.nocobase.com/20250102175630.png)

### Источник данных: Внешний SQL Server

![20250102175814](https://static-docs.nocobase.com/20250102175814.png)

### Источник данных: KingbaseES

![20250102175951](https://static-docs.nocobase.com/20250102175951.png)

### Источник данных: REST API

![20250102180109](https://static-docs.nocobase.com/20250102180109.png)

### Файловое хранилище: Локальное

![20250102161114](https://static-docs.nocobase.com/20250102161114.png)

### Файловое хранилище: Aliyun OSS

![20250102161404](https://static-docs.nocobase.com/20250102161404.png)

### Файловое хранилище: Amazon S3

![20250102163730](https://static-docs.nocobase.com/20250102163730.png)

### Файловое хранилище: Tencent COS

![20250102173109](https://static-docs.nocobase.com/20250102173109.png)

### Файловое хранилище: S3 Pro

Не адаптировано

### Карты: AMap

![20250102163803](https://static-docs.nocobase.com/20250102163803.png)

### Карты: Google

![20250102171524](https://static-docs.nocobase.com/20250102171524.png)

### Настройки электронной почты

Не адаптировано

### Уведомления: Электронная почта

![20250102164059](https://static-docs.nocobase.com/20250102164059.png)

### Публичные формы

![20250102163849](https://static-docs.nocobase.com/20250102163849.png)

### Системные настройки

![20250102164139](https://static-docs.nocobase.com/20250102164139.png)

### Верификация: Aliyun SMS

![20250102164247](https://static-docs.nocobase.com/20250102164247.png)

### Верификация: Tencent SMS

![20250102165814](https://static-docs.nocobase.com/20250102165814.png)

### Рабочий процесс

![20250102180537](https://static-docs.nocobase.com/20250102180537.png)