---
pkg: '@nocobase/plugin-migration-manager'
---
:::tip Уведомление о переводе ИИ
Эта документация была автоматически переведена ИИ.
:::


# Менеджер миграций

## Введение

Этот плагин позволяет переносить конфигурации приложений из одной среды в другую. Менеджер миграций в первую очередь ориентирован на перенос «конфигураций приложений». Если вам требуется полная миграция данных, мы рекомендуем использовать «[Менеджер резервного копирования](../backup-manager/index.mdx)» для создания резервных копий и восстановления всего приложения.

## Установка

Менеджер миграций зависит от плагина [Менеджер резервного копирования](../backup-manager/index.mdx). Пожалуйста, убедитесь, что этот плагин уже установлен и активирован.

## Принцип работы и процесс

Менеджер миграций переносит таблицы и данные из основной базы данных из одного приложения в другое, руководствуясь заданными правилами миграции. Обратите внимание, что данные из внешних баз данных и дочерних приложений не переносятся.

![20250102202546](https://static-docs.nocobase.com/20250102202546.png)

## Правила миграции

### Встроенные правила

Менеджер миграций позволяет переносить все таблицы основной базы данных и поддерживает следующие пять встроенных правил:

- **Только структура (схема)**: Переносится только структура (схема) таблиц, без вставки или обновления данных.
- **Перезапись (очистка и повторная вставка)**: Удаляет все существующие записи из целевой таблицы базы данных, а затем вставляет новые данные.
- **Вставка или обновление (Upsert)**: Если запись существует, она обновляется; если нет — вставляется.
- **Вставка с игнорированием дубликатов (Insert-ignore)**: При вставке данных, если запись уже существует, она игнорируется (обновление не происходит).
- **Пропустить**: Таблица полностью пропускается, никакие действия не выполняются.

**Примечания:**

- Правила «Перезапись», «Вставка или обновление» и «Вставка с игнорированием дубликатов» также синхронизируют изменения структуры таблиц.
- Для таблиц с автоинкрементным первичным ключом или без первичного ключа правила «Вставка или обновление» и «Вставка с игнорированием дубликатов» неприменимы.
- Правила «Вставка или обновление» и «Вставка с игнорированием дубликатов» используют первичный ключ для определения существования записи.

### Детальный дизайн

![20250102204909](https://static-docs.nocobase.com/20250102204909.png)

### Интерфейс конфигурации

Настройка правил миграции

![20250102205450](https://static-docs.nocobase.com/20250102205450.png)

Включение независимых правил

![20250107105005](https://static-docs.nocobase.com/20250107105005.png)

Выбор независимых правил и таблиц, обрабатываемых по этим правилам

![20250107104644](https://static-docs.nocobase.com/20250107104644.png)

## Файлы миграции

![20250102205844](https://static-docs.nocobase.com/20250102205844.png)

### Создание новой миграции

![20250102205857](https://static-docs.nocobase.com/20250102205857.png)

### Выполнение миграции

![20250102205915](https://static-docs.nocobase.com/20250102205915.png)

Проверка переменных окружения приложения (узнайте больше о [Переменных окружения](#))

![20250102212311](https://static-docs.nocobase.com/20250102212311.png)

Если какие-либо переменные отсутствуют, появится всплывающее окно с предложением ввести необходимые новые переменные окружения, после чего можно будет продолжить.

![20250102210009](https://static-docs.nocobase.com/20250102210009.png)

## Журналы миграций

![20250102205738](https://static-docs.nocobase.com/20250102205738.png)

## Откат

Перед выполнением любой миграции текущее приложение автоматически резервируется. Если миграция завершится неудачно или результаты не соответствуют ожиданиям, вы можете выполнить откат с помощью [Менеджера резервного копирования](../backup-manager/index.mdx).

![20250105195029](https://static-docs.nocobase.com/20250105195029.png)