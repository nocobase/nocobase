:::tip Уведомление о переводе ИИ
Эта документация была автоматически переведена ИИ.
:::

# Поток событий

## Введение

Поток событий позволяет вам запускать пользовательские действия при возникновении определённых событий, например, при изменении формы. Помимо форм, страницы, блоки, кнопки и поля также могут использовать потоки событий для настройки пользовательских операций.

## Как использовать

Давайте рассмотрим простой пример, чтобы понять, как настроить потоки событий. Мы настроим взаимодействие между двумя таблицами, при котором нажатие на строку в левой таблице будет автоматически фильтровать данные в правой таблице.

![20251031092211_rec_](https://static-docs.nocobase.com/20251031092211_rec_.gif)

Шаги по настройке:

1. Нажмите на иконку «молнии» в правом верхнем углу блока левой таблицы, чтобы открыть панель настройки потока событий.
![20251031092425](https://static-docs.nocobase.com/20251031092425.png)
2. Нажмите «Добавить поток событий», выберите «Клик по строке» в качестве «Триггерного события». Это означает, что поток будет запускаться при нажатии на строку таблицы.
![20251031092637](https://static-docs.nocobase.com/20251031092637.png)
3. «Условие-триггер» используется для настройки условий. Поток событий будет запускаться только при выполнении этих условий. В данном случае нам не нужно настраивать никаких условий, поэтому поток будет запускаться при любом клике по строке.
![20251031092717](https://static-docs.nocobase.com/20251031092717.png)
4. Наведите курсор на «Добавить шаг», чтобы добавить шаги операции. Выберите «Установить область данных», чтобы настроить область данных для правой таблицы.
![20251031092755](https://static-docs.nocobase.com/20251031092755.png)
5. Скопируйте UID правой таблицы и вставьте его в поле ввода «UID целевого блока». Ниже сразу появится панель настройки условий, где вы сможете настроить область данных для правой таблицы.
![20251031092915](https://static-docs.nocobase.com/20251031092915.png)
6. Настройте условие, как показано ниже:
![20251031093233](https://static-docs.nocobase.com/20251031093233.png)
7. После настройки области данных необходимо обновить блок, чтобы отобразить отфильтрованные результаты. Добавьте шаг «Обновить целевые блоки» и введите UID правой таблицы.
![20251031093150](https://static-docs.nocobase.com/20251031093150.png)
![20251031093341](https://static-docs.nocobase.com/20251031093341.png)
8. Наконец, нажмите кнопку сохранения в правом нижнем углу, чтобы завершить настройку.

## Типы событий

### До рендеринга (Before render)

Универсальное событие, которое можно использовать на страницах, в блоках, кнопках или полях. Используйте это событие для задач инициализации, например, для настройки различных областей данных в зависимости от условий.

### Клик по строке (Row click)

Событие, специфичное для блока таблицы. Запускается при нажатии на строку таблицы. При запуске оно добавляет «Запись нажатой строки» в контекст, которая может быть использована как переменная в условиях и шагах.

### Изменение значений формы (Form values change)

Событие, специфичное для блока формы. Запускается при изменении значений полей формы. Вы можете получить доступ к значениям формы через переменную «Текущая форма» в условиях и шагах.

### Клик (Click)

Событие, специфичное для кнопки. Запускается при нажатии на кнопку.

## Типы шагов

### Пользовательская переменная (Custom variable)

Создайте пользовательскую переменную для использования в контексте.

#### Область видимости

Пользовательские переменные имеют область видимости. Например, переменная, определённая в потоке событий блока, может быть использована только в этом блоке. Чтобы сделать переменную доступной для всех блоков на текущей странице, настройте её в потоке событий страницы.

#### Переменная формы (Form variable)

Используйте значения из блока формы в качестве переменной. Настройка:

![20251031093516](https://static-docs.nocobase.com/20251031093516.png)

- `Variable title`: Заголовок переменной
- `Variable identifier`: Идентификатор переменной
- `Form UID`: UID формы

#### Другие переменные

В будущем будут поддерживаться и другие типы переменных. Следите за обновлениями.

### Установить область данных (Set data scope)

Установите область данных для целевого блока. Настройка:

![20251031093609](https://static-docs.nocobase.com/20251031093609.png)

- `Target block UID`: UID целевого блока
- `Condition`: Условие фильтрации

### Обновить целевые блоки (Refresh target blocks)

Обновите целевые блоки. Можно настроить несколько блоков. Настройка:

![20251031093657](https://static-docs.nocobase.com/20251031093657.png)

- `Target block UID`: UID целевого блока

### Переход по URL (Navigate to URL)

Переход по URL. Настройка:

![20251031093742](https://static-docs.nocobase.com/20251031093742.png)

- `URL`: Целевой URL, поддерживает переменные
- `Search parameters`: Параметры запроса в URL
- `Open in new window`: Если отмечено, откроет URL в новой вкладке браузера

### Показать сообщение (Show message)

Отображение глобальных сообщений обратной связи.

#### Когда использовать

- Предоставление обратной связи об успехе, предупреждениях и ошибках.
- Отображается по центру в верхней части экрана и автоматически исчезает, представляя собой лёгкий способ уведомления, не прерывающий действия пользователя.

#### Настройка

![20251031093825](https://static-docs.nocobase.com/20251031093825.png)

- `Message type`: Тип сообщения
- `Message content`: Содержимое сообщения
- `Duration`: Длительность отображения (в секундах)

### Показать уведомление (Show notification)

Отображение глобальных уведомлений.

#### Когда использовать

Отображение уведомлений в четырёх углах системы. Часто используется в следующих случаях:

- Более сложное содержимое уведомлений.
- Интерактивные уведомления, предлагающие пользователю следующие шаги.
- Уведомления, инициированные системой.

#### Настройка

![20251031093934](https://static-docs.nocobase.com/20251031093934.png)

- `Notification type`: Тип уведомления
- `Notification title`: Заголовок уведомления
- `Notification description`: Описание уведомления
- `Placement`: Расположение, варианты: сверху слева, сверху справа, снизу слева, снизу справа

### Выполнить JavaScript (Execute JavaScript)

![20251031094046](https://static-docs.nocobase.com/20251031094046.png)

Выполнение кода JavaScript.