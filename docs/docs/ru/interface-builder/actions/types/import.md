---
pkg: "@nocobase/plugin-action-import"
---
:::tip Уведомление о переводе ИИ
Эта документация была автоматически переведена ИИ.
:::

# Импорт

## Введение

Импортируйте данные с помощью шаблона Excel. Вы можете настроить, какие поля импортировать, а шаблон будет сгенерирован автоматически.

![20251029165818](https://static-docs.nocobase.com/20251029165818.png)

## Инструкции по импорту

### Поля числового типа

Поддерживаются числа и проценты. Текст, такой как `N/A` или `-`, будет отфильтрован.

| Число 1 | Процент | Число 2 | Число 3 |
| ----- | ------ | ----- | ----- |
| 123   | 25%    | N/A   | -     |

После преобразования в JSON:

```ts
{
  "Число1": 123,
  "Процент": 0.25,
  "Число2": null,
  "Число3": null,
}
```

### Поля логического типа

Поддерживаемый ввод текста (английский язык не чувствителен к регистру):

- `Yes`, `Y`, `True`, `1`, `Да`
- `No`, `N`, `False`, `0`, `Нет`

| Поле 1 | Поле 2 | Поле 3 | Поле 4 | Поле 5 |
| ----- | ----- | ----- | ----- | ----- |
| Нет    | Да    | Y     | true  | 0     |

После преобразования в JSON:

```ts
{
  "Поле1": false,
  "Поле2": true,
  "Поле3": true,
  "Поле4": true,
  "Поле5": false,
}
```

### Поля типа "Дата"

| DateOnly            | Local(+08:00)       | GMT                 |
| ------------------- | ------------------- | ------------------- |
| 2023-01-18 22:22:22 | 2023-01-18 22:22:22 | 2023-01-18 22:22:22 |

После преобразования в JSON:

```ts
{
  "DateOnly": "2023-01-18T00:00:00.000Z",
  "Local(+08:00)": "2023-01-18T14:22:22.000Z",
  "GMT": "2023-01-18T22:22:22.000Z",
}
```

### Поля типа "Выбор"

В качестве текста для импорта могут использоваться как значения, так и метки опций. Несколько опций разделяются запятыми (`,`, `，`) или перечислительными запятыми (`、`).

Например, опции для поля `Приоритет` включают:

| Значение опции | Метка опции |
| ------ | -------- |
| low    | Низкий       |
| medium | Средний      |
| high   | Высокий       |

В качестве текста для импорта могут использоваться как значения, так и метки опций.

| Приоритет |
| ------ |
| Высокий     |
| low    |

После преобразования в JSON:

```ts
[{ Приоритет: 'high' }, { Приоритет: 'low' }];
```

### Поля административного деления Китая

| Регион 1         | Регион 2         |
| ------------- | ------------- |
| 北京市/市辖区 | 天津市/市辖区 |

После преобразования в JSON:

```ts
{
  "Регион1": ["11","1101"],
  "Регион2": ["12","1201"]
}
```

### Поля вложений

| Вложение                                     |
| ---------------------------------------- |
| https://www.nocobase.com/images/logo.png |

После преобразования в JSON:

```ts
{
  "Вложение": [
    {
      "filename": "logo.png",
      "title": "logo.png",
      "extname": ".png",
      "url": "https://www.nocobase.com/images/logo.png"
    }
  ]
}
```

### Поля типа "Связь"

Несколько записей данных разделяются запятыми (`,`, `，`) или перечислительными запятыми (`、`).

| Отдел/Название | Категория/Заголовок |
| --------- | ------------ |
| Команда разработки    | Категория1, Категория2 |

После преобразования в JSON:

```ts
{
  "Отдел": [1], // 1 — это ID записи для отдела с названием «Команда разработки»
  "Категория": [1,2], // 1,2 — это ID записей для категорий с заголовками «Категория1» и «Категория2»
}
```

### Поля типа "JSON"

| JSON1           |
| --------------- |
| {"key":"value"} |

После преобразования в JSON:

```ts
{
  "JSON": {"key":"value"}
}
```

### Типы геометрии карты

| Point | Line        | Polygon           | Circle |
| ----- | ----------- | ----------------- | ------ |
| 1,2   | (1,2),(3,4) | (1,2),(3,4),(1,2) | 1,2,3  |

После преобразования в JSON:

```ts
{
  "Point": [1,2],
  "Line": [[1,2], [3,4]],
  "Polygon": [[1,2], [3,4], [1,2]],
  "Circle": [1,2,3]
}
```

## Пользовательский формат импорта

Зарегистрируйте пользовательский `ValueParser` с помощью метода `db.registerFieldValueParsers()`, например:

```ts
import { BaseValueParser } from '@nocobase/database';

class PointValueParser extends BaseValueParser {
  async setValue(value) {
    if (Array.isArray(value)) {
      this.value = value;
    } else if (typeof value === 'string') {
      this.value = value.split(',');
    } else {
      this.errors.push('Value invalid');
    }
  }
}

const db = new Database();

// При импорте поля типа "point" данные будут обрабатываться с помощью PointValueParser
db.registerFieldValueParsers({
  point: PointValueParser,
});
```

Пример импорта

| Point |
| ----- |
| 1,2   |

После преобразования в JSON:

```ts
{
  "Point": [1,2]
}
```

## Настройки действия

![20251029170959](https://static-docs.nocobase.com/20251029170959.png)

- Настройте импортируемые поля

![20251029171036](https://static-docs.nocobase.com/20251029171036.png)

- [Правила связывания](/interface-builder/actions/action-settings/linkage-rule): Динамическое отображение/скрытие кнопки;
- [Редактировать кнопку](/interface-builder/actions/action-settings/edit-button): Измените заголовок, тип и иконку кнопки;