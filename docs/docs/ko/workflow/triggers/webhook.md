---
pkg: '@nocobase/plugin-workflow-webhook'
---
:::tip
이 문서는 AI로 번역되었습니다. 부정확한 내용이 있을 경우 [영어 버전](/en)을 참조하세요
:::


# Webhook

## 소개

Webhook 트리거는 타사 시스템이 HTTP 요청을 통해 호출할 수 있는 URL을 제공합니다. 타사 이벤트가 발생하면 이 URL로 HTTP 요청을 보내 워크플로우 실행을 트리거합니다. 결제 콜백이나 메시지처럼 외부 시스템에서 알림을 시작할 때 유용하게 사용할 수 있습니다.

## 워크플로우 생성

워크플로우를 생성할 때, 유형으로 "Webhook 이벤트"를 선택합니다.

![20241210105049](https://static-docs.nocobase.com/20241210105049.png)

:::info{title="참고"}
동기 워크플로우와 비동기 워크플로우의 차이점은 다음과 같습니다. 동기 워크플로우는 실행이 완료될 때까지 기다린 후 응답을 반환하지만, 비동기 워크플로우는 트리거 설정에 구성된 응답을 즉시 반환하고 백그라운드에서 실행을 대기열에 추가합니다.
:::

## 트리거 설정

![20241210105441](https://static-docs.nocobase.com/20241210105441.png)

### Webhook URL

Webhook 트리거 URL은 시스템에서 자동으로 생성되며 해당 워크플로우에 바인딩됩니다. 오른쪽 버튼을 클릭하여 복사한 후 타사 시스템에 붙여넣을 수 있습니다.

HTTP 메서드는 POST만 지원하며, 다른 메서드를 사용할 경우 `405` 오류가 반환됩니다.

### 보안

현재 HTTP 기본 인증을 지원합니다. 이 옵션을 활성화하고 사용자 이름과 비밀번호를 설정하면, 타사 시스템의 Webhook URL에 사용자 이름과 비밀번호를 포함시켜 Webhook에 대한 보안 인증을 구현할 수 있습니다. (표준에 대한 자세한 내용은 [MDN: HTTP authentication](https://developer.mozilla.org/en-US/docs/Web/HTTP/Authentication#basic_authentication_scheme)을 참조하세요.)

사용자 이름과 비밀번호가 설정된 경우, 시스템은 요청의 사용자 이름과 비밀번호가 일치하는지 확인합니다. 제공되지 않거나 일치하지 않으면 `401` 오류가 반환됩니다.

### 요청 데이터 파싱

타사에서 Webhook을 호출할 때, 요청에 포함된 데이터는 워크플로우에서 사용하기 전에 파싱해야 합니다. 파싱된 데이터는 트리거 변수로 사용되며, 이후 노드에서 참조할 수 있습니다.

HTTP 요청 파싱은 세 부분으로 나뉩니다.

1.  요청 헤더

    요청 헤더는 일반적으로 간단한 문자열 타입의 키-값 쌍으로 구성됩니다. 사용해야 할 헤더 필드는 `Date`, `X-Request-Id` 등과 같이 직접 설정할 수 있습니다.

2.  요청 파라미터

    요청 파라미터는 URL의 쿼리 파라미터 부분입니다. 예를 들어, `http://localhost:13000/api/webhook:trigger/1hfmkioou0d?query=1`에서 `query` 파라미터가 해당됩니다. 전체 URL 예시 또는 쿼리 파라미터 부분만 포함된 예시를 붙여넣은 다음, 파싱 버튼을 클릭하여 키-값 쌍을 자동으로 파싱할 수 있습니다.

    ![20241210111155](https://static-docs.nocobase.com/20241210111155.png)

    자동 파싱은 URL의 파라미터 부분을 JSON 구조로 변환하고, 파라미터 계층에 따라 `query[0]`, `query[0].a`와 같은 경로를 생성합니다. 이 경로 이름은 필요에 따라 수동으로 수정할 수 있지만, 일반적으로 수정할 필요는 없습니다. 별칭은 변수로 사용될 때 표시되는 이름이며 선택 사항입니다. 또한, 파싱은 예시에 있는 모든 파라미터 목록을 생성하며, 사용하지 않을 파라미터는 삭제할 수 있습니다.

3.  요청 본문

    요청 본문은 HTTP 요청의 Body 부분입니다. 현재 `Content-Type`이 `application/json` 형식인 요청 본문만 지원합니다. 파싱할 경로를 직접 설정하거나, JSON 예시를 입력하고 파싱 버튼을 클릭하여 자동으로 파싱할 수 있습니다.

    ![20241210112529](https://static-docs.nocobase.com/20241210112529.png)

    자동 파싱은 JSON 구조의 키-값 쌍을 경로로 변환합니다. 예를 들어, `{"a": 1, "b": {"c": 2}}`는 `a`, `b`, `b.c`와 같은 경로를 생성합니다. 별칭은 변수로 사용될 때 표시되는 이름이며 선택 사항입니다. 또한, 파싱은 예시에 있는 모든 파라미터 목록을 생성하며, 사용하지 않을 파라미터는 삭제할 수 있습니다.

### 응답 설정

Webhook의 응답 부분은 동기 및 비동기 워크플로우에서 설정 방식이 다릅니다. 비동기 워크플로우는 트리거에서 직접 설정하며, Webhook 요청을 받으면 트리거에 설정된 응답을 즉시 타사 시스템에 반환한 후 워크플로우를 실행합니다. 반면 동기 워크플로우는 비즈니스 요구 사항에 따라 워크플로우 내에 응답 노드를 추가하여 처리해야 합니다. (자세한 내용은 [응답 노드](#응답-노드)를 참조하세요.)

일반적으로 비동기로 트리거되는 Webhook 이벤트의 응답 상태 코드는 `200`이며, 응답 본문은 `ok`입니다. 필요에 따라 응답 상태 코드, 응답 헤더 및 응답 본문을 사용자 지정할 수도 있습니다.

![20241210114312](https://static-docs.nocobase.com/20241210114312.png)

## 응답 노드

참조: [응답 노드](../nodes/response.md)

## 예시

Webhook 워크플로우에서는 비즈니스 조건에 따라 다른 응답을 반환할 수 있습니다. 다음 그림을 참조하세요.

![20241210120655](https://static-docs.nocobase.com/20241210120655.png)

조건 분기 노드를 통해 특정 비즈니스 상태가 충족되는지 판단하고, 충족되면 성공을, 그렇지 않으면 실패를 반환합니다.