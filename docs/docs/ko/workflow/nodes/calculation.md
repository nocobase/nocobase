:::tip
이 문서는 AI로 번역되었습니다. 부정확한 내용이 있을 경우 [영어 버전](/en)을 참조하세요
:::

# 계산

계산 노드는 표현식을 평가할 수 있으며, 그 결과는 해당 노드의 결과에 저장되어 이후 다른 노드에서 활용할 수 있습니다. 계산 노드는 데이터를 계산하고, 처리하며, 변환하는 도구입니다. 어느 정도는 프로그래밍 언어에서 값을 계산하는 함수를 호출하고 변수에 할당하는 기능을 대체할 수 있습니다.

## 노드 생성

워크플로우 설정 화면에서, 흐름 내의 더하기("+"") 버튼을 클릭하여 "계산" 노드를 추가합니다.

![계산 노드_추가](https://static-docs.nocobase.com/58a455540d26945251cd143eb4b16579.png)

## 노드 설정

![계산 노드_설정](https://static-docs.nocobase.com/6a155de3f6a883d8cd1881b2d9c33874.png)

### 계산 엔진

계산 엔진은 표현식에서 지원하는 문법을 정의합니다. 현재 지원되는 계산 엔진은 [Math.js](https://mathjs.org/)와 [Formula.js](https://formulajs.info/)입니다. 각 엔진에는 많은 일반 함수와 데이터 조작 메서드가 내장되어 있습니다. 자세한 사용법은 각 공식 문서를 참조해 주세요.

:::info{title=팁}
참고로, 엔진마다 배열 인덱스 접근 방식이 다릅니다. Math.js는 인덱스가 `1`부터 시작하고, Formula.js는 `0`부터 시작합니다.
:::

또한, 간단한 문자열 연결이 필요한 경우 "문자열 템플릿"을 직접 사용할 수 있습니다. 이 엔진은 표현식 내의 변수를 해당 값으로 대체한 다음 연결된 문자열을 반환합니다.

### 표현식

표현식은 계산 공식의 문자열 형태이며, 변수, 상수, 연산자 및 지원되는 함수 등으로 구성될 수 있습니다. 흐름 컨텍스트의 변수를 사용할 수 있습니다. 예를 들어, 계산 노드의 이전 노드 결과나 반복문의 지역 변수 등이 있습니다.

표현식 입력이 문법에 맞지 않으면 노드 설정에서 오류가 표시됩니다. 만약 실제 실행 시 변수가 없거나 타입이 일치하지 않거나, 존재하지 않는 함수를 사용하면, 계산 노드는 오류 상태로 조기에 종료됩니다.

## 예시

### 주문 총액 계산

일반적으로 하나의 주문에는 여러 상품이 있을 수 있으며, 각 상품의 가격과 수량이 다를 수 있습니다. 주문 총액은 모든 상품의 가격과 수량의 곱을 합산하여 계산해야 합니다. 주문 상세 목록(일대다 관계 데이터셋)을 불러온 후 계산 노드를 사용하여 주문 총액을 계산할 수 있습니다.

![계산 노드_예시_설정](https://static-docs.nocobase.com/85966b0116afb49aa966eeaa85e78dae.png)

여기서 Formula.js의 `SUMPRODUCT` 함수는 길이가 같은 두 배열의 각 행에 대한 곱의 합을 계산하여, 주문 총액을 얻을 수 있습니다.