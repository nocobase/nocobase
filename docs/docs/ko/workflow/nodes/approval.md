---
pkg: '@nocobase/plugin-workflow-approval'
---
:::tip
이 문서는 AI로 번역되었습니다. 부정확한 내용이 있을 경우 [영어 버전](/en)을 참조하세요
:::


# 승인

## 소개

승인 워크플로우에서는 승인자가 시작된 승인을 처리(승인, 거부 또는 반려)하기 위한 작업 로직을 구성하기 위해 전용 '승인' 노드를 사용해야 합니다. '승인' 노드는 승인 프로세스에서만 사용할 수 있습니다.

:::info{title=팁}
일반 '수동 처리' 노드와의 차이점: 일반 '수동 처리' 노드는 수동 데이터 입력, 프로세스 계속 여부 수동 결정 등 다양한 유형의 워크플로우에서 더 일반적인 시나리오에 사용됩니다. '승인 노드'는 승인 프로세스 전용으로 특화된 처리 노드이며, 시작된 승인 데이터만 처리하고 다른 워크플로우에서는 사용할 수 없습니다.
:::

## 노드 생성

워크플로우에서 더하기('+' ) 버튼을 클릭하여 '승인' 노드를 추가한 다음, 통과 모드 중 하나를 선택하여 승인 노드를 생성합니다.

![审批节点_创建](https://static-docs.nocobase.com/20251107000938.png)

## 노드 설정

### 통과 모드

통과 모드에는 두 가지가 있습니다.

1.  **직통 모드**: 일반적으로 간단한 프로세스에 사용됩니다. 승인 노드의 통과 여부가 프로세스 종료를 결정하며, 통과하지 못하면 프로세스가 즉시 종료됩니다.

    ![审批节点_通过模式_直通模式](https://static-docs.nocobase.com/20251107001043.png)

2.  **분기 모드**: 일반적으로 더 복잡한 데이터 로직에 사용됩니다. 승인 노드에서 어떤 결과가 나오든, 해당 결과 분기 내에서 다른 노드를 계속 실행할 수 있습니다.

    ![审批节点_通过模式_分支模式](https://static-docs.nocobase.com/20251107001234.png)

    이 노드가 '승인'되면 승인 분기를 실행하는 것 외에 후속 프로세스도 계속 실행됩니다. '거부' 작업 후에도 기본적으로 후속 프로세스를 계속 실행할 수 있으며, 노드에서 분기 실행 후 프로세스를 종료하도록 설정할 수도 있습니다.

:::info{title=팁}
통과 모드는 노드 생성 후 수정할 수 없습니다.
:::

### 승인자

승인자는 해당 노드의 승인 작업을 담당하는 사용자 집합입니다. 한 명 또는 여러 명의 사용자일 수 있으며, 사용자 목록에서 선택한 정적 값 또는 변수로 지정된 동적 값으로 지정할 수 있습니다.

![审批节点_审批人](https://static-docs.nocobase.com/20251107001433.png)

변수를 선택할 때는 컨텍스트 및 노드 결과에서 사용자 데이터의 기본 키 또는 외래 키만 선택할 수 있습니다. 선택한 변수가 실행 중에 배열(다대다 관계)인 경우, 배열의 각 사용자는 전체 승인자 집합에 병합됩니다.

사용자 또는 변수를 직접 선택하는 것 외에도, 사용자 컬렉션의 쿼리 조건을 기반으로 조건을 충족하는 사용자를 동적으로 필터링하여 승인자로 지정할 수 있습니다.

![20251107001703](https://static-docs.nocobase.com/20251107001703.png)

### 협의 모드

최종 실행 시 승인자가 한 명만 있는 경우(여러 변수 중복 제거 후 포함), 어떤 협의 모드를 선택하든 해당 사용자만 승인 작업을 수행하며 결과도 해당 사용자만 결정합니다.

승인자 집합에 여러 사용자가 있을 때, 다른 협의 모드를 선택하면 다른 처리 방식을 나타냅니다.

1.  **개별 승인**: 한 명이라도 승인하면 노드가 통과된 것으로 간주하며, 모든 사람이 거부해야 노드가 거부된 것으로 간주합니다.
2.  **합의 승인**: 모든 사람이 승인해야 노드가 통과된 것으로 간주하며, 한 명이라도 거부하면 노드가 거부된 것으로 간주합니다.
3.  **투표**: 설정된 비율 이상의 인원이 승인해야 노드가 통과된 것으로 간주하며, 그렇지 않으면 노드가 거부된 것으로 간주합니다.

반려 작업의 경우, 어떤 모드에서든 승인자 집합에 있는 사용자 중 누군가가 반려 처리하면 노드는 프로세스에서 즉시 종료됩니다.

### 처리 순서

마찬가지로, 승인자 집합에 여러 사용자가 있을 때, 다른 처리 순서를 선택하면 다른 처리 방식을 나타냅니다.

1.  **병렬**: 모든 승인자가 어떤 순서로든 처리할 수 있으며, 처리 순서는 중요하지 않습니다.
2.  **순차**: 승인자 집합에 있는 순서대로 승인자가 차례로 처리합니다. 이전 승인자가 제출한 후에 다음 승인자가 처리할 수 있습니다.

'순차' 처리로 설정되었는지 여부와 관계없이, 실제 처리 순서에 따라 생성된 결과는 위에서 언급된 '협의 모드'의 규칙을 따릅니다. 해당 조건이 충족되면 노드 실행이 완료됩니다.

### 거부 분기 종료 후 워크플로우 종료

'통과 모드'가 '분기 모드'로 설정된 경우, 거부 분기 종료 후 워크플로우를 종료하도록 선택할 수 있습니다. 이 옵션을 선택하면 거부 분기 끝에 '✗' 표시가 나타나며, 이는 해당 분기 종료 후 후속 노드가 더 이상 진행되지 않음을 의미합니다.

![审批节点_拒绝后退出](https://static-docs.nocobase.com/20251107001839.png)

### 승인자 인터페이스 설정

승인자 인터페이스 설정은 승인 워크플로우가 이 노드에서 실행될 때 승인자에게 작업 인터페이스를 제공하는 데 사용됩니다. 설정 버튼을 클릭하여 팝업 창을 엽니다.

![审批节点_界面配置_弹窗](https://static-docs.nocobase.com/20251107001958.png)

설정 팝업 창에서 원본 제출 내용, 승인 정보, 처리 양식 및 사용자 정의 안내 문구 등의 블록을 추가할 수 있습니다.

![审批节点_界面配置_添加区块](https://static-docs.nocobase.com/20251107002604.png)

#### 원본 제출 내용

승인 내용 상세 블록은 시작자가 제출한 데이터 블록으로, 일반 데이터 블록과 유사하게 데이터 컬렉션의 필드 컴포넌트를 자유롭게 추가하고 배열하여 승인자가 확인해야 할 내용을 구성할 수 있습니다.

![审批节点_界面配置_详情区块](https://static-docs.nocobase.com/20251107002925.png)

#### 처리 양식

작업 양식 블록에는 이 노드가 지원하는 작업 버튼을 추가할 수 있습니다. 여기에는 '승인', '거부', '반려', '재지정' 및 '추가 서명'이 포함됩니다.

![审批节点_界面配置_操作表单区块](https://static-docs.nocobase.com/20251107003015.png)

또한, 작업 양식에는 승인자가 수정할 수 있는 필드를 추가할 수 있습니다. 이 필드들은 승인자가 승인을 처리할 때 작업 양식에 표시되며, 승인자는 이 필드들의 값을 수정할 수 있습니다. 제출 후에는 승인에 사용되는 데이터와 승인 프로세스 내 해당 데이터의 스냅샷이 동시에 업데이트됩니다.

![审批节点_界面配置_操作表单_修改审批内容字段](https://static-docs.nocobase.com/20251107003206.png)

#### '승인' 및 '거부'

승인 작업 버튼 중 '승인'과 '거부'는 결정적인 작업입니다. 제출 후에는 승인자가 해당 노드에서의 처리를 완료한 것으로 간주됩니다. 제출 시 작성해야 하는 추가 필드(예: '댓글' 등)는 작업 버튼의 '처리 설정' 팝업 창에서 추가할 수 있습니다.

![审批节点_界面配置_操作表单_处理配置](https://static-docs.nocobase.com/20251107003314.png)

#### '반려'

'반려' 또한 결정적인 작업입니다. 댓글을 설정할 수 있을 뿐만 아니라, 반려할 수 있는 노드를 설정할 수도 있습니다.

![20251107003555](https://static-docs.nocobase.com/20251107003555.png)

#### '재지정' 및 '추가 서명'

'재지정'과 '추가 서명'은 승인 프로세스의 승인자를 동적으로 조정하는 데 사용되는 비결정적인 작업입니다. '재지정'은 현재 사용자의 승인 작업을 다른 사용자에게 대신 처리하도록 넘기는 것이고, '추가 서명'은 현재 승인자 앞이나 뒤에 승인자를 추가하여 새로 추가된 승인자가 함께 승인을 계속 진행하도록 하는 것입니다.

'재지정' 또는 '추가 서명' 작업 버튼을 활성화한 후, 버튼의 설정 메뉴에서 '지정 인원 범위'를 선택하여 새로운 승인자를 지정할 수 있는 범위를 설정해야 합니다.

![审批节点_界面配置_操作表单_指派人员范围](https://static-docs.nocobase.com/20241226232321.png)

노드의 원래 승인자 설정과 마찬가지로, 지정 인원 범위는 직접 선택한 승인자이거나 사용자 컬렉션의 쿼리 조건을 기반으로 할 수 있습니다. 최종적으로 하나의 집합으로 병합되며, 이미 승인자 집합에 있는 사용자는 포함되지 않습니다.

:::warning{title=중요}
특정 작업 버튼을 활성화하거나 비활성화했거나, 지정 인원 범위를 수정했다면, 작업 인터페이스 설정 팝업 창을 닫은 후 해당 노드의 설정을 저장해야 합니다. 그렇지 않으면 작업 버튼의 변경 사항이 적용되지 않습니다.
:::

## 노드 결과

승인이 완료되면 관련 상태 및 데이터가 노드 결과에 기록되며, 후속 노드에서 변수로 사용할 수 있습니다.

![20250614095052](https://static-docs.nocobase.com/20250614095052.png)

### 노드 승인 상태

현재 승인 노드의 처리 상태를 나타내며, 결과는 열거형 값입니다.

### 승인 후 데이터

승인자가 작업 양식에서 승인 내용을 수정하면, 수정된 데이터는 노드 결과에 기록되어 후속 노드에서 사용됩니다. 관계 필드를 사용하려면 트리거에서 관계 필드에 대한 사전 로드를 설정해야 합니다.

### 승인 기록

> v1.8.0+

승인 처리 기록은 해당 노드의 모든 승인자 처리 기록을 포함하는 배열이며, 각 처리 기록은 다음 필드를 포함합니다.

| 필드      | 타입   | 설명                      |
| --------- | ------ | ------------------------- |
| id        | number | 처리 기록의 고유 식별자   |
| userId    | number | 이 기록을 처리한 사용자 ID |
| status    | number | 처리 상태                 |
| comment   | string | 처리 시 댓글              |
| updatedAt | string | 처리 기록의 업데이트 시간 |

필요에 따라 이 필드들을 변수로 사용하여 후속 노드에서 활용할 수 있습니다.