---
pkg: '@nocobase/plugin-workflow-date-calculation'
---
:::tip
이 문서는 AI로 번역되었습니다. 부정확한 내용이 있을 경우 [영어 버전](/en)을 참조하세요
:::


# 날짜 계산

## 소개

날짜 계산 노드는 기간 추가, 기간 차감, 시간 문자열 형식 지정 출력, 기간 단위 변환을 포함한 9가지 계산 함수를 제공합니다. 각 함수는 특정 입력값 유형과 출력값 유형을 가지며, 다른 노드의 결과를 매개변수 변수로 받을 수도 있습니다. 또한, 계산 파이프라인 방식을 사용하여 설정된 함수의 계산 결과를 연결하고, 최종적으로 예상되는 출력을 얻습니다.

## 노드 생성

워크플로우 설정 화면에서 흐름의 더하기("+"") 버튼을 클릭하여 "날짜 계산" 노드를 추가합니다.

![날짜 계산 노드_노드 생성](https://static-docs.nocobase.com/[图片].png)

## 노드 설정

![날짜 계산 노드_노드 설정](https://static-docs.nocobase.com/20240817184423.png)

### 입력값

입력값은 변수 또는 날짜 상수를 선택할 수 있습니다. 변수는 이 워크플로우를 트리거한 데이터이거나, 워크플로우 내 상위 노드의 결과일 수 있습니다. 상수는 어떤 날짜든 선택할 수 있습니다.

### 입력값 유형

입력값의 유형을 나타내며, 두 가지 값을 가질 수 있습니다.

*   **날짜 유형**: 입력값이 최종적으로 날짜/시간 유형으로 변환될 수 있는 유형을 의미합니다. 예를 들어, 숫자형 타임스탬프 또는 시간을 나타내는 문자열 등이 있습니다.
*   **숫자 유형**: 입력값의 유형은 아래 시간 연산 단계 선택에 영향을 미치므로, 입력값 유형을 올바르게 선택해야 합니다.

### 계산 단계

각 계산 단계는 하나의 계산 함수와 해당 매개변수 설정으로 구성됩니다. 파이프라인 방식으로 설계되어, 이전 함수의 계산 결과가 다음 함수의 입력값으로 사용되어 계산이 계속 진행됩니다. 이러한 방식으로 일련의 시간 계산 및 변환을 완료할 수 있습니다.

각 계산 단계 후에는 출력 유형도 고정되며, 다음 계산 단계에서 사용할 수 있는 함수에 영향을 미칩니다. 유형이 일치해야만 계산을 계속할 수 있습니다. 그렇지 않으면 해당 단계의 결과가 최종 노드의 출력 결과가 됩니다.

## 계산 함수

### 기간 추가

-   **입력값 유형**: 날짜
-   **매개변수**
    -   추가할 수량 (숫자를 입력하거나 노드 내장 변수를 선택할 수 있습니다.)
    -   시간 단위
-   **출력값 유형**: 날짜
-   **예시**: 입력값이 `2024-7-15 00:00:00`이고, 수량이 `1`, 단위가 '일'인 경우, 계산 결과는 `2024-7-16 00:00:00`입니다.

### 기간 차감

-   **입력값 유형**: 날짜
-   **매개변수**
    -   차감할 수량 (숫자를 입력하거나 노드 내장 변수를 선택할 수 있습니다.)
    -   시간 단위
-   **출력값 유형**: 날짜
-   **예시**: 입력값이 `2024-7-15 00:00:00`이고, 수량이 `1`, 단위가 '일'인 경우, 계산 결과는 `2024-7-14 00:00:00`입니다.

### 다른 시간과의 차이 계산

-   **입력값 유형**: 날짜
-   **매개변수**
    -   차이를 계산할 날짜 (날짜 상수를 선택하거나 워크플로우 컨텍스트의 변수를 선택할 수 있습니다.)
    -   시간 단위
    -   절대값 적용 여부
    -   반올림/내림/올림: 소수점 유지, 반올림, 올림, 내림 중에서 선택할 수 있습니다.
-   **출력값 유형**: 숫자
-   **예시**: 입력값이 `2024-7-15 00:00:00`이고, 비교 대상이 `2024-7-16 06:00:00`이며, 단위가 '일', 절대값을 적용하지 않고 소수점을 유지하는 경우, 계산 결과는 `-1.25`입니다.

:::info{title=팁}
절대값과 반올림/내림/올림을 동시에 설정하는 경우, 절대값을 먼저 적용한 후 반올림/내림/올림이 수행됩니다.
:::

### 특정 단위의 시간 값 가져오기

-   **입력값 유형**: 날짜
-   **매개변수**
    -   시간 단위
-   **출력값 유형**: 숫자
-   **예시**: 입력값이 `2024-7-15 00:00:00`이고, 단위가 '일'인 경우, 계산 결과는 `15`입니다.

### 날짜를 특정 단위의 시작 시간으로 설정

-   **입력값 유형**: 날짜
-   **매개변수**
    -   시간 단위
-   **출력값 유형**: 날짜
-   **예시**: 입력값이 `2024-7-15 14:26:30`이고, 단위가 '일'인 경우, 계산 결과는 `2024-7-15 00:00:00`입니다.

### 날짜를 특정 단위의 종료 시간으로 설정

-   **입력값 유형**: 날짜
-   **매개변수**
    -   시간 단위
-   **출력값 유형**: 날짜
-   **예시**: 입력값이 `2024-7-15 14:26:30`이고, 단위가 '일'인 경우, 계산 결과는 `2024-7-15 23:59:59`입니다.

### 윤년 확인

-   **입력값 유형**: 날짜
-   **매개변수**
    -   매개변수 없음
-   **출력값 유형**: 불리언
-   **예시**: 입력값이 `2024-7-15 14:26:30`인 경우, 계산 결과는 `true`입니다.

### 문자열로 형식 지정

-   **입력값 유형**: 날짜
-   **매개변수**
    -   형식 (참고: [Day.js: Format](https://day.js.org/docs/zh-CN/display/format))
-   **출력값 유형**: 문자열
-   **예시**: 입력값이 `2024-7-15 14:26:30`이고, 형식이 `the time is YYYY/MM/DD HH:mm:ss`인 경우, 계산 결과는 `the time is 2024/07/15 14:26:30`입니다.

### 단위 변환

-   **입력값 유형**: 숫자
-   **매개변수**
    -   변환 전 시간 단위
    -   변환 후 시간 단위
    -   반올림/내림/올림: 소수점 유지, 반올림, 올림, 내림 중에서 선택할 수 있습니다.
-   **출력값 유형**: 숫자
-   **예시**: 입력값이 `2`이고, 변환 전 단위가 '주', 변환 후 단위가 '일'이며, 소수점을 유지하지 않는 경우, 계산 결과는 `14`입니다.

## 예시

![날짜 계산 노드_예시](https://static-docs.nocobase.com/20240817184137.png)

프로모션 이벤트가 있다고 가정해 봅시다. 각 상품이 생성될 때 상품 필드에 프로모션 종료 시간을 추가하고 싶습니다. 이 종료 시간은 상품 생성 시간의 다음 주 마지막 날 23:59:59입니다. 이를 위해 두 개의 시간 함수를 생성하고 파이프라인 방식으로 실행할 수 있습니다.

-   다음 주의 시간을 계산합니다.
-   계산된 결과를 해당 주의 마지막 날 23:59:59로 재설정합니다.

이렇게 하면 원하는 시간 값을 얻게 되며, 이를 다음 노드(예: 컬렉션 수정 노드)로 전달하여 프로모션 종료 시간을 컬렉션에 추가할 수 있습니다.