---
pkg: '@nocobase/plugin-workflow-manual'
---
:::tip
이 문서는 AI로 번역되었습니다. 부정확한 내용이 있을 경우 [영어 버전](/en)을 참조하세요
:::


# 수동 처리

## 소개

비즈니스 프로세스에서 의사 결정이 완전히 자동화되기 어려울 때, 수동 노드를 사용하여 일부 결정 권한을 사람에게 위임할 수 있습니다.

수동 노드가 실행되면 전체 워크플로우 실행이 일시 중단되고, 해당 사용자에게 할 일(to-do) 작업이 생성됩니다. 사용자가 작업을 제출하면 선택된 상태에 따라 워크플로우가 계속 진행되거나, 대기 상태를 유지하거나, 종료됩니다. 이러한 기능은 승인 프로세스와 같은 시나리오에서 매우 유용합니다.

## 설치

내장 플러그인이므로 별도로 설치할 필요가 없습니다.

## 노드 생성

워크플로우 설정 화면에서 워크플로우 내의 더하기("+"") 버튼을 클릭하여 "수동 처리" 노드를 추가합니다:

![수동 노드 생성](https://static-docs.nocobase.com/4dd259f1aceeaf9b825abb4b257df909.png)

## 노드 설정

### 담당자

수동 노드는 할 일 작업의 실행자로 특정 사용자를 지정해야 합니다. 할 일 작업 목록은 페이지에 블록을 추가할 때 추가할 수 있으며, 각 노드의 작업 팝업 내용은 노드 인터페이스 설정에서 구성해야 합니다.

사용자를 선택하거나, 변수를 통해 컨텍스트 내 사용자 데이터의 기본 키 또는 외래 키를 선택할 수 있습니다.

![수동 노드_설정_담당자_변수 선택](https://static-docs.nocobase.com/22fbca3b8e21fda3a831019037001445.png)

:::info{title=참고}
현재 수동 노드의 담당자 옵션은 여러 명의 사용자 처리를 지원하지 않습니다. 이 기능은 향후 버전에서 지원될 예정입니다.
:::

### 사용자 인터페이스 설정

할 일 항목의 인터페이스 설정은 수동 노드의 핵심 내용입니다. "사용자 인터페이스 설정" 버튼을 클릭하여 별도의 설정 팝업을 열 수 있으며, 일반 페이지와 마찬가지로 WYSIWYG 방식으로 구성할 수 있습니다.

![수동 노드_노드 설정_인터페이스 설정](https://static-docs.nocobase.com/fd360168c879743cf22d57440cd2590f.png)

#### 탭

탭은 다양한 콘텐츠를 구분하는 데 사용될 수 있습니다. 예를 들어, 한 탭은 승인된 양식 제출에, 다른 탭은 거부된 양식 제출에 사용하거나, 관련 데이터의 상세 정보를 표시하는 데 사용할 수 있으며, 자유롭게 구성할 수 있습니다.

#### 블록

지원되는 블록 유형은 크게 두 가지로 나뉩니다: 데이터 블록과 양식 블록입니다. 이 외에 Markdown은 주로 알림 메시지와 같은 정적 콘텐츠에 사용됩니다.

##### 데이터 블록

데이터 블록은 트리거 데이터 또는 임의의 노드 처리 결과를 표시하여 할 일 담당자에게 관련 컨텍스트 정보를 제공할 수 있습니다. 예를 들어, 워크플로우가 양식 이벤트에 의해 트리거되는 경우, 트리거 데이터의 상세 정보 블록을 생성할 수 있습니다. 이는 일반 페이지의 상세 정보 설정과 동일하며, 트리거 데이터 내의 모든 필드를 선택하여 데이터를 표시할 수 있습니다:

![수동 노드_노드 설정_인터페이스 설정_데이터 블록_트리거](https://static-docs.nocobase.com/675c3e58a1a4f45db310a72c2d0a404c.png)

노드 데이터 블록도 유사하게, 상위 노드의 데이터 결과를 상세 정보로 표시할 수 있습니다. 예를 들어, 상위 계산 노드의 결과는 담당자의 할 일 작업에 대한 컨텍스트 참조 정보로 활용될 수 있습니다:

![수동 노드_노드 설정_인터페이스 설정_데이터 블록_노드 데이터](https://static-docs.nocobase.com/a583e258a1a4f45db310a72c2d0a404c.png)

:::info{title=참고}
인터페이스 설정 시 워크플로우는 아직 실행되지 않은 상태이므로, 데이터 블록에는 구체적인 데이터가 표시되지 않습니다. 워크플로우가 트리거되어 실행된 후에야 할 일 팝업 화면에서 특정 워크플로우 인스턴스와 관련된 데이터를 확인할 수 있습니다.
:::

##### 양식 블록

할 일 인터페이스에는 워크플로우의 계속 실행 여부를 최종 결정하는 처리로, 최소한 하나의 양식 블록이 설정되어야 합니다. 양식을 설정하지 않으면 워크플로우가 중단된 후 계속 진행할 수 없습니다. 양식 블록에는 세 가지 유형이 있습니다:

- 사용자 정의 양식
- 레코드 생성 양식
- 레코드 업데이트 양식

![수동 노드_노드 설정_인터페이스 설정_양식 유형](https://static-docs.nocobase.com/2d068f3012ab07e32a265405492104a8.png)

레코드 생성 양식과 레코드 업데이트 양식은 기반이 되는 컬렉션을 선택해야 합니다. 할 일 사용자가 제출하면 양식 내의 값이 지정된 컬렉션의 데이터를 생성하거나 업데이트하는 데 사용됩니다. 사용자 정의 양식은 컬렉션과 관련 없는 임시 양식을 자유롭게 정의할 수 있으며, 할 일 사용자가 제출한 필드 값은 후속 노드에서 사용될 수 있습니다.

양식의 제출 버튼은 세 가지 유형으로 설정할 수 있습니다:

- 제출 후 워크플로우 계속
- 제출 후 워크플로우 종료
- 양식 값만 임시 저장

![수동 노드_노드 설정_인터페이스 설정_양식 버튼](https://static-docs.nocobase.com/6b45995b14152e85a821dff6f6e3189a.png)

세 가지 버튼은 워크플로우 처리 과정에서 세 가지 노드 상태를 나타냅니다. 제출 후 해당 노드의 상태는 "완료", "거부"로 변경되거나 "대기" 상태를 유지합니다. 전체 워크플로우의 후속 처리 흐름을 결정하려면 양식에 최소한 앞의 두 가지 중 하나가 설정되어야 합니다.

“워크플로우 계속” 버튼에서 양식 필드에 대한 값 할당을 설정할 수 있습니다:

![수동 노드_노드 설정_인터페이스 설정_양식 버튼_양식 값 설정](https://static-docs.nocobase.com/2cec2d4e2957f068877e616dec3b56dd.png)

![수동 노드_노드 설정_인터페이스 설정_양식 버튼_양식 값 설정 팝업](https://static-docs.nocobase.com/5ff51b60c76cdb76e6f1cc95dc3d8640.png)

팝업을 연 후 양식의 모든 필드에 값을 할당할 수 있습니다. 양식이 제출되면 이 값이 필드의 최종 값으로 사용됩니다. 이는 데이터를 검토할 때 특히 유용합니다. 양식에서 여러 개의 다른 "워크플로우 계속" 버튼을 사용하여, 각 버튼이 상태와 같은 필드에 다른 열거형 값을 설정함으로써, 후속 워크플로우 실행을 계속하면서 다른 데이터 값을 사용하는 효과를 얻을 수 있습니다.

## 할 일 블록

수동 처리를 위해서는 페이지에 할 일 목록을 추가하여 할 일 작업을 표시해야 합니다. 그래야 관련 담당자가 이 목록을 통해 수동 노드의 특정 작업을 처리할 수 있습니다.

### 블록 추가

페이지의 블록 중에서 "워크플로우 할 일"을 선택하여 할 일 목록 블록을 추가할 수 있습니다:

![수동 노드_할 일 블록 추가](https://static-docs.nocobase.com/198b41754cd73b704267bf30fe5e647.png)

할 일 목록 블록 예시:

![수동 노드_할 일 목록](https://static-docs.nocobase.com/cfefb053c6a91c5c9dfa550d6b220f34.png)

### 할 일 상세 정보

이후 관련 담당자는 해당 할 일 작업을 클릭하여 할 일 팝업으로 이동하여 수동 처리를 진행할 수 있습니다:

![수동 노드_할 일 상세 정보](https://static-docs.nocobase.com/ccfd0533deebff6b3f6ef4408066e688.png)

## 예시

### 게시물 검토

일반 사용자가 제출한 게시물이 관리자의 승인을 받아야만 "게시됨" 상태로 업데이트될 수 있다고 가정해 봅시다. 만약 워크플로우가 거부되면 게시물은 "초안" 상태(비공개)로 유지됩니다. 이 프로세스는 수동 노드의 업데이트 양식을 사용하여 구현할 수 있습니다.

“게시물 생성”에 의해 트리거되는 워크플로우를 생성하고 수동 노드를 추가합니다:

<figure>
  <img alt="수동 노드_예시_게시물 검토_워크플로우 오케스트레이션" src="https://github.com/nocobase/nocobase/assets/525658/2021bf42-f372-4f69-9c84-5a786c061e0e" width="360" />
</figure>

수동 노드에서 담당자를 관리자로 설정하고, 인터페이스 설정에서 트리거 데이터 기반의 블록을 추가하여 새로 생성된 게시물의 상세 정보를 표시합니다:

<figure>
  <img alt="수동 노드_예시_게시물 검토_노드 설정_상세 정보 블록" src="https://github.com/nocobase/nocobase/assets/525658/c61d0aac-23cb-4387-b60e-ce3cc7bf1c24" width="680" />
</figure>

설정 인터페이스에서 업데이트 레코드 양식 기반의 블록을 추가하고, 게시물 컬렉션을 선택하여 관리자가 승인 여부를 결정하도록 합니다. 승인되면 후속 설정에 따라 해당 게시물이 업데이트됩니다. 양식을 추가하면 기본적으로 "워크플로우 계속" 버튼이 있는데, 이를 클릭하면 승인으로 간주할 수 있습니다. 여기에 "워크플로우 종료" 버튼을 추가하여 검토 불승인 시 사용합니다:

<figure>
  <img alt="수동 노드_예시_게시물 검토_노드 설정_양식 및 작업" src="https://github.com/nocobase/nocobase/assets/525658/4baaf41e-3d81-4ee8-a038-29db05e0d99f" width="673" />
</figure>

워크플로우를 계속 진행할 때 게시물의 상태를 업데이트해야 합니다. 여기에는 두 가지 설정 방식이 있습니다. 첫 번째는 양식에 게시물 상태 필드를 직접 표시하여 작업자가 선택하도록 하는 방식입니다. 이 방식은 피드백 제공과 같이 양식을 능동적으로 작성해야 하는 상황에 더 적합합니다:

<figure>
  <img alt="수동 노드_예시_게시물 검토_노드 설정_양식 필드" src="https://github.com/nocobase/nocobase/assets/525658/82ea4e0e-25fc-4921-841e-e1a2782a87d1" width="668" />
</figure>

작업자의 편의를 위해 다른 방법은 "워크플로우 계속" 버튼에 양식 값 할당을 설정하는 것입니다. 할당에 "상태" 필드를 추가하고 값을 "게시됨"으로 설정하면, 작업자가 버튼을 클릭했을 때 게시물이 "게시됨" 상태로 업데이트됩니다:

<figure>
  <img alt="수동 노드_예시_게시물 검토_노드 설정_양식 값 할당" src="https://github.com/nocobase/nocobase/assets/525658/0340bd9f-8323-4e4f-bc5a-8f81be3d6736" width="711" />
</figure>

그다음, 양식 블록의 오른쪽 상단 설정 메뉴에서 업데이트할 데이터의 필터 조건을 선택합니다. 여기서는 "게시물" 컬렉션을 선택하고, 필터 조건은 "ID `같음` 트리거 변수 / 트리거 데이터 / ID"로 설정합니다:

<figure>
  <img alt="수동 노드_예시_게시물 검토_노드 설정_양식 조건" src="https://github.com/nocobase/nocobase/assets/525658/da004055-0262-49ae-88dd-3844f3c92e28" width="1020" />
</figure>

마지막으로, 각 블록의 제목과 관련 버튼의 텍스트, 그리고 양식 필드의 힌트 텍스트를 수정하여 인터페이스를 더욱 사용자 친화적으로 만들 수 있습니다:

<figure>
  <img alt="수동 노드_예시_게시물 검토_노드 설정_최종 양식" src="https://github.com/nocobase/nocobase/assets/525658/21db5f6b-690b-49c1-8259-4f7b8862590d" width="678" />
</figure>

설정 패널을 닫고 제출 버튼을 클릭하여 노드 설정을 저장하면 워크플로우 설정이 완료됩니다. 이 워크플로우를 활성화하면 새 게시물이 생성될 때 자동으로 트리거됩니다. 관리자는 할 일 작업 목록에서 이 워크플로우가 처리되어야 함을 확인할 수 있으며, 클릭하여 확인하면 할 일 작업의 상세 정보를 볼 수 있습니다:

<figure>
  <img alt="수동 노드_예시_게시물 검토_할 일 목록" src="https://github.com/nocobase/nocobase/assets/525658/4e1748cd-6a07-4045-82e5-286826607826" width="1363" />
</figure>

<figure>
  <img alt="수동 노드_예시_게시물 검토_할 일 상세 정보" src="https://github.com/nocobase/nocobase/assets/525658/65f01fb1-8cb0-45f8-ac21-ec8ab59be449" width="680" />
</figure>

관리자는 게시물 상세 정보를 바탕으로 게시물 발행 여부를 수동으로 판단할 수 있습니다. 발행이 가능하다면 "승인" 버튼을 클릭하여 게시물을 "게시됨" 상태로 업데이트하고, 발행이 불가능하다면 "거부" 버튼을 클릭하여 게시물을 "초안" 상태로 유지합니다.

## 휴가 승인

직원이 휴가를 신청하면, 이는 상사의 승인을 받아야만 효력이 발생하며 해당 직원의 휴가 데이터가 차감된다고 가정해 봅시다. 승인 여부와 관계없이, 요청 노드를 통해 SMS API를 호출하여 직원에게 관련 알림 문자를 보냅니다([HTTP 요청](#_HTTP_请求) 섹션 참조). 이 시나리오는 수동 노드의 사용자 정의 양식을 사용하여 구현할 수 있습니다.

“휴가 신청 생성”에 의해 트리거되는 워크플로우를 생성하고 수동 노드를 추가합니다. 이는 이전 게시물 검토 프로세스와 유사하지만, 여기서는 담당자가 상사입니다. 인터페이스 설정에서 트리거 데이터 기반의 블록을 추가하여 새로 생성된 휴가 신청의 상세 정보를 표시하고, 사용자 정의 양식 기반의 블록을 추가하여 상사가 승인 여부를 결정하도록 합니다. 사용자 정의 양식에는 승인 상태 필드와 거부 사유 필드를 추가합니다:

<figure>
  <img alt="수동 노드_예시_휴가 승인_노드 설정" src="https://github.com/nocobase/nocobase/assets/525658/ef3bc7b8-56e8-4a4e-826e-ffd0b547d1b6" width="675" />
</figure>

게시물 검토 프로세스와 달리, 상사의 승인 결과에 따라 후속 프로세스를 계속 진행해야 하므로, 여기서는 "워크플로우 종료" 버튼을 사용하지 않고 제출용으로 "워크플로우 계속" 버튼만 설정합니다.

동시에 수동 노드 이후에는 조건 판단 노드를 사용하여 상사가 휴가 신청을 승인했는지 여부를 판단할 수 있습니다. 승인된 분기에는 휴가 데이터를 차감하는 데이터 처리를 추가하고, 분기가 끝난 후에는 직원에게 SMS 알림을 보내는 요청 노드를 추가하여 다음과 같은 완전한 워크플로우를 구성합니다:

<figure>
  `  <img alt="수동 노드_예시_휴가 승인_워크플로우 오케스트레이션" src="https://github.com/nocobase/nocobase/assets/525658/733f68da-e44f-4172-9772-a287ac2724f2" width="593" />`
</figure>

여기서 조건 판단 노드의 조건 설정은 "수동 노드 / 사용자 정의 양식 데이터 / 승인 필드의 값이 '승인됨'인지 여부"로 구성됩니다:

<figure>
  <img alt="수동 노드_예시_휴가 승인_조건 판단" src="https://github.com/nocobase/nocobase/assets/525658/57b972f0-a3ce-4f33-8d40-4272ad205c20" width="678" />
</figure>

요청 노드의 데이터는 수동 노드의 해당 양식 변수를 사용하여 승인 및 거부 SMS 내용을 구분할 수 있습니다. 이로써 전체 워크플로우 설정이 완료됩니다. 워크플로우가 활성화되면, 직원이 휴가 신청 양식을 제출한 후 상사는 할 일 작업에서 승인 처리를 진행할 수 있으며, 작업 방식은 게시물 검토 프로세스와 기본적으로 유사합니다.