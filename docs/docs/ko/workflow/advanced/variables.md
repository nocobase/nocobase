:::tip
이 문서는 AI로 번역되었습니다. 부정확한 내용이 있을 경우 [영어 버전](/en)을 참조하세요
:::

# 변수 사용하기

## 핵심 개념

프로그래밍 언어의 변수와 마찬가지로, 워크플로우에서 **변수**는 프로세스를 연결하고 구성하는 데 중요한 도구입니다.

워크플로우가 트리거된 후 각 노드가 실행될 때, 일부 설정 항목에서 변수를 사용할 수 있습니다. 변수의 출처는 해당 노드의 상위 노드 데이터이며, 다음 범주를 포함합니다.

- 트리거 컨텍스트 데이터: 작업 트리거, 컬렉션 트리거 등에서 단일 행 데이터 객체가 모든 노드에서 변수로 사용될 수 있습니다. 구체적인 내용은 각 트리거의 구현에 따라 다릅니다.
- 상위 노드 데이터: 프로세스가 임의의 노드에 도달했을 때, 이전에 완료된 노드의 결과 데이터입니다.
- 로컬 변수: 노드가 특정 분기 구조 내에 있을 때, 해당 분기 내에서만 사용할 수 있는 로컬 변수를 사용할 수 있습니다. 예를 들어, 루프 구조에서는 각 반복의 데이터 객체를 사용할 수 있습니다.
- 시스템 변수: 현재 시간과 같은 일부 내장 시스템 매개변수입니다.

[빠른 시작](../getting-started.md)에서 변수 기능을 여러 번 사용했습니다. 예를 들어, 계산 노드에서는 트리거 컨텍스트 데이터를 참조하는 변수를 사용하여 계산을 수행할 수 있습니다.

![함수 및 변수를 사용하는 계산 노드](https://static-docs.nocobase.com/837e4851a4c70a1932542caadef3431b.png)

업데이트 노드에서는 트리거 컨텍스트 데이터를 필터 조건 변수로 사용하고, 계산 노드의 결과를 업데이트할 데이터의 필드 값 변수로 참조할 수 있습니다.

![데이터 업데이트 노드 변수](https://static-docs.nocobase.com/2e147c93643e7ebc709b9b7ab4f3af8c.png)

## 데이터 구조

변수는 내부적으로 JSON 구조이며, 일반적으로 JSON 경로를 통해 데이터의 특정 부분을 사용할 수 있습니다. 많은 변수가 NocoBase의 컬렉션 구조를 기반으로 하므로, 관계형 데이터는 객체의 속성으로 계층적으로 구성되어 트리와 유사한 구조를 형성합니다. 예를 들어, 조회된 데이터의 관계형 데이터에서 특정 필드의 값을 선택할 수 있습니다. 또한, 관계형 데이터가 다대다(to-many) 구조일 경우 변수는 배열이 될 수 있습니다.

변수를 선택할 때는 대부분 마지막 레벨의 값 속성을 선택해야 하며, 이는 일반적으로 숫자, 문자열과 같은 단순 데이터 유형입니다. 하지만 변수 계층에 배열이 있을 경우, 마지막 레벨의 속성도 배열로 매핑됩니다. 해당 노드가 배열을 지원하는 경우에만 배열 데이터를 올바르게 처리할 수 있습니다. 예를 들어, 계산 노드에서는 일부 계산 엔진이 배열을 처리하는 전용 함수를 가지고 있으며, 루프 노드에서는 루프 객체로 배열을 직접 선택할 수도 있습니다.

예를 들어, 쿼리 노드가 여러 데이터를 조회했을 때, 노드 결과는 여러 행의 동질적인 데이터를 포함하는 배열이 됩니다.

```json
[
  {
    "id": 1,
    "title": "标题1"
  },
  {
    "id": 2,
    "title": "标题2"
  }
]
```

하지만 후속 노드에서 이를 변수로 사용할 때, 선택된 변수가 `노드 데이터/쿼리 노드/제목` 형식이라면, 해당 필드 값으로 매핑된 배열을 얻게 됩니다.

```json
["标题1", "标题2"]
```

만약 다차원 배열(예: 다대다 관계 필드)이라면, 해당 필드가 평탄화된 1차원 배열을 얻게 됩니다.

## 시스템 내장 변수

### 시스템 시간

실행된 노드에 따라 실행 당시의 시스템 시간을 가져옵니다. 이 시간의 시간대는 서버에 설정된 시간대입니다.

### 날짜 범위 매개변수

쿼리, 업데이트 및 삭제 노드에서 날짜 필터 조건을 설정할 때 사용할 수 있습니다. "같음" 비교에서만 지원되며, 날짜 범위의 시작 및 종료 시점은 모두 서버에 설정된 시간대를 기반으로 합니다.

![날짜 범위 매개변수](https://static-docs.nocobase.com/20240817175354.png)