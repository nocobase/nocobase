:::tip
이 문서는 AI로 번역되었습니다. 부정확한 내용이 있을 경우 [영어 버전](/en)을 참조하세요
:::

## 자주 묻는 질문 및 해결 방법

### 1. Excel 템플릿의 빈 열과 셀이 렌더링 결과에서 사라지는 문제

**문제 설명**: Excel 템플릿에서 특정 셀에 내용이나 스타일이 없으면 렌더링 시 해당 셀이 제거되어 최종 문서에서 누락될 수 있습니다.

**해결 방법**:

- **배경색 채우기**: 대상 영역의 빈 셀에 배경색을 채워 렌더링 과정에서 셀이 계속 표시되도록 합니다.
- **공백 삽입**: 빈 셀에 공백 문자를 삽입하여 실제 내용이 없더라도 셀 구조를 유지합니다.
- **테두리 설정**: 테이블에 테두리 스타일을 추가하여 셀의 경계를 명확히 하고 렌더링 시 셀이 사라지는 것을 방지합니다.

**예시**:

Excel 템플릿에서 모든 대상 셀에 연한 회색 배경을 설정하고 빈 셀에 공백을 삽입합니다.

### 2. 병합된 셀이 출력 시 적용되지 않는 문제

**문제 설명**: 반복 기능을 사용하여 테이블을 출력할 때 템플릿에 병합된 셀이 있으면 병합 효과가 사라지거나 데이터가 잘못 정렬되는 등 렌더링 결과가 비정상적으로 나타날 수 있습니다.

**해결 방법**:

- **병합된 셀 사용 피하기**: 데이터가 올바르게 렌더링되도록 반복 출력 테이블에서는 병합된 셀 사용을 최대한 피하십시오.
- **여러 열에 걸쳐 가운데 정렬 사용**: 여러 셀에 걸쳐 텍스트를 가로로 가운데 정렬해야 하는 경우, 셀 병합 대신 "여러 열에 걸쳐 가운데 정렬" 기능을 사용하십시오.
- **병합 셀 위치 제한**: 병합된 셀을 반드시 사용해야 하는 경우, 렌더링 시 병합 효과가 손실되는 것을 방지하기 위해 테이블의 위쪽이나 오른쪽에만 병합하고 아래쪽이나 왼쪽에는 병합하지 마십시오.

### 3. 반복 렌더링 영역 아래 내용으로 인해 서식 오류가 발생하는 문제

**문제 설명**: Excel 템플릿에서 데이터 항목에 따라 동적으로 행이 늘어나는 반복 영역(예: 주문 상세 내역) 아래에 다른 내용(예: 주문 요약, 비고)이 있는 경우, 렌더링 시 반복 생성된 데이터 행이 아래로 확장되면서 아래쪽의 고정된 내용을 덮어쓰거나 밀어내어 최종 문서의 서식이 흐트러지거나 내용이 겹치는 문제가 발생할 수 있습니다.

**해결 방법**:

  * **레이아웃 조정, 반복 영역을 맨 아래에 배치**: 가장 권장되는 방법입니다. 반복 렌더링이 필요한 테이블 영역을 전체 워크시트의 맨 아래에 배치하십시오. 원래 그 아래에 있던 요약, 서명 등의 모든 정보를 반복 영역 위로 이동합니다. 이렇게 하면 반복 데이터가 다른 요소에 영향을 주지 않고 자유롭게 아래로 확장될 수 있습니다.
  * **충분한 빈 행 확보**: 반복 영역 아래에 내용을 배치해야 하는 경우, 반복이 생성할 수 있는 최대 행 수를 예상하고 반복 영역과 아래 내용 사이에 충분한 빈 행을 수동으로 삽입하여 버퍼로 사용합니다. 하지만 이 방법은 실제 데이터가 예상 행 수를 초과하면 문제가 다시 발생할 수 있다는 위험이 있습니다.
  * **Word 템플릿 사용**: 레이아웃 요구 사항이 복잡하여 Excel 구조 조정으로는 해결할 수 없는 경우, Word 문서를 템플릿으로 사용하는 것을 고려할 수 있습니다. Word의 테이블은 행 수가 증가할 때 아래 내용을 자동으로 뒤로 밀어내어 내용 겹침 문제가 발생하지 않으므로, 이러한 동적 문서 생성에 더 적합합니다.

**예시**:

**잘못된 방식**: "주문 요약" 정보를 반복되는 "주문 상세 내역" 테이블 바로 아래에 배치합니다.
![20250820080712](https://static-docs.nocobase.com/20250820080712.png)

**올바른 방식 1 (레이아웃 조정)**: "주문 요약" 정보를 "주문 상세 내역" 테이블 위로 이동하여 반복 영역이 페이지의 맨 아래 요소가 되도록 합니다.
![20250820082226](https://static-docs.nocobase.com/2025082226.png)

**올바른 방식 2 (빈 행 확보)**: "주문 상세 내역"과 "주문 요약" 사이에 충분한 빈 행을 확보하여 반복 내용이 확장될 공간을 충분히 확보합니다.
![20250820081510](https://static-docs.nocobase.com/2025081510.png)

**올바른 방식 3**: Word 템플릿을 사용합니다.

### 4. 템플릿 렌더링 시 오류 메시지가 나타나는 문제

**문제 설명**: 템플릿 렌더링 과정에서 시스템 오류 메시지가 나타나 렌더링이 실패합니다.

**가능한 원인**:

- **플레이스홀더 오류**: 플레이스홀더 이름이 데이터셋 필드와 일치하지 않거나 구문 오류가 있습니다.
- **데이터 누락**: 데이터셋에 템플릿에서 참조하는 필드가 누락되었습니다.
- **포맷터 사용 오류**: 포맷터 매개변수가 잘못되었거나 지원되지 않는 포맷팅 유형입니다.

**해결 방법**:

- **플레이스홀더 확인**: 템플릿의 플레이스홀더 이름이 데이터셋의 필드 이름과 일치하고 구문이 올바른지 확인합니다.
- **데이터셋 검증**: 데이터셋에 템플릿에서 참조하는 모든 필드가 포함되어 있고 데이터 형식이 요구 사항을 충족하는지 확인합니다.
- **포맷터 조정**: 포맷터 사용 방법을 확인하고 매개변수가 올바른지, 지원되는 포맷팅 유형을 사용하는지 확인합니다.

**예시**:

**잘못된 템플릿**:
```
주문 번호: {d.orderId}
주문 날짜: {d.orderDate:format('YYYY/MM/DD')}
총 금액: {d.totalAmount:format('0.00')}
```

**데이터셋**:
```json
{
  "orderId": "A123456789",
  "orderDate": "2025-01-01T10:00:00Z"
  // totalAmount 필드 누락
}
```

**해결 방법**: 데이터셋에 `totalAmount` 필드를 추가하거나 템플릿에서 `totalAmount` 참조를 제거합니다.