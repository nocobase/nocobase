:::tip
이 문서는 AI로 번역되었습니다. 부정확한 내용이 있을 경우 [영어 버전](/en)을 참조하세요
:::

# HTTP API를 통해 사용자 데이터 동기화

## API 키 얻기

[API 키](/auth-verification/api-keys) 문서를 참고하여, API 키에 설정된 역할이 사용자 데이터 동기화 권한을 가지고 있는지 확인해야 합니다.

## API 개요

### 예시

```bash
curl 'https://localhost:13000/api/userData:push' \
  -H 'Authorization: Bearer <token>' \
  --data-raw '{"dataType":"user","records":[]}' # 요청 본문에 대한 자세한 내용은 아래를 참조하세요.
```

### 엔드포인트

```bash
POST /api/userData:push
```

### 사용자 데이터 형식

#### UserData

| 파라미터   | 타입                               | 설명                                                                 |
| ---------- | ---------------------------------- | -------------------------------------------------------------------- |
| `dataType` | `'user' \| 'department'`           | 필수. 푸시할 데이터의 타입입니다. 사용자 데이터를 푸시할 때는 `user`를 입력합니다. |
| `matchKey` | `'username' \| 'email' \| 'phone'` | 선택 사항. 제공된 필드와 푸시 데이터의 해당 필드 값을 기반으로 시스템에 이미 존재하는 사용자를 조회하여 매칭하는 데 사용됩니다. |
| `records`  | `UserRecord[]`                     | 필수. 사용자 데이터 레코드 배열입니다.                               |

#### UserRecord

| 파라미터      | 타입       | 설명                                                                                 |
| ------------- | ---------- | ------------------------------------------------------------------------------------ |
| `uid`         | `string`   | 필수. 원본 사용자 데이터의 고유 식별자입니다. 원본 데이터와 시스템 사용자를 연결하는 데 사용됩니다. 동일한 사용자에 대해서는 변경할 수 없습니다. |
| `nickname`    | `string`   | 선택 사항. 사용자 닉네임입니다.                                                      |
| `username`    | `string`   | 선택 사항. 사용자 이름입니다.                                                        |
| `email`       | `string`   | 선택 사항. 사용자 이메일 주소입니다.                                                 |
| `phone`       | `string`   | 선택 사항. 사용자 전화번호입니다.                                                    |
| `departments` | `string[]` | 선택 사항. 사용자가 속한 부서의 UID 배열입니다.                                      |
| `isDeleted`   | `boolean`  | 선택 사항. 레코드 삭제 여부를 나타냅니다.                                            |
| `<field>`     | `any`      | 선택 사항. 사용자 테이블의 기타 사용자 정의 필드 데이터입니다.                       |

### 부서 데이터 형식

:::info
부서 데이터를 푸시하려면 [부서](../../departments) 플러그인이 설치 및 활성화되어 있어야 합니다.
:::

#### DepartmentData

| 파라미터   | 타입                     | 설명                                                                 |
| ---------- | ------------------------ | -------------------------------------------------------------------- |
| `dataType` | `'user' \| 'department'` | 필수. 푸시할 데이터의 타입입니다. 부서 데이터를 푸시할 때는 `department`를 입력합니다. |
| `records`  | `DepartmentRecord[]`     | 필수. 부서 데이터 레코드 배열입니다.                                 |

#### DepartmentRecord

| 파라미터    | 타입      | 설명                                                                                 |
| ----------- | --------- | ------------------------------------------------------------------------------------ |
| `uid`       | `string`  | 필수. 원본 부서 데이터의 고유 식별자입니다. 원본 데이터와 시스템 부서를 연결하는 데 사용됩니다. 동일한 부서에 대해서는 변경할 수 없습니다. |
| `title`     | `string`  | 필수. 부서 제목입니다.                                                               |
| `parentUid` | `string`  | 선택 사항. 상위 부서의 UID입니다.                                                    |
| `isDeleted` | `boolean` | 선택 사항. 레코드 삭제 여부를 나타냅니다.                                            |
| `<field>`   | `any`     | 선택 사항. 부서 테이블의 기타 사용자 정의 필드 데이터입니다.                         |

:::info

1.  데이터를 여러 번 푸시해도 멱등성을 유지합니다.
2.  부서 데이터를 푸시할 때 상위 부서가 아직 생성되지 않았다면, 연결할 수 없습니다. 상위 부서가 생성된 후 데이터를 다시 푸시할 수 있습니다.
3.  사용자 데이터를 푸시할 때 부서가 아직 생성되지 않았다면, 해당 부서에 연결할 수 없습니다. 부서 데이터를 푸시한 후 사용자 데이터를 다시 푸시할 수 있습니다.

:::