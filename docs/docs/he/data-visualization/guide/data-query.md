:::tip
מסמך זה תורגם על ידי בינה מלאכותית. לכל אי דיוק, אנא עיין ב[גרסה האנגלית](/en)
:::

# שאילתת נתונים

פאנל הגדרות התרשים מחולק לשלושה חלקים עיקריים: שאילתת נתונים, אפשרויות תרשים ואירועי אינטראקציה, בנוסף לכפתורי ביטול, תצוגה מקדימה ושמירה בתחתית.

בואו נתחיל עם פאנל "שאילתת נתונים" כדי להבין את שני מצבי השאילתה (Builder/SQL) ואת הפונקציונליות הנפוצה שלהם.

## מבנה הפאנל
![clipboard-image-1761466636](https://static-docs.nocobase.com/clipboard-image-1761466636.png)

> טיפ: כדי להקל על הגדרת התוכן הנוכחי, תוכלו לקפל פאנלים אחרים תחילה.

בחלק העליון נמצא סרגל הפעולות:
- מצב: Builder (גרפי, פשוט ונוח) / SQL (פקודות כתובות ידנית, גמיש יותר).
- הפעל שאילתה: לחצו כדי לבצע את בקשת שאילתת הנתונים.
- הצג תוצאה: פותח את פאנל תוצאות הנתונים, שם תוכלו לעבור בין תצוגות טבלה/JSON. לחצו שוב כדי לקפל את הפאנל.

מלמעלה למטה, תמצאו:
- מקור נתונים ו**אוסף**: חובה. בחרו את מקור הנתונים ואת ה**אוסף**.
- מדדים (Measures): חובה. שדות המספרים שיוצגו.
- ממדים (Dimensions): קבצו לפי שדות (לדוגמה, תאריך, קטגוריה, אזור).
- סינון: הגדירו תנאי סינון (לדוגמה, =, ≠, >, <, מכיל, טווח). ניתן לשלב מספר תנאים.
- מיון: בחרו את השדה למיון ואת הסדר (עולה/יורד).
- עמודים: שלטו בטווח הנתונים ובסדר ההחזרה.

## מצב Builder

### בחירת מקור נתונים ו**אוסף**
- בפאנל "שאילתת נתונים", הגדירו את המצב ל-"Builder".
- בחרו **מקור נתונים** ו**אוסף**. אם ה**אוסף** אינו ניתן לבחירה או ריק, בדקו תחילה הרשאות והאם הוא נוצר.

### הגדרת מדדים (Measures)
- בחרו שדה מספרי אחד או יותר והגדירו אגרגציה: `Sum`, `Count`, `Avg`, `Max`, `Min`.
- תרחישי שימוש נפוצים: `Count` לספירת רשומות, `Sum` לחישוב סכום כולל.

### הגדרת ממדים (Dimensions)
- בחרו שדה אחד או יותר כממדי קיבוץ.
- שדות תאריך ושעה ניתנים לעיצוב (לדוגמה, `YYYY-MM`, `YYYY-MM-DD`) כדי להקל על קיבוץ לפי חודש או יום.

### סינון, מיון ועמודים
- סינון: הוסיפו תנאים (לדוגמה, =, ≠, מכיל, טווח). ניתן לשלב מספר תנאים.
- מיון: בחרו שדה וסדר מיון (עולה/יורד).
- עמודים: הגדירו `Limit` ו-`Offset` כדי לשלוט במספר השורות המוחזרות. מומלץ להגדיר `Limit` קטן בעת איתור באגים.

### הפעלת שאילתה והצגת תוצאה
- לחצו על "הפעל שאילתה" כדי לבצע. לאחר קבלת התוצאה, עברו בין `Table / JSON` ב"הצג תוצאה" כדי לבדוק את העמודות והערכים.
- לפני מיפוי שדות התרשים, ודאו כאן את שמות העמודות והסוגים שלהן כדי למנוע תרשים ריק או שגיאות בהמשך.

![20251026174338](https://static-docs.nocobase.com/20251026174338.png)

### מיפוי שדות עוקב

בהמשך, בעת הגדרת "אפשרויות תרשים", תמפו שדות בהתבסס על השדות מ**מקור הנתונים** וה**אוסף** שנבחרו.

## מצב SQL

### כתיבת שאילתה
- עברו למצב "SQL", הזינו את פקודת השאילתה שלכם, ולחצו על "הפעל שאילתה".
- דוגמה (סכום הזמנה כולל לפי תאריך):
```sql
SELECT
  TO_CHAR(order_date, 'YYYY-MM') as mon,
  SUM(total_amount) AS total
FROM "order"
GROUP BY mon
ORDER BY mon ASC
LIMIT 100;
```

![20251026175952](https://static-docs.nocobase.com/20251026175952.png)

### הפעלת שאילתה והצגת תוצאה

- לחצו על "הפעל שאילתה" כדי לבצע. לאחר קבלת התוצאה, עברו בין `Table / JSON` ב"הצג תוצאה" כדי לבדוק את העמודות והערכים.
- לפני מיפוי שדות התרשים, ודאו כאן את שמות העמודות והסוגים שלהן כדי למנוע תרשים ריק או שגיאות בהמשך.

### מיפוי שדות עוקב

בהמשך, בעת הגדרת "אפשרויות תרשים", תמפו שדות בהתבסס על העמודות מתוצאת השאילתה.

> [!TIP]
> למידע נוסף על מצב SQL, עיינו בשימוש מתקדם — שאילתת נתונים במצב SQL.