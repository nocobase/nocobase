:::tip
מסמך זה תורגם על ידי בינה מלאכותית. לכל אי דיוק, אנא עיין ב[גרסה האנגלית](/en)
:::

# שאילתת נתונים במצב SQL

בפאנל "שאילתת נתונים", עברו למצב SQL, כתבו והריצו את השאילתה, והשתמשו בתוצאה המוחזרת ישירות למיפוי ורינדור תרשימים.

![20251027075805](https://static-docs.nocobase.com/20251027075805.png)

## כתיבת שאילתות SQL
- בפאנל "שאילתת נתונים", בחרו במצב SQL.
- הזינו SQL ולחצו על "הרץ שאילתה".
- תומך בפקודות SQL מורכבות, כולל JOIN מרובה טבלאות ו-VIEW.

דוגמה: סכום הזמנות לפי חודש
```sql
SELECT
  TO_CHAR(order_date, 'YYYY-MM') as mon,
  SUM(total_amount) AS total
FROM "order"
GROUP BY mon
ORDER BY mon ASC
LIMIT 100;
```

## הצגת תוצאות
- לחצו על "הצג נתונים" כדי לפתוח את פאנל תצוגה מקדימה של הנתונים.

![20251027080014](https://static-docs.nocobase.com/20251027080014.png)

הנתונים תומכים בתצוגה מחולקת לדפים (פגינציה); ניתן לעבור בין Table ל-JSON כדי לבדוק שמות עמודות וסוגים.
![20251027080100](https://static-docs.nocobase.com/20251027080100.png)

## מיפוי שדות
- באפשרויות התרשים, מפו שדות בהתבסס על עמודות תוצאת השאילתה.
- כברירת מחדל, העמודה הראשונה תשמש כמימד (ציר X או קטגוריה), והעמודה השנייה כמדד (ציר Y או ערך). לכן, שימו לב לסדר השדות ב-SQL:

```sql
SELECT
  TO_CHAR(order_date, 'YYYY-MM') as mon, -- שדה מימד בעמודה הראשונה
  SUM(total_amount) AS total -- שדה מדד בהמשך
```

![clipboard-image-1761524022](https://static-docs.nocobase.com/clipboard-image-1761524022.png)

## שימוש במשתני הקשר
לחצו על כפתור ה-x בפינה הימנית העליונה של עורך ה-SQL כדי לבחור משתני הקשר.

![20251027081752](https://static-docs.nocobase.com/20251027081752.png)

לאחר אישור הבחירה, ביטוי המשתנה יוחדר במיקום הסמן (או יחליף את הטקסט הנבחר) בטקסט ה-SQL.

לדוגמה, `{{ ctx.user.createdAt }}`. שימו לב לא להוסיף גרשיים נוספים בעצמכם.

![20251027081957](https://static-docs.nocobase.com/20251027081957.png)

## דוגמאות נוספות
לדוגמאות שימוש נוספות, עיינו ב[אפליקציית הדמו](https://demo3.sg.nocobase.com/admin/5xrop8s0bui) של NocoBase.

**המלצות:**
- ודאו ששמות העמודות יציבים לפני מיפוי לתרשימים, כדי למנוע שגיאות בהמשך.
- בשלב הדיבוג, הגדירו `LIMIT` כדי להפחית את מספר השורות המוחזרות ולהאיץ את התצוגה המקדימה.

## תצוגה מקדימה, שמירה וביטול שינויים
- לחיצה על "הרץ שאילתה" תבצע בקשת נתונים ותרענן את תצוגת התרשים המקדימה.
- לחיצה על "שמור" תשמור את טקסט ה-SQL הנוכחי והגדרות קשורות במסד הנתונים.
- לחיצה על "בטל" תחזיר למצב השמור האחרון ותבטל שינויים שלא נשמרו.