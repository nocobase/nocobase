---
pkg: '@nocobase/plugin-workflow-variable'
---
:::tip
מסמך זה תורגם על ידי בינה מלאכותית. לכל אי דיוק, אנא עיין ב[גרסה האנגלית](/en)
:::


# משתנה

## מבוא

ניתן להצהיר על משתנים בתוך תהליך עבודה, או להקצות ערכים למשתנים שהוצהרו עליהם. שימוש זה נפוץ לשמירת נתונים זמניים בתוך התהליך.

## יצירת צומת

בממשק הגדרות תהליך העבודה, לחצו על כפתור הפלוס ("+") בתוך התהליך כדי להוסיף צומת "משתנה":

![הוספת צומת משתנה](https://static-docs.nocobase.com/53b1e48e777bfff7f2a08271526ef3ee.png)

## הגדרת צומת

### מצב

צומת המשתנה דומה למשתנים בתכנות; יש להצהיר עליו לפני שניתן להשתמש בו ולהקצות לו ערך. לכן, בעת יצירת צומת משתנה, עליכם לבחור את מצב המשתנה. קיימים שני מצבים לבחירה:

![בחירת מצב](https://static-docs.nocobase.com/49d8b701de6faef6f303262aa14550.png)

- הצהרה על משתנה חדש: יוצר משתנה חדש.
- הקצאה למשתנה קיים: מקצה ערך למשתנה שהוצהר עליו קודם לכן בתהליך העבודה, מה ששקול לשינוי ערך המשתנה.

כאשר הצומת שנוצר הוא צומת המשתנה הראשון בתהליך העבודה, ניתן לבחור רק במצב הצהרה, מכיוון שעדיין אין משתנים זמינים להקצאה.

כאשר אתם בוחרים להקצות ערך למשתנה שהוצהר עליו, עליכם גם לבחור את משתנה היעד, שהוא הצומת שבו הוצהר המשתנה:

![בחירת המשתנה להקצאת ערך](https://static-docs.nocobase.com/1ce8911548d7347e693d8cc8ac193eb.png)

### ערך

ערכו של משתנה יכול להיות מכל סוג. הוא יכול להיות קבוע, כגון מחרוזת, מספר, ערך בוליאני או תאריך, או שהוא יכול להיות משתנה אחר מתוך תהליך העבודה.

במצב הצהרה, הגדרת ערך המשתנה שקולה להקצאת ערך התחלתי למשתנה.

![הצהרה על ערך התחלתי](https://static-docs.nocobase.com/4ce2c508986565ad537343013758c6a4.png)

במצב הקצאה, הגדרת ערך המשתנה שקולה לשינוי ערכו של משתנה היעד שהוצהר עליו לערך חדש. בשימושים עתידיים, יתקבל ערך חדש זה.

![הקצאת משתנה טריגר למשתנה שהוצהר עליו](https://static-docs.nocobase.com/858bae180712ad279ae6a964a77a7659.png)

## שימוש בערך המשתנה

בצמתים הבאים לאחר צומת המשתנה, תוכלו להשתמש בערך המשתנה על ידי בחירת המשתנה שהוצהר עליו מתוך קבוצת "משתני צומת". לדוגמה, בצומת שאילתה, השתמשו בערך המשתנה כתנאי שאילתה:

![שימוש בערך משתנה כתנאי סינון שאילתה](https://static-docs.nocobase.com/1ca91c29524ff85999a1751499f14bc.png)

## דוגמה

תרחיש שימושי יותר עבור צומת המשתנה הוא בענפים, כאשר ערכים חדשים מחושבים או ממוזגים עם ערכים קודמים (בדומה ל-`reduce`/`concat` בתכנות), ולאחר מכן נעשה בהם שימוש בסיום הענף. להלן דוגמה למימוש שרשור מחרוזת נמענים באמצעות ענף לולאה וצומת משתנה.

ראשית, צרו תהליך עבודה המופעל על ידי אוסף, שמופעל כאשר נתוני "מאמר" מתעדכנים, וטען מראש את נתוני הקשר "מחבר" הרלוונטיים (לצורך קבלת נמענים):

![הגדרת טריגר](https://static-docs.nocobase.com/93327530a93c695c637d74cdfdcd5cde.png)

לאחר מכן, צרו צומת משתנה, שישמש לאחסון מחרוזת הנמענים:

![צומת משתנה נמענים](https://static-docs.nocobase.com/d26fa4a7e7ee4f34e0d8392a51c6666e.png)

בשלב הבא, צרו צומת ענף לולאה, שישמש למעבר על מחברי המאמר ושרשור פרטי הנמענים שלהם לתוך משתנה הנמענים:

![מעבר בלולאה על מחברים במאמר](https://static-docs.nocobase.com/083fe62c943c17a643dc47ec2872e07c.png)

בתוך ענף הלולאה, צרו תחילה צומת חישוב, שישמש לשרשור המחבר הנוכחי עם מחרוזת המחברים שכבר נשמרה:

![שרשור מחרוזת נמענים](https://static-docs.nocobase.com/5d21a990162f32cb8818d27b16fd1bcd.png)

לאחר צומת החישוב, צרו צומת משתנה נוסף. בחרו במצב הקצאה, בחרו בצומת משתנה הנמענים כיעד ההקצאה, ובחרו בתוצאת צומת החישוב כערך:

![הקצאת מחרוזת הנמענים המשותזרת לצומת הנמענים](https://static-docs.nocobase.com/fc40ed95dd9b61d924b7ca11b23f9482.png)

בדרך זו, לאחר סיום ענף הלולאה, משתנה הנמענים יאחסן את מחרוזת הנמענים של כל מחברי המאמר. לאחר מכן, תוכלו להשתמש בצומת בקשת HTTP כדי לקרוא לממשק API לשליחת דוא"ל, ולהעביר את ערך משתנה הנמענים כפרמטר הנמען לממשק ה-API:

![שליחת דוא"ל לנמענים באמצעות צומת הבקשה](https://static-docs.nocobase.com/37f71aa1a63e172bcb2dce10a250947e.png)

בשלב זה, פונקציונליות פשוטה לשליחת דוא"ל המוני מומשה באמצעות לולאה וצומת משתנה.