---
pkg: '@nocobase/plugin-workflow-manual'
---
:::tip
מסמך זה תורגם על ידי בינה מלאכותית. לכל אי דיוק, אנא עיין ב[גרסה האנגלית](/en)
:::


# טיפול ידני

## מבוא

כאשר תהליך עסקי אינו יכול לקבל החלטות באופן אוטומטי לחלוטין, ניתן להשתמש בצומת (node) ידני כדי להאציל חלק מסמכות קבלת ההחלטות לאדם.

כאשר צומת ידני מופעל, הוא קוטע את ביצוע תהליך העבודה כולו ומייצר משימת "לביצוע" (to-do) עבור המשתמש המתאים. לאחר שהמשתמש שולח את המשימה, תהליך העבודה ימשיך, יישאר בהמתנה, או יסתיים, בהתאם לסטטוס שנבחר. זה שימושי מאוד בתרחישים כמו תהליכי אישור.

## התקנה

תוסף מובנה, אין צורך בהתקנה.

## יצירת צומת

בממשק הגדרות תהליך העבודה, לחצו על כפתור הפלוס ("+") בתהליך העבודה כדי להוסיף צומת "טיפול ידני":

![יצירת צומת ידני](https://static-docs.nocobase.com/4dd259f1aceeaf9b25abb4b257df909.png)

## הגדרת צומת

### אחראי

צומת ידני דורש הגדרת משתמש כאחראי על ביצוע משימת ה"לביצוע". את רשימת משימות ה"לביצוע" ניתן להוסיף כבלוק בעמוד, ותוכן חלון קופץ של משימה עבור כל צומת צריך להיות מוגדר בהגדרות הממשק של הצומת.

בחרו משתמש, או בחרו את מפתח ראשי (primary key) או מפתח זר (foreign key) של נתוני משתמש מההקשר באמצעות משתנה.

![צומת ידני_הגדרות_אחראי_בחירת משתנה](https://static-docs.nocobase.com/22fbca3b8e21fda1019037001445.png)

:::info{title=הערה}
נכון לעכשיו, אפשרות האחראי בצומת ידני אינה תומכת במספר משתמשים. תמיכה זו תתווסף בגרסה עתידית.
:::

### הגדרת ממשק משתמש

הגדרת הממשק עבור פריט ה"לביצוע" היא הליבה של הצומת הידני. תוכלו ללחוץ על כפתור "הגדר ממשק משתמש" כדי לפתוח חלון קופץ נפרד להגדרות, שניתן להגדיר בשיטת WYSIWYG (מה שאתם רואים זה מה שאתם מקבלים), בדיוק כמו עמוד רגיל:

![צומת ידני_הגדרות צומת_הגדרות ממשק](https://static-docs.nocobase.com/fd360168c879743cf22d57440cd2590f.png)

#### לשוניות

לשוניות יכולות לשמש להבחנה בין תכנים שונים. לדוגמה, לשונית אחת להגשת טופס אישור, אחרת להגשת טופס דחייה, או להצגת פרטים של נתונים קשורים. ניתן להגדיר אותן בחופשיות.

#### בלוקים

סוגי הבלוקים הנתמכים מחולקים בעיקר לשתי קטגוריות: בלוקי נתונים ובלוקי טפסים. בנוסף, Markdown משמש בעיקר לתוכן סטטי כגון הודעות מידע.

##### בלוק נתונים

בלוקי נתונים יכולים להציג נתוני טריגר או את תוצאות העיבוד של כל צומת, ובכך לספק מידע הקשרי רלוונטי לאחראי על משימת ה"לביצוע". לדוגמה, אם תהליך העבודה מופעל על ידי אירוע טופס, תוכלו ליצור בלוק פרטים עבור נתוני הטריגר. זה תואם את הגדרת הפרטים של עמוד רגיל, ומאפשר לכם לבחור כל שדה מנתוני הטריגר להצגה:

![צומת ידני_הגדרות צומת_הגדרות ממשק_בלוק נתונים_טריגר](https://static-docs.nocobase.com/675c3e58a1a4f45db310a72c2d0a404c.png)

בלוקי נתוני צומת דומים; תוכלו לבחור את תוצאת הנתונים מצומת קודם כדי להציג כפרטים. לדוגמה, התוצאה של צומת חישוב קודם יכולה לשמש כמידע עזר הקשרי למשימת ה"לביצוע" של האחראי:

![צומת ידני_הגדרות צומת_הגדרות ממשק_בלוק נתונים_נתוני צומת](https://static-docs.nocobase.com/a583e26e51a4f45db310a72c2d0a404c.png)

:::info{title=הערה}
מכיוון שתהליך העבודה אינו במצב ביצוע במהלך הגדרת הממשק, לא מוצגים נתונים ספציפיים בבלוקי הנתונים. הנתונים הרלוונטיים עבור מופע ספציפי של תהליך עבודה יוצגו בממשק החלון הקופץ של ה"לביצוע" רק לאחר שתהליך העבודה הופעל ובוצע.
:::

##### בלוק טופס

יש להגדיר לפחות בלוק טופס אחד בממשק ה"לביצוע" כדי לטפל בהחלטה הסופית האם תהליך העבודה ימשיך. אי הגדרת טופס תמנע מתהליך העבודה להמשיך לאחר שהוא נקטע. ישנם שלושה סוגים של בלוקי טפסים:

- טופס מותאם אישית
- טופס יצירת רשומה
- טופס עדכון רשומה

![צומת ידני_הגדרות צומת_הגדרות ממשק_סוגי טפסים](https://static-docs.nocobase.com/2d068f3012ab07e32a265405492104a8.png)

טופסי יצירת רשומה וטופסי עדכון רשומה דורשים בחירת **אוסף** בסיס. לאחר שהמשתמש האחראי על ה"לביצוע" ישלח את הטופס, הערכים בטופס ישמשו ליצירה או עדכון של נתונים ב**אוסף** שצוין. טופס מותאם אישית מאפשר לכם להגדיר בחופשיות טופס זמני שאינו קשור ל**אוסף**. ערכי השדות שנשלחו על ידי המשתמש האחראי על ה"לביצוע" יכולים לשמש בצמתים הבאים.

ניתן להגדיר את כפתורי השליחה של הטופס לשלושה סוגים:

- שלח והמשך תהליך עבודה
- שלח וסיים תהליך עבודה
- שמור ערכי טופס בלבד

![צומת ידני_הגדרות צומת_הגדרות ממשק_כפתורי טופס](https://static-docs.nocobase.com/6b45995b14152e85a821dff6f6e3189a.png)

שלושת הכפתורים מייצגים שלושה סטטוסים של צומת בתהליך העבודה. לאחר השליחה, סטטוס הצומת משתנה ל"הושלם", "נדחה", או נשאר במצב "בהמתנה". טופס חייב לכלול לפחות אחד משני הכפתורים הראשונים כדי לקבוע את המשך זרימת תהליך העבודה כולו.

בכפתור "המשך תהליך עבודה", תוכלו להגדיר הקצאות עבור שדות הטופס:

![צומת ידני_הגדרות צומת_הגדרות ממשק_כפתור טופס_הגדר ערכי טופס](https://static-docs.nocobase.com/2cec2d4e2957f068877e616dec3b56dd.png)

![צומת ידני_הגדרות צומת_הגדרות ממשק_כפתור טופס_חלון קופץ הגדר ערכי טופס](https://static-docs.nocobase.com/5ff51b60c76cdb76e6f1cc95dc3d8640.png)

לאחר פתיחת החלון הקופץ, תוכלו להקצות ערכים לכל שדה בטופס. לאחר שליחת הטופס, ערך זה יהיה הערך הסופי של השדה. זה שימושי במיוחד בעת סקירת נתונים. תוכלו להשתמש במספר כפתורי "המשך תהליך עבודה" שונים בטופס, כאשר כל כפתור מגדיר ערכי enum שונים עבור שדות כמו סטטוס, ובכך להשיג את האפקט של המשך ביצוע תהליך העבודה הבא עם ערכי נתונים שונים.

## בלוק "לביצוע"

לצורך טיפול ידני, עליכם גם להוסיף רשימת "לביצוע" לעמוד כדי להציג משימות "לביצוע". זה מאפשר לאנשים הרלוונטיים לגשת ולטפל במשימות הספציפיות של הצומת הידני דרך רשימה זו.

### הוספת בלוק

תוכלו לבחור "משימות לביצוע של תהליך עבודה" מבין הבלוקים בעמוד כדי להוסיף בלוק של רשימת "לביצוע":

![צומת ידני_הוספת בלוק לביצוע](https://static-docs.nocobase.com/198b41754cd73b704267bf30fe5e647.png)

דוגמה לבלוק רשימת "לביצוע":

![צומת ידני_רשימת לביצוע](https://static-docs.nocobase.com/cfefb0d2c6a91c5c9dfa550d6b220f34.png)

### פרטי "לביצוע"

לאחר מכן, האנשים הרלוונטיים יכולים ללחוץ על משימת ה"לביצוע" המתאימה כדי לפתוח את החלון הקופץ של ה"לביצוע" ולבצע את הטיפול הידני:

![צומת ידני_פרטי לביצוע](https://static-docs.nocobase.com/ccfd0533deebff6b3f6ef4408066e688.png)

## דוגמה

### סקירת פוסט

נניח שפוסט שנשלח על ידי משתמש רגיל צריך להיות מאושר על ידי מנהל מערכת לפני שניתן לעדכן אותו למצב "פורסם". אם תהליך העבודה נדחה, הפוסט יישאר במצב "טיוטה" (לא ציבורי). תהליך זה יכול להיות מיושם באמצעות טופס עדכון בצומת ידני.

צרו **תהליך עבודה** המופעל על ידי "יצירת פוסט" והוסיפו צומת ידני:

<figure>
  <img alt="צומת ידני_דוגמה_סקירת פוסט_תיאום תהליך עבודה" src="https://github.com/nocobase/nocobase/assets/525658/2021bf42-f372-4f69-9c84-5a786c061e0e" width="360" />
</figure>

בצומת הידני, הגדירו את האחראי כמנהל מערכת. בהגדרות הממשק, הוסיפו בלוק המבוסס על נתוני הטריגר כדי להציג את פרטי הפוסט החדש:

<figure>
  <img alt="צומת ידני_דוגמה_סקירת פוסט_הגדרות צומת_בלוק פרטים" src="https://github.com/nocobase/nocobase/assets/525658/c61d0aac-23cb-4387-b60e-ce3cc7bf1c24" width="680" />
</figure>

בהגדרות הממשק, הוסיפו בלוק המבוסס על טופס עדכון רשומה, בחרו את **אוסף** הפוסטים, כדי שהמנהל יחליט אם לאשר. לאחר האישור, הפוסט המתאים יעודכן בהתבסס על הגדרות נוספות בהמשך. לאחר הוספת הטופס, יהיה כפתור "המשך תהליך עבודה" כברירת מחדל, אותו ניתן לראות כ"אישור". לאחר מכן, הוסיפו כפתור "סיים תהליך עבודה" שישמש לדחייה:

<figure>
  <img alt="צומת ידני_דוגמה_סקירת פוסט_הגדרות צומת_טופס ופעולות" src="https://github.com/nocobase/nocobase/assets/525658/4baaf41e-3d81-4ee8-a038-29db05e0d99f" width="673" />
</figure>

כאשר ממשיכים את תהליך העבודה, עלינו לעדכן את סטטוס הפוסט. ישנן שתי דרכים להגדיר זאת. אחת היא להציג את שדה הסטטוס של הפוסט ישירות בטופס לבחירת המפעיל. שיטה זו מתאימה יותר למצבים הדורשים מילוי טופס אקטיבי, כגון מתן משוב:

<figure>
  <img alt="צומת ידני_דוגמה_סקירת פוסט_הגדרות צומת_שדות טופס" src="https://github.com/nocobase/nocobase/assets/525658/82ea4e0e-25fc-4921-841e-e1a2782a87d1" width="668" />
</figure>

כדי לפשט את משימת המפעיל, דרך נוספת היא להגדיר הקצאת ערך לטופס בכפתור "המשך תהליך עבודה". בהקצאה, הוסיפו שדה "סטטוס" עם הערך "פורסם". משמעות הדבר היא שכאשר המפעיל ילחץ על הכפתור, הפוסט יעודכן למצב "פורסם":

<figure>
  <img alt="צומת ידני_דוגמה_סקירת פוסט_הגדרות צומת_הקצאת טופס" src="https://github.com/nocobase/nocobase/assets/525658/0340bd9f-8323-4e4f-bc5a-8f81be3d6736" width="711" />
</figure>

לאחר מכן, מתפריט ההגדרות בפינה הימנית העליונה של בלוק הטופס, בחרו את תנאי הסינון עבור הנתונים שיש לעדכן. כאן, בחרו את **אוסף** "פוסטים", ותנאי הסינון הוא "מזהה `שווה ל` משתנה טריגר / נתוני טריגר / מזהה":

<figure>
  <img alt="צומת ידני_דוגמה_סקירת פוסט_הגדרות צומת_תנאי טופס" src="https://github.com/nocobase/nocobase/assets/525658/da004055-0262-49ae-88dd-3844f3c92e28" width="1020" />
</figure>

לבסוף, תוכלו לשנות את הכותרות של כל בלוק, את הטקסט של הכפתורים הרלוונטיים, ואת טקסט הטיפים של שדות הטופס כדי להפוך את הממשק לידידותי יותר למשתמש:

<figure>
  <img alt="צומת ידני_דוגמה_סקירת פוסט_הגדרות צומת_טופס סופי" src="https://github.com/nocobase/nocobase/assets/525658/21db5f6b-690b-49c1-8259-4f7b8874620d" width="678" />
</figure>

סגרו את לוח ההגדרות ולחצו על כפתור השליחה כדי לשמור את הגדרות הצומת. **תהליך העבודה** כעת מוגדר. לאחר הפעלת **תהליך עבודה** זה, הוא יופעל אוטומטית כאשר פוסט חדש נוצר. המנהל יכול לראות ש**תהליך עבודה** זה דורש טיפול מרשימת משימות ה"לביצוע". לחיצה לצפייה תציג את פרטי משימת ה"לביצוע":

<figure>
  <img alt="צומת ידני_דוגמה_סקירת פוסט_רשימת לביצוע" src="https://github.com/nocobase/nocobase/assets/525658/4e1748cd-6a07-4045-82e5-286826607826" width="1363" />
</figure>

<figure>
  <img alt="צומת ידני_דוגמה_סקירת פוסט_פרטי לביצוע" src="https://github.com/nocobase/nocobase/assets/525658/65f01fb1-8cb0-45f8-ac21-ec8ab59be449" width="680" />
</figure>

המנהל יכול לבצע שיקול דעת ידני בהתבסס על פרטי הפוסט כדי להחליט אם ניתן לפרסם את הפוסט. אם כן, לחיצה על כפתור "אישור" תעדכן את הפוסט למצב "פורסם". אם לא, לחיצה על כפתור "דחה" תשמור את הפוסט במצב "טיוטה".

## אישור חופשה

נניח שעובד צריך לבקש חופשה, שחייבת להיות מאושרת על ידי מנהל כדי להיכנס לתוקף, ונתוני החופשה של העובד המתאים צריכים להיות מנוכים. ללא קשר לאישור או דחייה, צומת בקשת HTTP ישמש לקריאת API של SMS כדי לשלוח הודעת התראה לעובד (ראו את סעיף [בקשת HTTP](#_HTTP_请求)). תרחיש זה יכול להיות מיושם באמצעות טופס מותאם אישית בצומת ידני.

צרו **תהליך עבודה** המופעל על ידי "יצירת בקשת חופשה" והוסיפו צומת ידני. זה דומה לתהליך סקירת הפוסט הקודם, אך כאן האחראי הוא המנהל. בהגדרות הממשק, הוסיפו בלוק המבוסס על נתוני הטריגר כדי להציג את פרטי בקשת החופשה החדשה. לאחר מכן, הוסיפו בלוק נוסף המבוסס על טופס מותאם אישית כדי שהמנהל יחליט אם לאשר. בטופס המותאם אישית, הוסיפו שדה לסטטוס האישור ושדה לסיבת הדחייה:

<figure>
  <img alt="צומת ידני_דוגמה_אישור חופשה_הגדרות צומת" src="https://github.com/nocobase/nocobase/assets/525658/ef3bc7b8-56e8-4a4e-826e-ffd0b547d1b6" width="675" />
</figure>

בניגוד לתהליך סקירת הפוסט, מכיוון שעלינו להמשיך את התהליך הבא בהתבסס על תוצאת אישור המנהל, אנו מגדירים כאן רק כפתור "המשך תהליך עבודה" לשליחה, מבלי להשתמש בכפתור "סיים תהליך עבודה".

במקביל, לאחר הצומת הידני, אנו יכולים להשתמש בצומת תנאי כדי לקבוע אם המנהל אישר את בקשת החופשה. בענף האישור, הוסיפו עיבוד נתונים לניכוי חופשה, ולאחר מיזוג הענפים, הוסיפו צומת בקשה לשליחת הודעת SMS לעובד. זה מביא ל**תהליך עבודה** השלם הבא:

<figure>
  <img alt="צומת ידני_דוגמה_אישור חופשה_תיאום תהליך עבודה" src="https://github.com/nocobase/nocobase/assets/525658/733f68da-e44f-4172-9772-a287ac2724f2" width="593" />
</figure>

התנאי בצומת התנאי מוגדר כ"צומת ידני / נתוני טופס מותאם אישית / ערך שדה האישור הוא 'אושר'":

<figure>
  <img alt="צומת ידני_דוגמה_אישור חופשה_תנאי" src="https://github.com/nocobase/nocobase/assets/525658/57b972f0-a3ce-4f33-8d40-4272ad205c20" width="678" />
</figure>

הנתונים בצומת שליחת הבקשה יכולים גם להשתמש במשתני הטופס המתאימים מהצומת הידני כדי להבחין בין תוכן ה-SMS לאישור ולדחייה. זה משלים את הגדרת **תהליך העבודה** כולו. לאחר הפעלת **תהליך העבודה**, כאשר עובד שולח טופס בקשת חופשה, המנהל יכול לטפל באישור במשימות ה"לביצוע" שלו. הפעולה דומה באופן עקרוני לתהליך סקירת הפוסט.