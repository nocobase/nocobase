:::tip
מסמך זה תורגם על ידי בינה מלאכותית. לכל אי דיוק, אנא עיין ב[גרסה האנגלית](/en)
:::

# כללי קישוריות

## מבוא

ב-NocoBase, כללי קישוריות הם מנגנון המשמש לשליטה על התנהגות אינטראקטיבית של רכיבי ממשק קצה (frontend). הם מאפשרים למשתמשים להתאים את תצוגתם והתנהגותם הלוגית של בלוקים, שדות ופעולות בממשק, בהתבסס על תנאים שונים, ובכך להשיג חווית אינטראקציה גמישה ועם מעט קוד (low-code). תכונה זו נמצאת בפיתוח ושיפור מתמיד.

באמצעות הגדרת כללי קישוריות, תוכלו להשיג, לדוגמה:

- הסתרה/הצגה של בלוקים מסוימים בהתבסס על תפקיד המשתמש הנוכחי. תפקידים שונים יראו בלוקים עם טווחי נתונים שונים; לדוגמה, מנהלים יראו בלוקים עם מידע מלא, בעוד שמשתמשים רגילים יראו רק בלוקים עם מידע בסיסי.
- מילוי או איפוס אוטומטי של ערכי שדות אחרים כאשר נבחרת אפשרות מסוימת בטופס.
- השבתה של פריטי קלט מסוימים כאשר נבחרת אפשרות מסוימת בטופס.
- הגדרת פריטי קלט מסוימים כנדרשים (חובה) כאשר נבחרת אפשרות מסוימת בטופס.
- שליטה האם כפתורי פעולה יהיו גלויים או ניתנים ללחיצה בתנאים מסוימים.

## הגדרת תנאים

![20251029114532](https://static-docs.nocobase.com/20251029114532.png)

### משתנה צד שמאל

משתנה צד שמאל בתנאי משמש להגדרת "אובייקט הבדיקה" בכלל הקישוריות. התנאי מוערך בהתבסס על ערך המשתנה הזה כדי לקבוע אם להפעיל את פעולת הקישוריות.

המשתנים הניתנים לבחירה כוללים:

- שדות בהקשר (context), כגון `「Current Form/xxx」`, `「Current Record/xxx」`, `「Current Popup Record/xxx」` וכו'.
- משתנים גלובליים של המערכת, כגון `Current User`, `Current Role` וכו', המתאימים לשליטה דינמית המבוססת על זהות משתמש, הרשאות ומידע נוסף.
  > ✅ האפשרויות הזמינות למשתנה צד שמאל נקבעות על ידי ההקשר של הבלוק. השתמשו במשתנה צד שמאל באופן מושכל בהתאם לצרכים העסקיים:
  >
  > - `Current User` מייצג את פרטי המשתמש המחובר כעת.
  > - `Current Form` מייצג את ערכי הקלט בזמן אמת בטופס.
  > - `Current Record` מייצג את ערך הרשומה השמורה, כגון רשומת שורה בטבלה.

### אופרטור

האופרטור משמש להגדרת הלוגיקה לבדיקת התנאי, כלומר, כיצד להשוות את משתנה צד שמאל עם ערך צד ימין. סוגים שונים של משתני צד שמאל תומכים באופרטורים שונים. אופרטורים נפוצים לפי סוג הם כדלקמן:

- **סוג טקסט**: `$includes`, `$eq`, `$ne`, `$empty`, `$notEmpty` וכו'.
- **סוג מספר**: `$eq`, `$gt`, `$lt`, `$gte`, `$lte` וכו'.
- **סוג בוליאני**: `$isTruly`, `$isFalsy`.
- **סוג מערך**: `$match`, `$anyOf`, `$empty`, `$notEmpty` וכו'.

> ✅ המערכת תמליץ אוטומטית על רשימת אופרטורים זמינים בהתבסס על סוג משתנה צד שמאל, כדי להבטיח שהלוגיקה של ההגדרה תהיה הגיונית.

### ערך צד ימין

משמש להשוואה עם משתנה צד שמאל, והוא ערך ההתייחסות לקביעה האם התנאי מתקיים.

התוכן הנתמך כולל:

- ערכים קבועים (קונסטנטים): הזינו מספרים קבועים, טקסט, תאריכים וכו'.
- משתני הקשר (context): כגון שדות אחרים בטופס הנוכחי, הרשומה הנוכחית וכו'.
- משתני מערכת: כגון המשתמש הנוכחי, השעה הנוכחית, התפקיד הנוכחי וכו'.

> ✅ המערכת תתאים אוטומטית את שיטת הקלט עבור ערך צד ימין בהתבסס על סוג משתנה צד שמאל, לדוגמה:
>
> - כאשר צד שמאל הוא "שדה בחירה", יוצג בורר האפשרויות המתאים.
> - כאשר צד שמאל הוא "שדה תאריך", יוצג בורר תאריכים.
> - כאשר צד שמאל הוא "שדה טקסט", תוצג תיבת קלט טקסט.

> 💡 שימוש גמיש בערכי צד ימין (במיוחד במשתנים דינמיים) מאפשר לכם לבנות לוגיקת קישוריות המבוססת על המשתמש הנוכחי, מצב הנתונים הנוכחי וסביבת ההקשר, ובכך להשיג חווית אינטראקציה עוצמתית יותר.

## לוגיקת ביצוע כללים

### הפעלת תנאי

כאשר התנאי בכלל מתקיים (לא חובה), פעולת שינוי המאפיינים שמתחתיו תבוצע אוטומטית. אם לא הוגדר תנאי, הכלל ייחשב כמתקיים תמיד כברירת מחדל, ופעולת שינוי המאפיינים תבוצע אוטומטית.

### כללים מרובים

ניתן להגדיר מספר כללי קישוריות עבור טופס. כאשר התנאים של מספר כללים מתקיימים בו-זמנית, המערכת תבצע את התוצאות לפי סדר הכללים, מהראשון לאחרון, כלומר, התוצאה האחרונה תשמש כסטנדרט הביצוע הסופי.
דוגמה: כלל 1 מגדיר שדה כ"מושבת", וכלל 2 מגדיר את השדה כ"ניתן לעריכה". אם התנאים של שני הכללים מתקיימים, השדה יהפוך ל"ניתן לעריכה".

> סדר הביצוע של כללים מרובים הוא קריטי. בעת תכנון כללים, ודאו שאתם מבהירים את סדרי העדיפויות והיחסים ההדדיים ביניהם כדי למנוע התנגשויות בין כללים.

## ניהול כללים

ניתן לבצע את הפעולות הבאות על כל כלל:

- **שם מותאם אישית**: הגדירו שם קל להבנה עבור הכלל, לטובת ניהול וזיהוי.
- **מיון**: התאימו את הסדר בהתבסס על עדיפות ביצוע הכללים, כדי להבטיח שהמערכת תעבד אותם ברצף הנכון.
- **מחיקה**: הסירו כללים שאינם נחוצים עוד.
- **הפעלה/השבתה**: השביתו כלל באופן זמני מבלי למחוק אותו, מתאים למצבים בהם יש צורך להשבית כלל באופן זמני.
- **שכפול כלל**: צרו כלל חדש על ידי שכפול כלל קיים, כדי למנוע הגדרה חוזרת.

## אודות משתנים

בהקצאת ערכי שדות ובהגדרת תנאים, נתמכים גם קבועים (קונסטנטים) וגם משתנים. רשימת המשתנים תשתנה בהתאם למיקום הבלוק. בחירה ושימוש מושכלים במשתנים יכולים לענות על צרכים עסקיים בצורה גמישה יותר. למידע נוסף על משתנים, עיינו ב-[משתנים](/interface-builder/variables).

## כללי קישוריות לבלוקים

כללי קישוריות לבלוקים מאפשרים שליטה דינמית על תצוגת בלוק בהתבסס על משתני מערכת (כגון משתמש נוכחי, תפקיד) או משתני הקשר (כגון רשומת חלון קופץ נוכחית). לדוגמה, מנהל מערכת יכול לצפות במידע הזמנה מלא, בעוד שתפקיד שירות לקוחות יכול לצפות רק בנתוני הזמנה ספציפיים. באמצעות כללי קישוריות לבלוקים, תוכלו להגדיר בלוקים מתאימים בהתבסס על תפקידים, ולקבוע שדות שונים, כפתורי פעולה וטווחי נתונים בתוך אותם בלוקים. כאשר התפקיד המחובר הוא תפקיד היעד, המערכת תציג את הבלוק המתאים. חשוב לציין שבלוקים מוצגים כברירת מחדל, ולכן בדרך כלל יש צורך להגדיר את הלוגיקה להסתרת הבלוק.

👉 לפרטים נוספים, ראו: [בלוק/כללי קישוריות לבלוקים](/interface-builder/blocks/block-settings/block-linkage-rule)

## כללי קישוריות לשדות

כללי קישוריות לשדות משמשים להתאמה דינמית של מצב השדות בטופס או בבלוק פרטים, בהתבסס על פעולות משתמש, וכוללים בעיקר:

- שליטה על מצב **הצגה/הסתרה** של שדה
- הגדרת שדה כ**שדה חובה**
- **הקצאת ערך**
- ביצוע JavaScript לטיפול בלוגיקה עסקית מותאמת אישית

👉 לפרטים נוספים, ראו: [בלוק/כללי קישוריות לשדות](/interface-builder/blocks/block-settings/field-linkage-rule)

## כללי קישוריות לפעולות

כללי קישוריות לפעולות תומכים כיום בשליטה על התנהגויות פעולה, כגון הסתרה/השבתה, בהתבסס על משתני הקשר כמו ערך הרשומה הנוכחית והטופס הנוכחי, וכן על משתנים גלובליים.

👉 לפרטים נוספים, ראו: [פעולה/כללי קישוריות](/interface-builder/actions/action-settings/linkage-rule)