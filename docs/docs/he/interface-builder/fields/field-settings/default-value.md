:::tip
מסמך זה תורגם על ידי בינה מלאכותית. לכל אי דיוק, אנא עיין ב[גרסה האנגלית](/en)
:::

# ערך ברירת מחדל

## מבוא

ערך ברירת מחדל הוא הערך ההתחלתי של שדה בעת יצירת רשומה חדשה. ניתן להגדיר ערך ברירת מחדל לשדה בעת הגדרתו באוסף, או לציין ערך ברירת מחדל לשדה בבלוק טופס הוספה. ניתן להגדיר אותו כקבוע או כמשתנה.

## היכן ניתן להגדיר ערכי ברירת מחדל

### שדות אוסף

![20240411095933](https://static-docs.nocobase.com/20240411095933.png)

### שדות בטופס הוספה

רוב השדות בטופס הוספה תומכים בהגדרת ערך ברירת מחדל.

![20251028161801](https://static-docs.nocobase.com/20251028161801.png)

### הוספה בטופס משנה

נתוני משנה שנוספו באמצעות שדה טופס משנה, בין אם בטופס הוספה או עריכה, יקבלו ערך ברירת מחדל.

הוספה חדשה בטופס משנה
![20251028163455](https://static-docs.nocobase.com/20251028163455.png)

בעת עריכת נתונים קיימים, שדה ריק לא יאוכלס בערך ברירת המחדל. רק נתונים שנוספו לאחרונה ימולאו בערך ברירת המחדל.

### ערכי ברירת מחדל לשדות יחסים

רק ליחסי `**רבים-לאחד**` ו`**רבים-לרבים**` יש ערכי ברירת מחדל, וזאת כאשר משתמשים ברכיבי בחירה (Select, RecordPicker).

![20251028164128](https://static-docs.nocobase.com/20251028164128.png)

## משתני ערך ברירת מחדל

### אילו משתנים זמינים

- משתמש נוכחי;
- רשומה נוכחית; מושג זה חל רק על רשומות קיימות;
- טופס נוכחי, באופן אידיאלי מפרט רק את השדות בטופס;
- אובייקט נוכחי, מושג בתוך טופסי משנה (אובייקט הנתונים עבור כל שורה בטופס המשנה);
- פרמטרי URL
  למידע נוסף על משתנים, עיינו ב[משתנים](/interface-builder/variables)

### משתני ערך ברירת מחדל לשדות

מחולקים לשתי קטגוריות: שדות שאינם שדות יחסים ושדות יחסים.

#### משתני ערך ברירת מחדל לשדות יחסים

- אובייקט המשתנה חייב להיות רשומת אוסף;
- הוא חייב להיות אוסף בשרשרת הירושה, שיכול להיות האוסף הנוכחי או אוסף אב/בן;
- המשתנה "רשומות נבחרות בטבלה" זמין רק עבור שדות יחסים מסוג "רבים-לרבים" ו"אחד-לרבים/רבים-לאחד";
- **בתרחישים מרובי רמות, יש לשטח ולבטל כפילויות**

```typescript
// רשומות נבחרות בטבלה:
[{id:1},{id:2},{id:3},{id:4}]

// רשומות נבחרות בטבלה/לאחד:
[{toOne: {id:2}}, {toOne: {id:3}}, {toOne: {id:3}}]
// שטוח ומבוטל כפילויות
[{id: 2}, {id: 3}]

// רשומות נבחרות בטבלה/לרבים:
[{toMany: [{id: 1}, {id:2}]}, {toMany: {[id:3}, {id:4}]}]
// שטוח
[{id:1},{id:2},{id:3},{id:4}]
```

#### משתני ערך ברירת מחדל לשדות שאינם שדות יחסים

- הטיפוסים חייבים להיות עקביים או תואמים, לדוגמה, מחרוזות תואמות למספרים, וכל האובייקטים המספקים שיטת toString;
- שדה JSON הוא מיוחד ויכול לאחסן כל סוג של נתונים;

### רמת שדה (שדות אופציונליים)

![20240411101157](https://static-docs.nocobase.com/20240411101157.png)

- משתני ערך ברירת מחדל לשדות שאינם שדות יחסים
  - בעת בחירת שדות מרובי רמות, זה מוגבל ליחסי אחד-לאחד ואינו תומך ביחסי אחד-לרבים;
  - שדה JSON הוא מיוחד ויכול להיות ללא הגבלה;

- משתני ערך ברירת מחדל לשדות יחסים
  - `hasOne`, תומך רק ביחסי אחד-לאחד;
  - `hasMany`, תומך גם ביחסי אחד-לאחד (המרה פנימית) וגם ביחסי אחד-לרבים;
  - `belongsToMany`, תומך גם ביחסי אחד-לאחד (המרה פנימית) וגם ביחסי אחד-לרבים;
  - `belongsTo`, בדרך כלל עבור יחסי אחד-לאחד, אך כאשר יחס האב הוא `hasMany`, הוא תומך גם ביחסי אחד-לרבים (מכיוון ש-`hasMany`/`belongsTo` הם למעשה יחסי רבים-לרבים);

## הסבר על מקרים מיוחדים

### "רבים-לרבים" שקול לשילוב "אחד-לרבים/רבים-לאחד"

מודל

![20240411101558](https://static-docs.nocobase.com/20240411101558.png)

### מדוע ליחסי אחד-לאחד ואחד-לרבים אין ערכי ברירת מחדל?

לדוגמה, ביחס A.B, אם b1 משויך ל-a1, הוא לא יכול להיות משויך ל-a2. אם b1 ישויך ל-a2, השיוך שלו ל-a1 יוסר. במקרה זה, הנתונים אינם משותפים, בעוד שערך ברירת המחדל הוא מנגנון משותף (כולם יכולים להיות משויכים). לכן, יחסי אחד-לאחד ואחד-לרבים אינם יכולים לקבל ערכי ברירת מחדל.

### מדוע גם לטופסי משנה או טבלאות משנה מסוג רבים-לאחד ורבים-לרבים אין ערכי ברירת מחדל?

מכיוון שהדגש של טופסי משנה וטבלאות משנה הוא עריכה ישירה של נתוני היחסים (כולל הוספה והסרה), בעוד שערך ברירת המחדל של היחסים הוא מנגנון שיתוף שבו כולם יכולים להיות משויכים, אך לא ניתן לשנות את נתוני היחסים. לכן, תרחיש זה אינו מתאים לספק ערכי ברירת מחדל.

בנוסף, לטופסי משנה או טבלאות משנה יש שדות משנה, ולא יהיה ברור אם ערך ברירת המחדל עבור טופס משנה או טבלת משנה הוא ברירת מחדל לשורה או ברירת מחדל לעמודה.

בהתחשב בכל הגורמים, מתאים יותר שטופסי משנה או טבלאות משנה לא יוכלו לקבל ערכי ברירת מחדל ישירות, ללא קשר לסוג היחס.