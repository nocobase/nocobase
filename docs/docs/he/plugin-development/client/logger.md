:::tip
מסמך זה תורגם על ידי בינה מלאכותית. לכל אי דיוק, אנא עיין ב[גרסה האנגלית](/en)
:::

# יומן

NocoBase מספקת מערכת יומנים בעלת ביצועים גבוהים המבוססת על [pino](https://github.com/pinojs/pino). בכל מקום שבו יש לכם גישה ל-`context`, תוכלו לקבל מופע של יומן דרך `ctx.logger` כדי לתעד יומנים חשובים במהלך ריצת התוסף או המערכת.

## שימוש בסיסי

```ts
// תיעוד שגיאות קריטיות (לדוגמה: כשל באתחול)
ctx.logger.fatal('Application initialization failed', { error });

// תיעוד שגיאות כלליות (לדוגמה: שגיאות בבקשות API)
ctx.logger.error('Data loading failed', { status, message });

// תיעוד אזהרות (לדוגמה: סיכוני ביצועים או פעולות משתמש חריגות)
ctx.logger.warn('Current form contains unsaved changes');

// תיעוד מידע כללי על ריצה (לדוגמה: רכיב נטען בהצלחה)
ctx.logger.info('User profile component loaded');

// תיעוד מידע לניפוי באגים (לדוגמה: שינויי מצב)
ctx.logger.debug('Current user state', { user });

// תיעוד מידע מעקב מפורט (לדוגמה: תהליך רינדור)
ctx.logger.trace('Component rendered', { component: 'UserProfile' });
```

מתודות אלו מתאימות לרמות יומן שונות (מהגבוה לנמוך):

| רמה     | מתודה              | תיאור                                         |
| ------- | ------------------- | --------------------------------------------- |
| `fatal` | `ctx.logger.fatal()` | שגיאות קריטיות, שבדרך כלל גורמות ליציאה מהתוכנית |
| `error` | `ctx.logger.error()` | יומני שגיאה, המצביעים על כשל בבקשה או בפעולה |
| `warn`  | `ctx.logger.warn()`  | מידע אזהרה, המצביע על סיכונים פוטנציאליים או מצבים בלתי צפויים |
| `info`  | `ctx.logger.info()`  | מידע כללי על ריצה                              |
| `debug` | `ctx.logger.debug()` | מידע לניפוי באגים, לסביבת פיתוח              |
| `trace` | `ctx.logger.trace()` | מידע מעקב מפורט, המשמש בדרך כלל לאבחון מעמיק |

## פורמט היומן

כל פלט יומן הוא בפורמט JSON מובנה, המכיל כברירת מחדל את השדות הבאים:

| שדה      | סוג    | תיאור                       |
| -------- | ------ | --------------------------- |
| `level`  | number | רמת יומן                    |
| `time`   | number | חותמת זמן (מילישניות)      |
| `pid`    | number | מזהה תהליך (PID)           |
| `hostname` | string | שם מארח (Hostname)          |
| `msg`    | string | הודעת יומן                   |
| אחרים    | object | מידע הקשר מותאם אישית      |

פלט לדוגמה:

```json
{
  "level": 30,
  "time": 1730540153064,
  "pid": 12765,
  "hostname": "nocobase.local",
  "msg": "HelloModel rendered",
  "a": "a"
}
```

## קישור הקשר

`ctx.logger` מזריק באופן אוטומטי מידע הקשר, כגון ה[תוסף](#) הנוכחי, המודול או מקור הבקשה, מה שמאפשר לעקוב אחר מקור היומנים בצורה מדויקת יותר.

```ts
plugin.context.logger.info('Plugin initialized');
model.context.logger.error('Model validation failed', { model: 'User' });
```

פלט לדוגמה (עם הקשר):

```json
{
  "level": 30,
  "msg": "Plugin initialized",
  "plugin": "plugin-audit-trail"
}
```

## יומן מותאם אישית

באפשרותכם ליצור מופעי יומן מותאמים אישית ב[תוספים](#) שלכם, תוך ירושה או הרחבה של הגדרות ברירת המחדל:

```ts
const logger = ctx.logger.child({ module: 'MyPlugin' });
logger.info('Submodule started');
```

יומני צאצא יורשים את התצורה של יומן האב ומצרפים אוטומטית את ההקשר.

## היררכיית רמות היומן

רמות היומן של Pino עוקבות אחר הגדרה מספרית מהגבוה לנמוך, כאשר מספרים קטנים יותר מצביעים על עדיפות נמוכה יותר.
להלן טבלת היררכיית רמות היומן המלאה:

| שם הרמה    | ערך     | שם המתודה        | תיאור                                                |
| ----------- | -------- | ----------------- | ---------------------------------------------------- |
| `fatal`     | 60       | `logger.fatal()`  | שגיאות קריטיות, שבדרך כלל גורמות לכך שהתוכנית אינה יכולה להמשיך לפעול |
| `error`     | 50       | `logger.error()`  | שגיאות כלליות, המצביעות על כשל בבקשה או חריגה בפעולה |
| `warn`      | 40       | `logger.warn()`   | מידע אזהרה, המצביע על סיכונים פוטנציאליים או מצבים בלתי צפויים |
| `info`      | 30       | `logger.info()`   | מידע רגיל, המתעד את מצב המערכת או פעולות תקינות     |
| `debug`     | 20       | `logger.debug()`  | מידע לניפוי באגים, לניתוח בעיות בשלב הפיתוח         |
| `trace`     | 10       | `logger.trace()`  | מידע מעקב מפורט, המשמש לאבחון מעמיק                 |
| `silent`    | -Infinity | (אין מתודה מקבילה) | כיבוי כל פלט היומנים                                |

Pino יציג רק יומנים שרמתם גדולה או שווה להגדרת ה-`level` הנוכחית. לדוגמה, כאשר רמת היומן היא `info`, יומני `debug` ו-`trace` יתעלמו.

## שיטות עבודה מומלצות בפיתוח [תוספים](#)

1.  **השתמשו ביומן ההקשר**
    השתמשו ב-`ctx.logger` בהקשרי [תוסף](#), מודל או יישום, כדי לשאת באופן אוטומטי מידע על המקור.

2.  **הבחינו בין רמות יומן**
    -   השתמשו ב-`error` לתיעוד חריגות עסקיות
    -   השתמשו ב-`info` לתיעוד שינויי מצב
    -   השתמשו ב-`debug` לתיעוד מידע לניפוי באגים בפיתוח

3.  **הימנעו מריבוי יומנים**
    במיוחד ברמות `debug` ו-`trace`, מומלץ להפעיל אותן רק בסביבות פיתוח.

4.  **השתמשו בנתונים מובנים**
    העבירו פרמטרים של אובייקטים במקום לשרשר מחרוזות; זה מסייע בניתוח ובסינון יומנים.

באמצעות שיטות אלו, מפתחים יכולים לעקוב ביעילות רבה יותר אחר תהליכי ביצוע של [תוספים](#), לפתור בעיות, ולשמור על מערכת יומנים מובנית וניתנת להרחבה.