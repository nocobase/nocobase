:::tip
מסמך זה תורגם על ידי בינה מלאכותית. לכל אי דיוק, אנא עיין ב[גרסה האנגלית](/en)
:::

# סנכרון נתוני משתמשים באמצעות HTTP API

## קבלת מפתח API

עיינו ב-[מפתחות API](/auth-verification/api-keys). ודאו שלתפקיד המשויך למפתח ה-API יש את ההרשאות הנדרשות לסנכרון נתוני משתמשים.

## סקירת API

### דוגמה

```bash
curl 'https://localhost:13000/api/userData:push' \
  -H 'Authorization: Bearer <token>' \
  --data-raw '{"dataType":"user","records":[]}' # לפרטים נוספים על גוף הבקשה ראו בהמשך
```

### נקודת קצה (Endpoint)

```bash
POST /api/userData:push
```

### פורמט נתוני משתמשים

#### UserData

| פרמטר | סוג | תיאור |
|---|---|---|
| `dataType` | `'user' \| 'department'` | חובה. סוג הנתונים הנשלחים. השתמשו ב-`user` לשליחת נתוני משתמשים. |
| `matchKey` | `'username' \| 'email' \| 'phone'` | אופציונלי. משמש להתאמת משתמשי מערכת קיימים בהתבסס על השדה שצוין. |
| `records` | `UserRecord[]` | חובה. מערך של רשומות נתוני משתמשים. |

#### UserRecord

| פרמטר | סוג | תיאור |
|---|---|---|
| `uid` | `string` | חובה. מזהה ייחודי לנתוני המשתמש המקוריים, המשמש לקישור נתוני המקור למשתמש המערכת. בלתי ניתן לשינוי עבור משתמש. |
| `nickname` | `string` | אופציונלי. כינוי המשתמש. |
| `username` | `string` | אופציונלי. שם המשתמש. |
| `email` | `string` | אופציונלי. כתובת האימייל של המשתמש. |
| `phone` | `string` | אופציונלי. מספר הטלפון של המשתמש. |
| `departments` | `string[]` | אופציונלי. מערך של מזהי UID של מחלקות שהמשתמש משויך אליהן. |
| `isDeleted` | `boolean` | אופציונלי. מציין אם הרשומה נמחקה. |
| `<field>` | `any` | אופציונלי. שדות מותאמים אישית בטבלת המשתמשים. |

### פורמט נתוני מחלקות

:::info
שליחת נתוני מחלקות דורשת שהתוסף [מחלקות](../../departments) יהיה מותקן ומופעל.
:::

#### DepartmentData

| פרמטר | סוג | תיאור |
|---|---|---|
| `dataType` | `'user' \| 'department'` | חובה. סוג הנתונים הנשלחים. השתמשו ב-`department` עבור נתוני מחלקות. |
| `records` | `DepartmentRecord[]` | חובה. מערך של רשומות נתוני מחלקות. |

#### DepartmentRecord

| פרמטר | סוג | תיאור |
|---|---|---|
| `uid` | `string` | חובה. מזהה ייחודי לנתוני המחלקה המקוריים, המשמש לקישור נתוני המקור למחלקת המערכת. בלתי ניתן לשינוי. |
| `title` | `string` | חובה. כותרת המחלקה. |
| `parentUid` | `string` | אופציונלי. UID של מחלקת האב. |
| `isDeleted` | `boolean` | אופציונלי. מציין אם הרשומה נמחקה. |
| `<field>` | `any` | אופציונלי. שדות מותאמים אישית בטבלת המחלקות. |

:::info

1.  שליחת נתונים היא פעולה אידמפוטנטית.
2.  אם מחלקת אב אינה קיימת בעת שליחת נתוני מחלקות, לא ניתן ליצור את הקישור. תוכלו לשלוח את הנתונים שוב לאחר שמחלקת האב נוצרה.
3.  אם מחלקתו של משתמש אינה קיימת בעת שליחת נתוני משתמשים, לא ניתן לשייך את המשתמש לאותה מחלקה. תוכלו לשלוח את נתוני המשתמשים שוב לאחר שנתוני המחלקות נשלחו.

:::