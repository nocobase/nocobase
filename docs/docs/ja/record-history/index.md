---
pkg: '@nocobase/plugin-record-history'
---
:::tip
このドキュメントはAIによって翻訳されました。不正確な情報については、[英語版](/en)をご参照ください
:::


# 履歴記録

## 概要

履歴記録**プラグイン**は、データの変更履歴を追跡し、新規作成、更新、削除といった操作のスナップショットと差分を自動的に保存します。これにより、ユーザーはデータの変更を素早く確認し、操作履歴を監査することができます。

![](https://static-docs.nocobase.com/202511011338499.png)

## 履歴記録を有効にする

### **コレクション**とフィールドを追加する

まず、履歴記録**プラグイン**の設定ページにアクセスし、操作履歴を記録したい**コレクション**とフィールドを追加します。
記録効率を向上させ、データの冗長性を避けるため、必要な**コレクション**とフィールドのみを設定することをお勧めします。例えば、一意のID、作成日時、更新日時、作成者、更新者といったフィールドは、通常記録する必要はありません。

![](https://static-docs.nocobase.com/202511011315010.png)

![](https://static-docs.nocobase.com/202511011316342.png)

### 履歴データスナップショットの同期

- 履歴記録を有効にする前に作成されたデータは、最初の更新時にスナップショットが生成されて初めて、その後の変更が記録されるようになります。そのため、最初の更新や削除は履歴として残りません。
- 既存データの履歴を保持したい場合は、一度スナップショットの同期を実行できます。
- 1**コレクション**あたりのスナップショットデータ量は、「記録数 × 記録対象フィールド数」で計算されます。
- データ量が膨大な場合は、データ範囲で絞り込み、重要なデータのみを同期することをお勧めします。

![](https://static-docs.nocobase.com/202511011319386.png)

![](https://static-docs.nocobase.com/202511011319284.png)

「履歴記録スナップショットを同期」ボタンをクリックし、同期したいフィールドとデータ範囲を設定すると、同期が開始されます。

![](https://static-docs.nocobase.com/202511011320958.png)

同期タスクはバックグラウンドでキューに入れられ実行されます。リストを更新して、タスクが完了したかどうかを確認できます。

## 履歴記録ブロックの使用

### ブロックの追加

履歴記録ブロックを選択し、**コレクション**を選ぶことで、対応する**コレクション**の履歴記録ブロックを追加できます。

![](https://static-docs.nocobase.com/202511011323410.png)

![](https://static-docs.nocobase.com/202511011331667.png)

あるデータ記録のポップアップ内で履歴記録ブロックを追加する場合は、「現在の記録」を選択することで、そのデータ記録に特化した履歴記録ブロックを追加できます。

![](https://static-docs.nocobase.com/202511011338042.png)

![](https://static-docs.nocobase.com/202511011338499.png)

### 説明文テンプレートの編集

ブロック設定にある「テンプレートを編集」をクリックすると、操作記録の説明文を構成できます。

![](https://static-docs.nocobase.com/202511011340406.png)

現在、作成、更新、削除の各記録に対する説明文を個別に設定できます。特に更新記録については、フィールド変更の説明文も設定可能で、一括設定と特定のフィールドごとの個別設定の両方に対応しています。

![](https://static-docs.nocobase.com/202511011346400.png)

説明文を設定する際には、変数を使用できます。

![](https://static-docs.nocobase.com/202511011347163.png)

設定完了後、「現在の**コレクション**のすべての履歴記録ブロック」に適用するか、「現在の履歴記録ブロックのみ」に適用するかを選択できます。

![](https://static-docs.nocobase.com/202511011348885.png)