:::tip
このドキュメントはAIによって翻訳されました。不正確な情報については、[英語版](/en)をご参照ください
:::

# ブロック連携ルール

## はじめに

ブロック連携ルールは、ユーザーがブロックの表示を動的に制御し、ブロックレベルで要素の表示全体を管理できるようにする機能です。ブロックはフィールドや操作ボタンのコンテナとして機能するため、これらのルールを活用することで、ユーザーはブロック単位でビュー全体の表示を柔軟に制御できます。

![20251029112218](https://static-docs.nocobase.com/20251029112218.png)

![20251029112338](https://static-docs.nocobase.com/20251029112338.png)

> **注意**: ブロック連携ルールが実行される前に、ブロックの表示はまず **ACL 権限チェック**を受ける必要があります。ユーザーが適切なアクセス権限を持っている場合にのみ、ブロック連携ルールの評価ロジックに進みます。つまり、ブロック連携ルールはACLの表示権限要件が満たされた後にのみ有効になります。ブロック連携ルールが設定されていない場合、ブロックはデフォルトで表示されます。

### グローバル変数によるブロックの制御

**ブロック連携ルール**は、グローバル変数を使ってブロックの表示内容を動的に制御できます。これにより、異なる役割や権限を持つユーザーが、それぞれにカスタマイズされたデータビューを閲覧・操作できるようになります。例えば、注文管理システムにおいて、管理者、営業担当者、経理担当者といった異なる役割のユーザーが、全員注文を表示する権限を持っていたとします。しかし、各役割が必要とするフィールドや操作ボタンは異なるかもしれません。グローバル変数を設定することで、ユーザーの役割、権限、その他の条件に基づいて、表示するフィールド、操作ボタン、さらにはデータの並べ替えやフィルタリングルールを柔軟に調整することが可能です。

#### 具体的な利用シーン：

-   **役割と権限の制御**：異なる役割の権限に基づいて、特定のフィールドの表示/非表示や編集可否を制御します。例えば、営業担当者は注文の基本情報のみを閲覧でき、経理担当者は注文の支払い詳細を閲覧できる、といった設定が可能です。
-   **パーソナライズされたビュー**：異なる部署やチーム向けに異なるブロックビューをカスタマイズし、各ユーザーが自身の業務に関連するコンテンツのみを閲覧できるようにすることで、作業効率を向上させます。
-   **操作権限の管理**：グローバル変数を使って操作ボタンの表示を制御します。例えば、ある役割のユーザーはデータの閲覧のみが可能で、別の役割のユーザーは変更や削除などの操作を実行できる、といった設定ができます。

### コンテキスト変数によるブロックの制御

ブロックは、コンテキスト内の変数を使って表示を制御することもできます。例えば、「現在のレコード」、「現在のフォーム」、「現在のポップアップレコード」といったコンテキスト変数を使用して、ブロックを動的に表示したり非表示にしたりすることが可能です。

例：注文のステータスが「支払い済み」の場合にのみ、「注文商機情報」ブロックを表示します。

![20251029114022](https://static-docs.nocobase.com/20251029114022.png)

連携ルールに関する詳細については、[連携ルール](/interface-builder/linkage-rule)をご参照ください。