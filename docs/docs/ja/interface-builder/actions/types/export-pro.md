---
pkg: "@nocobase/plugin-action-export-pro"
---
:::tip
このドキュメントはAIによって翻訳されました。不正確な情報については、[英語版](/en)をご参照ください
:::



# エクスポート Pro

## はじめに

エクスポート Pro プラグインは、標準のエクスポート機能に加えて、強化された機能を提供します。

## インストール

このプラグインは「非同期タスク管理プラグイン」に依存しています。使用する前に、非同期タスク管理プラグインを有効にする必要があります。

## 機能強化

- 大量のデータエクスポートに対応するため、独立したスレッドで実行される非同期エクスポート操作をサポートしています。
- 添付ファイルのエクスポートをサポートしています。

## 利用ガイド

### エクスポートモードの設定

![20251029172829](https://static-docs.nocobase.com/20251029172829.png)

![20251029172914](https://static-docs.nocobase.com/20251029172914.png)

エクスポートボタンで、以下の3つのエクスポートモードを設定できます。

- **自動**: エクスポート時のデータ量に基づいてモードが決定されます。データ量が1000件未満（添付ファイルエクスポート時は100件未満）の場合は同期エクスポートが使用され、1000件以上（添付ファイルエクスポート時は100件以上）の場合は非同期エクスポートが使用されます。
- **同期**: 同期エクスポートを使用します。エクスポートはメインスレッドで実行されるため、小規模なデータに適しています。同期モードで大量のデータエクスポートを実行すると、システムがブロックされたり、フリーズしたり、他のユーザーからのリクエストを処理できなくなる可能性があります。
- **非同期**: 非同期エクスポートを使用します。エクスポートは独立したバックグラウンドスレッドで実行されるため、現在のシステムの操作をブロックすることはありません。

### 非同期エクスポート

エクスポートを実行すると、その処理は独立したバックグラウンドスレッドで実行されるため、ユーザーによる手動設定は不要です。ユーザーインターフェースでは、エクスポート操作の実行後、右上に現在実行中のエクスポートタスクが表示され、リアルタイムでタスクの進捗状況が示されます。

![20251029173028](https://static-docs.nocobase.com/20251029173028.png)

エクスポートが完了した後、エクスポートタスクからエクスポートファイルをダウンロードできます。

#### 並行エクスポート

並行エクスポートタスクが多数ある場合、サーバー設定の影響を受け、システムの応答が遅くなる可能性があります。そのため、システム開発者には最大並行エクスポートタスク数（デフォルトは3）を設定することをお勧めします。設定された並行数を超えた場合、新しいタスクはキューに入ります。

![20250505171706](https://static-docs.nocobase.com/20250505171706.png)

並行数の設定方法：環境変数 `ASYNC_TASK_MAX_CONCURRENCY=並行数`

異なる設定とデータ複雑度での総合テストに基づき、推奨される並行数は以下の通りです。
- 2コアCPUの場合、並行数3。
- 4コアCPUの場合、並行数5。

#### パフォーマンスについて

エクスポート処理が異常に遅いと感じる場合（以下の表を参照）、それはコレクションの構造に起因するパフォーマンスの問題である可能性があります。

| データ特性 | インデックスタイプ | データ量 | エクスポート時間 |
|---------|---------|--------|---------|
| 関連フィールドなし | 主キー / ユニーク制約 | 100万件 | 3～6分 |  
| 関連フィールドなし | 通常インデックス | 100万件 | 6～10分 | 
| 関連フィールドなし | 複合インデックス（非ユニーク） | 100万件 | 30分 | 
| 関連フィールド<br>（1対1、1対多、<br>多対1、多対多） | 主キー / ユニーク制約 | 50万件 | 15～30分 | 関連フィールドがパフォーマンスを低下させる |

効率的なエクスポートを確実にするため、以下のことをお勧めします。
1. コレクションは以下の条件を満たす必要があります。

| 条件タイプ | 必須条件 | その他の注意点 |
|---------|------------------------|------|
| コレクション構造（いずれか1つを満たす） | 主キーがある<br>ユニーク制約がある<br>インデックスがある（ユニーク、通常、複合） | 優先順位：主キー > ユニーク制約 > インデックス |
| フィールド特性 | 主キー / ユニーク制約 / インデックス（いずれか1つ）は、ソート可能な特性を持つ必要があります。例：自動増分ID、Snowflake ID、UUID v1、タイムスタンプ、数値など<br>（注意：UUID v3/v4/v5、通常の文字列など、ソートできないフィールドはパフォーマンスに影響を与えます） | なし |

2. エクスポートする不要なフィールド、特に関連フィールドの数を減らしてください（関連フィールドに起因するパフォーマンスの問題は現在も最適化中です）。
![20250506215940](https://static-docs.nocobase.com/20250506215940.png)
3. 上記の条件を満たしてもエクスポートが遅い場合は、ログ分析を行うか、公式チームにフィードバックしてください。
![20250505182122](https://static-docs.nocobase.com/20250505182122.png)

- [連携ルール](/interface-builder/actions/action-settings/linkage-rule)：ボタンの動的な表示/非表示；
- [ボタンの編集](/interface-builder/actions/action-settings/edit-button)：ボタンのタイトル、タイプ、アイコンの編集；