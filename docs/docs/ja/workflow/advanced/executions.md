:::tip
このドキュメントはAIによって翻訳されました。不正確な情報については、[英語版](/en)をご参照ください
:::

# 実行プラン（履歴）

ワークフローがトリガーされると、そのタスクの実行プロセスを追跡するために、対応する実行プランが作成されます。各実行プランには現在の実行状態を示すステータス値があり、これは実行履歴のリストや詳細画面で確認できます。

![実行プランのステータス](https://static-docs.nocobase.com/d4440d92ccafac6fac85da4415bb2a26.png)

メインのワークフローブランチ内のすべてのノードが「完了」ステータスでプロセスの終点まで実行されると、実行プラン全体も「完了」ステータスで終了します。メインのワークフローブランチ内のノードが「失敗」「エラー」「キャンセル」「拒否」などの最終ステータスになった場合、実行プラン全体は対応するステータスで**途中で終了します**。メインのワークフローブランチ内のノードが「待機中」ステータスになった場合、実行プラン全体は一時停止しますが、「実行中」のステータスが表示され続け、待機中のノードが再開されるまで続行されません。ノードのタイプによって待機状態の処理方法は異なります。例えば、手動ノードは手動処理を待つ必要があり、遅延ノードは指定された時間が経過するまで待機してから続行します。

実行プランのステータスは以下の通りです。

| ステータス | メインのワークフローで最後に実行されたノードのステータス | 意味 |
| ------ | ---------------------------- | ------------------------------------------------ |
| キュー中 | - | ワークフローがトリガーされ、実行プランが生成されました。スケジューラによる実行の割り当てを待機しています。 |
| 実行中 | 待機中 | ノードが一時停止を要求し、さらなる入力またはコールバックを待ってから続行します。 |
| 完了 | 完了 | 問題なく、すべてのノードが期待通りに順次実行されました。 |
| 失敗 | 失敗 | ノードの設定が満たされなかったため、失敗しました。 |
| エラー | エラー | ノードが捕捉されないプログラムエラーに遭遇し、途中で終了しました。 |
| キャンセル | キャンセル | 待機中のノードがワークフロー管理者によって外部から実行をキャンセルされ、途中で終了しました。 |
| 拒否 | 拒否 | 手動処理ノードで、手動で拒否されたため、後続のプロセスは続行されません。 |

[クイックスタート](../getting-started.md)の例で、ワークフローの実行履歴の詳細を確認することで、実行中のすべてのノードが正常に実行されたか、および各実行済みノードの実行ステータスと結果データをチェックできることを学びました。高度なワークフローやノードでは、ループノードの結果のように、ノードが複数の結果を持つ場合があります。

![複数回実行されたノードの結果](https://static-docs.nocobase.com/bbda259fa2ddf62b0fc0f928efbedae9.png)

:::info{title=ヒント}
ワークフローは同時にトリガーできますが、実行はキューで順次行われます。複数のワークフローが同時にトリガーされた場合でも、並行ではなく、1つずつ順番に実行されます。したがって、「キュー中」のステータスが表示されている場合は、他のワークフローが実行中であり、待機する必要があることを意味します。

「実行中」のステータスは、その実行プランが開始されており、通常、内部ノードの待機状態によって一時停止していることを示しますが、キューの先頭にある実行リソースを占有しているわけではありません。したがって、「実行中」の実行プランが存在する場合でも、他の「キュー中」の実行プランは引き続きスケジュールされて実行を開始できます。
:::

## ノードの実行ステータス

実行プランのステータスは、その中の各ノードの実行によって決定されます。トリガーされた実行プランでは、各ノードの実行後に実行ステータスが生成され、このステータスによって後続のプロセスが続行されるかどうかが決まります。通常、ノードが正常に実行されると、次のノードが実行され、すべてのノードが順次実行されるか、または中断されるまで続きます。分岐、ループ、並行、遅延などのフロー制御関連ノードに遭遇した場合、ノードに設定された条件と実行時のコンテキストデータに基づいて、次のノードの実行フローが決定されます。

各ノードの実行後に発生する可能性のあるステータスは以下の通りです。

| ステータス | 最終ステータスか | 途中で終了するか | 意味 |
| ---- | :--------: | :----------: | ------------------------------------------------------ |
| 待機中 | いいえ | いいえ | ノードが一時停止を要求し、さらなる入力またはコールバックを待ってから続行します。 |
| 完了 | はい | いいえ | 問題なく、正常に実行されました。次のノードが実行され、最後まで続行されます。 |
| 失敗 | はい | はい | ノードの設定が満たされなかったため、失敗しました。 |
| エラー | はい | はい | ノードが捕捉されないプログラムエラーに遭遇し、途中で終了しました。 |
| キャンセル | はい | はい | 待機中のノードがワークフロー管理者によって外部から実行をキャンセルされ、途中で終了しました。 |
| 拒否 | はい | はい | 手動処理ノードで、手動で拒否されたため、後続のプロセスは続行されません。 |

「待機中」ステータスを除き、他のすべてのステータスはノード実行の最終ステータスです。最終ステータスが「完了」の場合のみプロセスは続行され、それ以外の場合はワークフロー全体の実行が途中で終了します。ノードが分岐フロー（並行分岐、条件判断、ループなど）にある場合、ノードの実行によって生成された最終ステータスは、その分岐を開始したノードによって処理され、それがワークフロー全体の流れを決定します。

例えば、「「はい」の場合に続行」モードの条件ノードを使用している場合、実行時に結果が「いいえ」であれば、ワークフロー全体が「失敗」ステータスで途中で終了し、後続のノードは実行されません。以下の図をご覧ください。

![ノードの実行失敗](https://static-docs.nocobase.com/993aecfa1465894bb574444f0a44313e.png)

:::info{title=ヒント}
「完了」以外のすべての終了ステータスは失敗と見なすことができますが、失敗の原因はそれぞれ異なります。ノードの実行結果を確認することで、失敗の原因をさらに詳しく理解できます。
:::