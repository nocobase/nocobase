:::tip
このドキュメントはAIによって翻訳されました。不正確な情報については、[英語版](/en)をご参照ください
:::

# データのクエリ

特定のコレクションから、条件に合致するデータレコードをクエリして取得する際に使用します。

単一のデータ、または複数のデータをクエリするように設定できます。クエリ結果は、後続のノードで変数として利用可能です。複数のデータをクエリする場合、結果は配列になります。クエリ結果が空の場合でも、後続のノードの実行を継続するかどうかを選択できます。

## ノードの作成

ワークフロー設定画面で、フロー内のプラス（「+」）ボタンをクリックして、「データのクエリ」ノードを追加します。

![「データのクエリ」ノードを追加](https://static-docs.nocobase.com/c1ef2b851b437806faf7a39c6ab9d33a.png)

## ノード設定

![クエリノード設定](https://static-docs.nocobase.com/20240520131324.png)

### コレクション

データをクエリするコレクションを選択します。

### 結果タイプ

結果タイプは「単一データ」と「複数データ」の2種類に分けられます。

-   単一データ：結果はオブジェクトであり、最初に一致したレコードのみ、または`null`になります。
-   複数データ：結果は配列となり、条件に一致するレコードが含まれます。一致するレコードがない場合は空の配列です。ループノードを使用して、1つずつ処理できます。

### フィルター条件

通常のコレクションクエリにおけるフィルター条件と同様に、ワークフローのコンテキスト変数を活用できます。

### ソート

単一または複数のデータをクエリする際、ソートルールを使用して目的の結果を制御できます。例えば、最新のレコードをクエリする場合、「作成時間」フィールドを降順でソートすることで実現できます。

### ページネーション

結果セットが非常に大きくなる可能性がある場合、ページネーションを使用してクエリ結果の数を制御できます。例えば、最新の10件のデータをクエリする場合、「作成時間」フィールドを降順でソートし、その後、ページネーションを1ページあたり10件のデータに設定します。

### 結果が空の場合の処理

単一データモードでは、条件に合致するデータがない場合、クエリ結果は`null`になります。複数データモードでは空の配列（`[]`）になります。必要に応じて「クエリ結果が空の場合、ワークフローを終了する」をチェックできます。これをチェックすると、クエリ結果が空の場合、後続のノードは実行されず、ワークフローは失敗ステータスで早期に終了します。