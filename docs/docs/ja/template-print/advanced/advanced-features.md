:::tip
このドキュメントはAIによって翻訳されました。不正確な情報については、[英語版](/en)をご参照ください
:::

## 高度な機能

### ページネーション

#### 1. ページ番号の更新

##### 構文
Officeソフトウェアで挿入するだけです。

##### 例
Microsoft Wordの場合：
- 「挿入 → ページ番号」機能を使用します。
LibreOfficeの場合：
- 「挿入 → フィールド → ページ番号」機能を使用します。

##### 結果
生成されたレポートでは、各ページのページ番号が自動的に更新されます。

#### 2. 目次生成

##### 構文
Officeソフトウェアで挿入するだけです。

##### 例
Microsoft Wordの場合：
- 「挿入 → 索引と目次 → 目次」機能を使用します。
LibreOfficeの場合：
- 「挿入 → 目次と索引 → 目次、索引、または参考文献」機能を使用します。

##### 結果
生成されたレポートの目次は、ドキュメントの内容に基づいて自動的に更新されます。

#### 3. テーブルヘッダーの繰り返し

##### 構文
Officeソフトウェアで挿入するだけです。

##### 例
Microsoft Wordの場合：
- テーブルヘッダーを右クリック → 「テーブルのプロパティ」→「各ページの上部にタイトル行として繰り返す」にチェックを入れます。
LibreOfficeの場合：
- テーブルヘッダーを右クリック → 「テーブルのプロパティ」→「テキストフロー」タブ → 「見出しを繰り返す」にチェックを入れます。

##### 結果
テーブルが複数ページにわたる場合、ヘッダーは各ページの上部に自動的に繰り返し表示されます。

### 国際化（i18n）

#### 1. 静的テキストの翻訳

##### 構文
静的テキストを国際化するには、`{t(テキスト)}` タグを使用します。
```
{t(meeting)}
```

##### 例
テンプレート内：
```
{t(meeting)} {t(apples)}
```
JSONデータまたは外部のローカライズ辞書（例：「fr-fr」用）で、対応する翻訳（例：「meeting」→「rendez-vous」、「apples」→「Pommes」）を提供します。

##### 結果
レポート生成時、テキストはターゲット言語に基づいて対応する翻訳に置き換えられます。

#### 2. 動的テキストの翻訳

##### 構文
データコンテンツには、`:t` フォーマッターを使用できます。例：
```
{d.id:ifEQ(2):show({t(monday)}):elseShow({t(tuesday)})}
```

##### 例
テンプレート内：
```
{d.id:ifEQ(2):show({t(monday)}):elseShow({t(tuesday)})}
```
JSONデータとローカライズ辞書で、対応する翻訳を提供します。

##### 結果
条件に基づいて、「lundi」または「mardi」（ターゲット言語の例）が出力されます。

### キーと値のマッピング

#### 1. Enum変換（:convEnum）

##### 構文
```
{データ:convEnum(Enum名)}
```
例：
```
0:convEnum('ORDER_STATUS')
```

##### 例
APIオプションの例で渡されるデータ：
```json
{
  "enum": {
    "ORDER_STATUS": ["pending", "sent", "delivered"]
  }
}
```
テンプレート内：
```
0:convEnum('ORDER_STATUS')
```

##### 結果
「pending」が出力されます。インデックスがEnumの範囲を超えている場合は、元の値が出力されます。

### 動的画像
:::info
現在、XLSX、DOCXファイルタイプに対応しています。
:::
ドキュメントテンプレートに「動的画像」を挿入できます。これは、テンプレート内のプレースホルダー画像が、レンダリング時にデータに基づいて実際の画像に自動的に置き換えられることを意味します。このプロセスは非常にシンプルで、以下の手順で行います。

1. プレースホルダーとして一時的な画像を挿入します。

2. その画像の「代替テキスト（Alt Text）」を編集して、フィールドラベルを設定します。

3. ドキュメントをレンダリングすると、システムが自動的に実際の画像に置き換えます。

以下では、DOCXとXLSXそれぞれの操作方法を具体的な例を挙げて説明します。

#### DOCXファイルに動的画像を挿入する
##### 単一画像の置き換え

1. DOCXテンプレートを開き、一時的な画像を挿入します（[純粋な青色の画像](https://static-docs.nocobase.com/solid-color-image-2025-04-14-11-00-26.png)のような、任意のプレースホルダー画像で構いません）。

:::info
**画像形式に関する注意点**

- 現在、プレースホルダー画像はPNG形式のみをサポートしています。提供されているサンプル画像[純粋な青色の画像](https://static-docs.nocobase.com/solid-color-image-2025-04-14-11-00-26.png)の使用をお勧めします。
- ターゲットとなるレンダリング画像はPNG、JPG、JPEG形式のみをサポートしています。その他の画像タイプではレンダリングに失敗する可能性があります。

**画像サイズに関する注意点**

DOCXでもXLSXでも、最終的にレンダリングされる画像のサイズは、テンプレート内の一時的な画像のサイズが適用されます。つまり、実際に置き換えられる画像は、挿入したプレースホルダー画像と同じサイズに自動的に拡大縮小されます。レンダリング後の画像サイズを150×150にしたい場合は、テンプレート内で一時的な画像を使用し、そのサイズに調整してください。
:::

2. この画像を右クリックし、「代替テキスト（Alt Text）」を編集して、挿入したい画像フィールドラベル（例：`{d.imageUrl}`）を入力します。

![20250414211130-2025-04-14-21-11-31](https://static-docs.nocobase.com/20250414211130-2025-04-14-21-11-31.png)

3. 以下のサンプルデータを使用してレンダリングします。
```json
{
  "name": "Apple",
  "imageUrl": "https://images.pexels.com/photos/206959/pexels-photo-206959.jpeg",
}
```

4. レンダリング結果では、一時的な画像が実際の画像に置き換えられます。

![20250414203444-2025-04-14-20-34-46](https://static-docs.nocobase.com/20250414203444-2025-04-14-20-34-46.png)

##### 複数画像のループによる置き換え

テンプレートに商品リストのような一連の画像を挿入したい場合は、ループを使用して実現できます。具体的な手順は以下の通りです。
1. データが以下のようになっていると仮定します。
```json
{
  "products": [
    {
      "name": "Apple",
      "imageUrl": "https://images.pexels.com/photos/206959/pexels-photo-206959.jpeg",
    },
    {
      "name": "Banana",
      "imageUrl": "https://images.pexels.com/photos/61127/pexels-photo-61127.jpeg",
    },
  ]
}
```

2. DOCXテンプレートでループ領域を設定し、各ループ項目に一時的な画像を挿入し、代替テキストを`{d.products[i].imageUrl}`に設定します。以下に示す通りです。

![20250414205418-2025-04-14-20-54-19](https://static-docs.nocobase.com/20250414205418-2025-04-14-20-54-19.png)

3. レンダリング後、すべての一時的な画像はそれぞれのデータ画像に置き換えられます。

![20250414205503-2025-04-14-20-55-05](https://static-docs.nocobase.com/20250414205503-2025-04-14-20-55-05.png)

#### XLSXファイルに動的画像を挿入する

Excelテンプレート（XLSX）での操作方法は基本的に同じですが、以下の点に注意してください。

1. 画像を挿入した後、画像がセル上に浮いているのではなく、「セル内の画像」が選択されていることを確認してください。

![20250414211643-2025-04-14-21-16-45](https://static-docs.nocobase.com/20250414211643-2025-04-14-21-16-45.png)

2. セルを選択した後、「代替テキスト」をクリックして、`{d.imageUrl}`のようなフィールドラベルを入力します。

### バーコード
:::info
現在、XLSX、DOCXファイルタイプに対応しています。
:::

#### バーコードの生成（QRコードなど）

バーコードの生成方法は動的画像と同じで、たった3つのステップで完了します。

1. テンプレートにバーコードの位置を示すための一時的な画像を挿入します。

2. 画像の「代替テキスト」を編集し、バーコード形式のフィールドラベル（例：`{d.code:barcode(qrcode)}`）を記述します。ここで`qrcode`はバーコードのタイプです（対応リストは以下を参照してください）。

![20250414214626-2025-04-14-21-46-28](https://static-docs.nocobase.com/20250414214626-2025-04-14-21-46-28.png)

3. レンダリング後、このプレースホルダー画像は対応するバーコード画像に自動的に置き換えられます。

![20250414214925-2025-04-14-21-49-26](https://static-docs.nocobase.com/20250414214925-2025-04-14-21-49-26.png)

#### サポートされているバーコードタイプ

| バーコード名 | タイプ   |
| -------- | ------ |
| QRコード   | qrcode |