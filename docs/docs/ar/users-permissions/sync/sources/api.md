:::tip إشعار الترجمة بالذكاء الاصطناعي
تمت ترجمة هذه الوثائق تلقائيًا بواسطة الذكاء الاصطناعي.
:::

# مزامنة بيانات المستخدم عبر واجهة برمجة تطبيقات HTTP

## الحصول على مفتاح API

راجع [مفاتيح API](/auth-verification/api-keys). تأكد من أن الدور المرتبط بمفتاح API لديه الأذونات اللازمة لمزامنة بيانات المستخدم.

## نظرة عامة على واجهة برمجة التطبيقات (API)

### مثال

```bash
curl 'https://localhost:13000/api/userData:push' \
  -H 'Authorization: Bearer <token>' \
  --data-raw '{"dataType":"user","records":[]}' # راجع التفاصيل الكاملة لهيكل الطلب أدناه
```

### نقطة النهاية

```bash
POST /api/userData:push
```

### تنسيق بيانات المستخدم

#### `UserData`

| المعلمة     | النوع                               | الوصف                                                                     |
| ---------- | ---------------------------------- | ------------------------------------------------------------------------- |
| `dataType` | `'user' \| 'department'`           | مطلوب. نوع البيانات التي يتم دفعها. استخدم `user` لدفع بيانات المستخدم.    |
| `matchKey` | `'username' \| 'email' \| 'phone'` | اختياري. يُستخدم لمطابقة المستخدمين الحاليين في النظام بناءً على الحقل المحدد. |
| `records`  | `UserRecord[]`                     | مطلوب. مصفوفة سجلات بيانات المستخدم.                                      |

#### `UserRecord`

| المعلمة        | النوع       | الوصف                                                                                                                            |
| ------------- | ---------- | -------------------------------------------------------------------------------------------------------------------------------- |
| `uid`         | `string`   | مطلوب. معرف فريد لبيانات المستخدم المصدر، يُستخدم لربط البيانات المصدر بمستخدم النظام. غير قابل للتغيير للمستخدم الواحد. |
| `nickname`    | `string`   | اختياري. اسم مستعار للمستخدم.                                                                                                    |
| `username`    | `string`   | اختياري. اسم المستخدم.                                                                                                           |
| `email`       | `string`   | اختياري. عنوان البريد الإلكتروني للمستخدم.                                                                                       |
| `phone`       | `string`   | اختياري. رقم هاتف المستخدم.                                                                                                      |
| `departments` | `string[]` | اختياري. مصفوفة بمعرفات UID للأقسام التي ينتمي إليها المستخدم.                                                                    |
| `isDeleted`   | `boolean`  | اختياري. يشير إلى ما إذا كان السجل محذوفًا.                                                                                      |
| `<field>`     | `any`      | اختياري. حقول مخصصة أخرى في جدول المستخدمين.                                                                                     |

### تنسيق بيانات القسم

:::info
يتطلب دفع بيانات القسم تثبيت وتفعيل إضافة [الأقسام](../../departments).
:::

#### `DepartmentData`

| المعلمة     | النوع                     | الوصف                                                                    |
| ---------- | ------------------------ | ------------------------------------------------------------------------ |
| `dataType` | `'user' \| 'department'` | مطلوب. نوع البيانات التي يتم دفعها. استخدم `department` لبيانات القسم.    |
| `records`  | `DepartmentRecord[]`     | مطلوب. مصفوفة سجلات بيانات القسم.                                        |

#### `DepartmentRecord`

| المعلمة      | النوع      | الوصف                                                                                                                            |
| ----------- | --------- | -------------------------------------------------------------------------------------------------------------------------------- |
| `uid`       | `string`  | مطلوب. معرف فريد لبيانات القسم المصدر، يُستخدم لربط البيانات المصدر بقسم النظام. غير قابل للتغيير.                                |
| `title`     | `string`  | مطلوب. عنوان القسم.                                                                                                              |
| `parentUid` | `string`  | اختياري. معرف UID للقسم الأصل.                                                                                                   |
| `isDeleted` | `boolean` | اختياري. يشير إلى ما إذا كان السجل محذوفًا.                                                                                      |
| `<field>`   | `any`     | اختياري. حقول مخصصة أخرى في جدول الأقسام.                                                                                        |

:::info

1.  دفع البيانات هو عملية متكررة (idempotent).
2.  إذا لم يكن القسم الأصل موجودًا عند دفع بيانات القسم، فلا يمكن إنشاء الارتباط. يمكنك دفع البيانات مرة أخرى بعد إنشاء القسم الأصل.
3.  إذا لم يكن قسم المستخدم موجودًا عند دفع بيانات المستخدم، فلا يمكن ربط المستخدم بهذا القسم. يمكنك دفع بيانات المستخدم مرة أخرى بعد دفع بيانات القسم.
:::