# ูุธุฑุฉ ุนุงูุฉ ุนูู ูุธุงู ุงูุณูุงู

ูููุณู ูุธุงู ุงูุณูุงู ูู ูุญุฑู ุณูุฑ ุงูุนูู (FlowEngine) ุงูุฎุงุต ุจู NocoBase ุฅูู ุซูุงุซ ุทุจูุงุชุ ุชุชูุงูู ูู ูููุง ูุน ูุทุงู ูุฎุชูู. ููููู ุงุณุชุฎุฏุงููุง ุจุดูู ุตุญูุญ ูุชุญููู ูุดุงุฑูุฉ ูุนุฒู ูุฑููู ููุฎุฏูุงุช ูุงูุฅุนุฏุงุฏุงุช ูุงูุจูุงูุงุชุ ููุง ูุนุฒุฒ ูุงุจููุฉ ุตูุงูุฉ ุงูุฃุนูุงู ูุชูุณูุนูุง.

- **FlowEngineContext (ุงูุณูุงู ุงูุนุงู)**: ูุฑูุฏ ุนุงููููุงุ ูููู ุงููุตูู ุฅููู ูู ุฌููุน ุงูููุงุฐุฌ ูุณูุฑ ุงูุนููุ ูููุงุณุจ ูุชุณุฌูู ุงูุฎุฏูุงุช ูุงูุฅุนุฏุงุฏุงุช ุงูุนุงูุฉ ููุง ุฅูู ุฐูู.
- **FlowModelContext (ุณูุงู ุงููููุฐุฌ)**: ููุณุชุฎุฏู ููุดุงุฑูุฉ ุงูุณูุงู ุฏุงุฎู ุดุฌุฑุฉ ุงููููุฐุฌ. ุชููููุถ ุงูููุงุฐุฌ ุงููุฑุนูุฉ ุชููุงุฆููุง ุฅูู ุณูุงู ุงููููุฐุฌ ุงูุฃุจุ ูุน ุฏุนู ุชุฌุงูุฒ ุงูุฃุณูุงุก ุงููุชุดุงุจูุฉ. ููุงุณุจ ูุนุฒู ุงูููุทู ูุงูุจูุงูุงุช ุนูู ูุณุชูู ุงููููุฐุฌ.
- **FlowRuntimeContext (ุณูุงู ููุช ุชุดุบูู ุณูุฑ ุงูุนูู)**: ูููุดุฃ ูู ูู ูุฑุฉ ูุชู ูููุง ุชูููุฐ ุณูุฑ ุนููุ ููุณุชูุฑ ุทูุงู ุฏูุฑุฉ ุชูููุฐ ุณูุฑ ุงูุนูู ุจุฃููููุง. ููุงุณุจ ูุชูุฑูุฑ ุงูุจูุงูุงุชุ ูุชุฎุฒูู ุงููุชุบูุฑุงุชุ ูุชุณุฌูู ุญุงูุฉ ุงูุชุดุบูู ุถูู ุณูุฑ ุงูุนูู. ูุฏุนู ูุถุนูู: `mode: 'runtime' | 'settings'`ุ ูุชูุงููุงู ูุน ูุถุน ุงูุชุดุบูู ููุถุน ุงูุฅุนุฏุงุฏุงุช ุนูู ุงูุชูุงูู.

ุฌููุน `FlowEngineContext` (ุงูุณูุงู ุงูุนุงู)ุ ู`FlowModelContext` (ุณูุงู ุงููููุฐุฌ)ุ ู`FlowRuntimeContext` (ุณูุงู ููุช ุชุดุบูู ุณูุฑ ุงูุนูู)ุ ููุง ุฅูู ุฐููุ ูู ูุฆุงุช ูุฑุนูุฉ ุฃู ููุณุฎ ูู `FlowContext`.

---

## ๐๏ธ ูุฎุทุท ุงููููู ุงููุฑูู

```text
FlowEngineContext (ุงูุณูุงู ุงูุนุงู)
โ
โโโ FlowModelContext (ุณูุงู ุงููููุฐุฌ)
โ     โโโ Sub FlowModelContext (ูููุฐุฌ ูุฑุนู)
โ     โ     โโโ FlowRuntimeContext (ุณูุงู ููุช ุชุดุบูู ุณูุฑ ุงูุนูู)
โ     โ     โโโ FlowRuntimeContext (ุณูุงู ููุช ุชุดุบูู ุณูุฑ ุงูุนูู)
โ     โโโ FlowRuntimeContext (ุณูุงู ููุช ุชุดุบูู ุณูุฑ ุงูุนูู)
โ
โโโ FlowModelContext (ุณูุงู ุงููููุฐุฌ)
โ     โโโ FlowRuntimeContext (ุณูุงู ููุช ุชุดุบูู ุณูุฑ ุงูุนูู)
โ
โโโ FlowModelContext (ุณูุงู ุงููููุฐุฌ)
      โโโ Sub FlowModelContext (ูููุฐุฌ ูุฑุนู)
      โ     โโโ FlowRuntimeContext (ุณูุงู ููุช ุชุดุบูู ุณูุฑ ุงูุนูู)
      โโโ FlowRuntimeContext (ุณูุงู ููุช ุชุดุบูู ุณูุฑ ุงูุนูู)
```

- ูููู ูู `FlowModelContext` ุงููุตูู ุฅูู ุฎุตุงุฆุต ูููุงู `FlowEngineContext` ุนุจุฑ ุขููุฉ ุงูุชูููุถ (delegate)ุ ููุง ูุชูุญ ูุดุงุฑูุฉ ุงูุฅููุงููุงุช ุงูุนุงูุฉ.
- ูููู ูู `FlowModelContext` ุงูุฎุงุต ุจุงููููุฐุฌ ุงููุฑุนู ุงููุตูู ุฅูู ุณูุงู ุงููููุฐุฌ ุงูุฃุจ (ุนูุงูุฉ ูุชุฒุงููุฉ) ุนุจุฑ ุขููุฉ ุงูุชูููุถุ ูุน ุฏุนู ุชุฌุงูุฒ ุงูุฃุณูุงุก ุงููุชุดุงุจูุฉ.
- ูุง ุชููุดุฆ ุงูููุงุฐุฌ ุงูุฃุจ ูุงูุงุจู ุบูุฑ ุงููุชุฒุงููุฉ ุนูุงูุฉ ุชูููุถ ูุชุฌูุจ ุชููุซ ุงูุญุงูุฉ.
- ูุตู `FlowRuntimeContext` ุฏุงุฆููุง ุฅูู `FlowModelContext` ุงูููุงุจู ูู ุนุจุฑ ุขููุฉ ุงูุชูููุถุ ููููู ูุง ููุดุฑ ุงูุชุบููุฑุงุช ุตุนูุฏูุง.

---
:::tip ุฅุดุนุงุฑ ุงูุชุฑุฌูุฉ ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู
ุชูุช ุชุฑุฌูุฉ ูุฐู ุงููุซุงุฆู ุชููุงุฆููุง ุจูุงุณุทุฉ ุงูุฐูุงุก ุงูุงุตุทูุงุนู.
:::



## ๐งญ ูุถุน ุงูุชุดุบูู ููุถุน ุงูุฅุนุฏุงุฏุงุช (mode)

ูุฏุนู `FlowRuntimeContext` ูุถุนููุ ูุชู ุงูุชูููุฒ ุจููููุง ุจูุงุณุทุฉ ุงููุนุงูู `mode`:

- `mode: 'runtime'` (ูุถุน ุงูุชุดุบูู): ููุณุชุฎุฏู ุฎูุงู ูุฑุญูุฉ ุงูุชูููุฐ ุงููุนูู ูุณูุฑ ุงูุนูู. ุชูุฑุฌุน ุงูุฎุตุงุฆุต ูุงูููุงู ุจูุงูุงุช ุญููููุฉ. ุนูู ุณุจูู ุงููุซุงู:
  ```js
  console.log(runtimeCtx.steps.step1.result); // 42
  ```

- `mode: 'settings'` (ูุถุน ุงูุฅุนุฏุงุฏุงุช): ููุณุชุฎุฏู ุฎูุงู ูุฑุญูุฉ ุชุตููู ุณูุฑ ุงูุนูู ูุชููููู. ููุฑุฌุน ุงููุตูู ุฅูู ุงูุฎุงุตูุฉ ุณูุณูุฉ ูุงูุจ ูุชุบูุฑุ ููุง ูุณูู ุงุฎุชูุงุฑ ุงูุชุนุจูุฑุงุช ูุงููุชุบูุฑุงุช. ุนูู ุณุจูู ุงููุซุงู:
  ```js
  console.log(settingsCtx.steps.step1.result); // '{{ ctx.steps.step1.result }}'
  ```

ูุถูู ูุฐุง ุงูุชุตููู ุซูุงุฆู ุงููุถุน ุชููุฑ ุงูุจูุงูุงุช ูู ููุช ุงูุชุดุบูู ููุณูู ุงูุฅุดุงุฑุฉ ุฅูู ุงููุชุบูุฑุงุช ูุชูููุฏ ุงูุชุนุจูุฑุงุช ุฃุซูุงุก ุงูุชููููุ ููุง ูุนุฒุฒ ูุฑููุฉ ูุญุฑู ุณูุฑ ุงูุนูู ูุณูููุฉ ุงุณุชุฎุฏุงูู.