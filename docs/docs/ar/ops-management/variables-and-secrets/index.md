---
pkg: "@nocobase/plugin-environment-variables"
---
:::tip إشعار الترجمة بالذكاء الاصطناعي
تمت ترجمة هذه الوثائق تلقائيًا بواسطة الذكاء الاصطناعي.
:::



pkg: "@nocobase/plugin-environment-variables"
---

# المتغيرات والمفاتيح السرية

## مقدمة

تتيح لك هذه الميزة إمكانية إعداد وإدارة المتغيرات البيئية والمفاتيح السرية بشكل مركزي، وذلك لأغراض تخزين البيانات الحساسة، وإعادة استخدام بيانات الإعدادات، وعزل إعدادات البيئات المختلفة.

## الاختلافات عن ملفات `.env`

| **الميزة** | **ملف `.env`** | **المتغيرات والمفاتيح السرية المُعدّة ديناميكيًا** |
| :---------- | :------------------------------------------------------ | :------------------------------------------------------------------------ |
| **موقع التخزين** | تُخزّن في ملف `.env` في الدليل الجذر للمشروع | تُخزّن في جدول `environmentVariables` بقاعدة البيانات |
| **طريقة التحميل** | تُحمّل إلى `process.env` باستخدام أدوات مثل `dotenv` عند بدء تشغيل التطبيق | تُقرأ ديناميكيًا وتُحمّل إلى `app.environment` عند بدء تشغيل التطبيق |
| **طريقة التعديل** | تتطلب التعديل المباشر للملف، ويجب إعادة تشغيل التطبيق لتطبيق التغييرات | تدعم التعديل أثناء التشغيل، وتُطبّق التغييرات فورًا بعد إعادة تحميل إعدادات التطبيق |
| **عزل البيئات** | تتطلب كل بيئة (تطوير، اختبار، إنتاج) صيانة منفصلة لملفات `.env` | تتطلب كل بيئة (تطوير، اختبار، إنتاج) صيانة منفصلة للبيانات في جدول `environmentVariables` |
| **سيناريوهات الاستخدام** | مناسبة للإعدادات الثابتة، مثل معلومات قاعدة البيانات الرئيسية للتطبيق | مناسبة للإعدادات الديناميكية التي تتطلب تعديلات متكررة أو ترتبط بمنطق الأعمال، مثل قواعد البيانات الخارجية، ومعلومات تخزين الملفات، وما إلى ذلك. |

## التثبيت

إضافة مدمجة، لا تتطلب تثبيتًا منفصلاً.

## الاستخدام

### إعادة استخدام بيانات الإعدادات

على سبيل المثال، إذا كانت هناك حاجة لعقد بريد إلكتروني في عدة أماكن ضمن سير العمل، وتتطلب جميعها إعداد SMTP، فيمكن تخزين إعداد SMTP العام في المتغيرات البيئية.

![20250102181045](https://static-docs.nocobase.com/20250102181045.png)

### تخزين البيانات الحساسة

تخزين معلومات إعدادات قواعد البيانات الخارجية المختلفة، ومفاتيح تخزين الملفات السحابية، وغيرها من البيانات الحساسة.

![20250102103513](https://static-docs.nocobase.com/20250102103513.png)

### عزل إعدادات البيئات

في بيئات مختلفة مثل التطوير والاختبار والإنتاج، تُستخدم استراتيجيات إدارة إعدادات مستقلة لضمان عدم تداخل إعدادات وبيانات كل بيئة. تمتلك كل بيئة إعداداتها ومتغيراتها ومواردها المستقلة، مما يجنب التعارضات بين بيئات التطوير والاختبار والإنتاج، ويضمن في الوقت نفسه أن النظام يعمل كما هو متوقع في كل بيئة.

على سبيل المثال، قد تختلف إعدادات خدمات تخزين الملفات بين بيئات التطوير والإنتاج، كما هو موضح أدناه:

بيئة التطوير

```bash
FILE_STORAGE_OSS_BASE_URL=dev-storage.nocobase.com
FILE_STORAGE_OSS_BUCKET=dev-storage
```

بيئة الإنتاج

```bash
FILE_STORAGE_OSS_BASE_URL=prod-storage.nocobase.com
FILE_STORAGE_OSS_BUCKET=prod-storage
```

## إدارة المتغيرات البيئية

![20250102155314](https://static-docs.nocobase.com/20250102155314.png)

### إضافة المتغيرات البيئية

- تدعم الإضافة الفردية والجماعية
- تدعم التخزين بنص عادي ومشفر

![20250102155509](https://static-docs.nocobase.com/20250102155509.png)

إضافة فردية

![20250102155731](https://static-docs.nocobase.com/20250102155731.png)

إضافة جماعية

![20250102155258](https://static-docs.nocobase.com/20250102155258.png)

## ملاحظات هامة

### إعادة تشغيل التطبيق

بعد تعديل أو حذف المتغيرات البيئية، ستظهر رسالة في الأعلى تطلب إعادة تشغيل التطبيق. لن تُطبّق التغييرات على المتغيرات البيئية إلا بعد إعادة تشغيل التطبيق.

![20250102155007](https://static-docs.nocobase.com/20250102155007.png)

### التخزين المشفر

تستخدم البيانات المشفرة للمتغيرات البيئية تشفير AES المتماثل. يُخزّن المفتاح الخاص (PRIVATE KEY) للتشفير وفك التشفير في مجلد التخزين. يُرجى الاحتفاظ به بأمان؛ ففي حال فقدانه أو الكتابة فوقه، لن تتمكن من فك تشفير البيانات المشفرة.

```bash
./storage/environment-variables/<app-name>/aes_key.dat
```

## الإضافات المدعومة حاليًا للمتغيرات البيئية

### الإجراء: طلب مخصص

![20250102180751](https://static-docs.nocobase.com/20250102180751.png)

### المصادقة: CAS

![20250102160129](https://static-docs.nocobase.com/20250102160129.png)

### المصادقة: DingTalk

![20250102160205](https://static-docs.nocobase.com/20250102160205.png)

### المصادقة: LDAP

![20250102160312](https://static-docs.nocobase.com/20250102160312.png)

### المصادقة: OIDC

![20250102160426](https://static-docs.nocobase.com/20250102160426.png)

### المصادقة: SAML

![20250102160652](https://static-docs.nocobase.com/20250102160652.png)

### المصادقة: WeCom

![20250102160758](https://static-docs.nocobase.com/20250102160758.png)

### مصدر البيانات: MariaDB خارجي

![20250102160935](https://static-docs.nocobase.com/20250102160935.png)

### مصدر البيانات: MySQL خارجي

![20250102173602](https://static-docs.nocobase.com/20250102173602.png)

### مصدر البيانات: Oracle خارجي

![20250102174153](https://static-docs.nocobase.com/20250102174153.png)

### مصدر البيانات: PostgreSQL خارجي

![20250102175630](https://static-docs.nocobase.com/20250102175630.png)

### مصدر البيانات: SQL Server خارجي

![20250102175814](https://static-docs.nocobase.com/20250102175814.png)

### مصدر البيانات: KingbaseES

![20250102175951](https://static-docs.nocobase.com/20250102175951.png)

### مصدر البيانات: REST API

![20250102180109](https://static-docs.nocobase.com/20250102180109.png)

### تخزين الملفات: محلي

![20250102161114](https://static-docs.nocobase.com/20250102161114.png)

### تخزين الملفات: Aliyun OSS

![20250102161404](https://static-docs.nocobase.com/20250102161404.png)

### تخزين الملفات: Amazon S3

![20250102163730](https://static-docs.nocobase.com/20250102163730.png)

### تخزين الملفات: Tencent COS

![20250102173109](https://static-docs.nocobase.com/20250102173109.png)

### تخزين الملفات: S3 Pro

غير متوفرة حاليًا

### الخرائط: AMap

![20250102163803](https://static-docs.nocobase.com/20250102163803.png)

### الخرائط: Google

![20250102171524](https://static-docs.nocobase.com/20250102171524.png)

### إعدادات البريد الإلكتروني

غير متوفرة حاليًا

### الإشعارات: البريد الإلكتروني

![20250102164059](https://static-docs.nocobase.com/20250102164059.png)

### النماذج العامة

![20250102163849](https://static-docs.nocobase.com/20250102163849.png)

### إعدادات النظام

![20250102164139](https://static-docs.nocobase.com/20250102164139.png)

### التحقق: رسائل Aliyun القصيرة

![20250102164247](https://static-docs.nocobase.com/20250102164247.png)

### التحقق: رسائل Tencent القصيرة

![20250102165814](https://static-docs.nocobase.com/20250102165814.png)

### سير العمل

![20250102180537](https://static-docs.nocobase.com/20250102180537.png)