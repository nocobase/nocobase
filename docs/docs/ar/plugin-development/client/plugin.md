:::tip إشعار الترجمة بالذكاء الاصطناعي
تمت ترجمة هذه الوثائق تلقائيًا بواسطة الذكاء الاصطناعي.
:::

# إضافة (Plugin)

في NocoBase، تُعد **إضافة العميل (Client Plugin)** الطريقة الأساسية لتوسيع وتخصيص وظائف الواجهة الأمامية. من خلال وراثة الفئة الأساسية `Plugin` التي يوفرها `@nocobase/client`، يمكن للمطورين تسجيل المنطق، وإضافة مكونات الصفحات، وتوسيع القوائم، أو دمج وظائف الطرف الثالث في مراحل دورة حياة مختلفة.

## هيكل فئة الإضافة

فيما يلي هيكل إضافة العميل الأساسي:

```ts
import { Plugin } from '@nocobase/client';

export class PluginHelloClient extends Plugin {
  async afterAdd() {
    // يتم التنفيذ بعد إضافة الإضافة
    console.log('Plugin added');
  }

  async beforeLoad() {
    // يتم التنفيذ قبل تحميل الإضافة
    console.log('Before plugin load');
  }

  async load() {
    // يتم التنفيذ عند تحميل الإضافة، وتسجيل المسارات ومكونات واجهة المستخدم، وما إلى ذلك.
    console.log('Plugin loaded');
  }
}

export default PluginHelloClient;
```

## وصف دورة الحياة

يمر كل إضافة بدورة الحياة التالية بالتسلسل عند تحديث المتصفح أو تهيئة التطبيق:

| طريقة دورة الحياة | وقت التنفيذ | الوصف |
|-------------------|-------------|-------|
| **afterAdd()**    | يتم التنفيذ فور إضافة الإضافة إلى مدير الإضافات | في هذه المرحلة، يكون كائن الإضافة قد تم إنشاؤه، ولكن لم يتم الانتهاء من تهيئة جميع الإضافات. مناسب للتهيئة الخفيفة، مثل قراءة الإعدادات أو ربط الأحداث الأساسية. |
| **beforeLoad()**  | يتم التنفيذ قبل `load()` لجميع الإضافات | يمكن الوصول إلى جميع كائنات الإضافات المُمكّنة (`this.app.pm.get()`). مناسب لتنفيذ منطق التحضير الذي يعتمد على إضافات أخرى. |
| **load()**        | يتم التنفيذ عند تحميل الإضافة | يتم تنفيذ هذه الطريقة بعد اكتمال `beforeLoad()` لجميع الإضافات. مناسب لتسجيل مسارات الواجهة الأمامية، ومكونات واجهة المستخدم، وغيرها من المنطق الأساسي. |

## ترتيب التنفيذ

في كل مرة يتم فيها تحديث المتصفح، سيتم تنفيذ `afterAdd()` → `beforeLoad()` → `load()`

## سياق الإضافة و FlowEngine

بدءًا من NocoBase 2.0، تتركز واجهات برمجة تطبيقات التوسيع الخاصة بالعميل بشكل أساسي في **FlowEngine**. في فئة الإضافة، يمكنك الحصول على كائن المحرك عبر `this.engine`.

```ts
// الوصول إلى سياق المحرك في طريقة load()
async load() {
  const { app, router, apiClient } = this.engine.context;
  console.log('Current app:', app);
}
```

لمزيد من المحتوى، راجع:
- [FlowEngine](/flow-engine)
- [السياق](./context.md)