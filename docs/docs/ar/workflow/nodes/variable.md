---
pkg: '@nocobase/plugin-workflow-variable'
---
:::tip إشعار الترجمة بالذكاء الاصطناعي
تمت ترجمة هذه الوثائق تلقائيًا بواسطة الذكاء الاصطناعي.
:::


# متغير

## مقدمة

يمكنك تعريف المتغيرات في سير العمل أو إسناد قيم لمتغيرات معرفة مسبقًا. يُستخدم هذا عادةً لتخزين البيانات المؤقتة ضمن سير العمل.

## إنشاء عقدة

في واجهة إعدادات سير العمل، انقر على زر الزائد ("+") في سير العمل لإضافة عقدة "متغير":

![إضافة عقدة متغير](https://static-docs.nocobase.com/53b1e48e777bfff7f2a08271526ef3ee.png)

## إعداد العقدة

### الوضع

عقدة المتغير تشبه المتغيرات في البرمجة؛ يجب تعريفها أولاً قبل أن تتمكن من استخدامها وإسناد قيمة لها. لذلك، عند إنشاء عقدة متغير، تحتاج إلى اختيار وضع المتغير. هناك وضعان متاحان للاختيار:

![اختيار الوضع](https://static-docs.nocobase.com/49d8b7b501de6faef6f303262aa14550.png)

- تعريف متغير جديد: لإنشاء متغير جديد.
- إسناد قيمة لمتغير موجود: لإسناد قيمة لمتغير تم تعريفه مسبقًا في سير العمل، وهو ما يعادل تعديل قيمة المتغير.

عندما تكون العقدة التي يتم إنشاؤها هي أول عقدة متغير في سير العمل، يمكنك فقط اختيار وضع التعريف، حيث لا توجد متغيرات متاحة للإسناد إليها بعد.

عند اختيار إسناد قيمة لمتغير معرف مسبقًا، تحتاج أيضًا إلى تحديد المتغير الهدف، وهو العقدة التي تم تعريف المتغير فيها:

![اختيار المتغير لإسناد قيمة إليه](https://static-docs.nocobase.com/1ce8911548d7347e693d8cc8ac1953eb.png)

### القيمة

يمكن أن تكون قيمة المتغير من أي نوع. يمكن أن تكون ثابتة، مثل سلسلة نصية أو رقم أو قيمة منطقية أو تاريخ، أو يمكن أن تكون متغيرًا آخر من سير العمل.

في وضع التعريف، يعادل تعيين قيمة للمتغير إسناد قيمة أولية له.

![تعريف قيمة أولية](https://static-docs.nocobase.com/4ce2c65ad537343013758c6a4.png)

في وضع الإسناد، يعادل تعيين قيمة للمتغير تعديل قيمة المتغير الهدف المُعرّف إلى قيمة جديدة. وستحصل الاستخدامات اللاحقة على هذه القيمة الجديدة.

![إسناد متغير المشغل إلى متغير معرف](https://static-docs.nocobase.com/858bae180712ad279ae6a964a77a7659.png)

## استخدام قيمة المتغير

في العقد اللاحقة لعقدة المتغير، يمكنك استخدام قيمة المتغير عن طريق اختيار المتغير المُعرّف من مجموعة "متغيرات العقدة". على سبيل المثال، في عقدة الاستعلام، استخدم قيمة المتغير كشرط للاستعلام:

![استخدام قيمة المتغير كشرط تصفية للاستعلام](https://static-docs.nocobase.com/1ca91c295254ff85999a1751499f14bc.png)

## مثال

تظهر فائدة عقدة المتغير بشكل أكبر في الفروع، حيث يتم حساب أو دمج قيم جديدة مع قيم سابقة (على غرار `reduce`/`concat` في البرمجة)، ثم استخدامها بعد انتهاء الفرع. فيما يلي مثال على استخدام فرع التكرار وعقدة المتغير لدمج سلسلة نصية للمستلمين.

أولاً، أنشئ سير عمل يتم تشغيله بواسطة مجموعة، بحيث يتم تشغيله عند تحديث بيانات "المقالات"، ويقوم بتحميل مسبق لبيانات علاقة "المؤلف" ذات الصلة (للحصول على المستلمين):

![إعداد المشغل](https://static-docs.nocobase.com/93327530a93c695c637d74cdfdcd5cde.png)

ثم، أنشئ عقدة متغير لتخزين سلسلة نصية للمستلمين:

![عقدة متغير المستلم](https://static-docs.nocobase.com/d26fa4a7e7ee4f34e0d8392a51c6666e.png)

بعد ذلك، أنشئ عقدة فرع تكرار للتنقل عبر مؤلفي المقال ودمج معلومات المستلمين الخاصة بهم في متغير المستلم:

![التكرار عبر المؤلفين في المقال](https://static-docs.nocobase.com/083fe62c943c17a643dc47ec2872e07c.png)

ضمن فرع التكرار، أنشئ أولاً عقدة حساب لدمج المؤلف الحالي مع سلسلة المؤلف المخزنة مسبقًا:

![دمج سلسلة المستلمين](https://static-docs.nocobase.com/5d21a990162f32cb8818d27b16fd1bcd.png)

بعد عقدة الحساب، أنشئ عقدة متغير أخرى. اختر وضع الإسناد، وحدد عقدة متغير المستلم كهدف للإسناد، واختر نتيجة عقدة الحساب كقيمة:

![إسناد سلسلة المستلمين المدمجة إلى عقدة المستلم](https://static-docs.nocobase.com/fc40ed95dd9b61d924b7ca11b23f9482.png)

بهذه الطريقة، بعد انتهاء فرع التكرار، سيتم تخزين سلسلة المستلمين لجميع مؤلفي المقالات في متغير المستلم. بعد ذلك، يمكنك استخدام عقدة طلب HTTP بعد التكرار لاستدعاء واجهة برمجة تطبيقات إرسال البريد، وتمرير قيمة متغير المستلم كمعامل للمستلم إلى الواجهة:

![إرسال بريد إلى المستلمين عبر عقدة الطلب](https://static-docs.nocobase.com/37f71aa1a63e172bcb2dce10a250947e.png)

بذلك، تم تنفيذ ميزة إرسال البريد الإلكتروني الجماعي البسيطة باستخدام فرع التكرار وعقدة المتغير.