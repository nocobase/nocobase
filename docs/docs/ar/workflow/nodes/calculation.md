:::tip إشعار الترجمة بالذكاء الاصطناعي
تمت ترجمة هذه الوثائق تلقائيًا بواسطة الذكاء الاصطناعي.
:::

# الحساب

يمكن لعقدة الحساب تقييم تعبير، ويتم حفظ النتيجة في مخرجات العقدة المقابلة لاستخدامها من قبل العقد اللاحقة. إنها أداة لمعالجة البيانات وتحويلها، ويمكنها إلى حد ما أن تحل محل وظيفة استدعاء دالة على قيمة وتعيينها لمتغير في لغات البرمجة.

## إنشاء العقدة

في واجهة إعدادات سير العمل، انقر على زر الزائد ("+") في التدفق لإضافة عقدة "الحساب":

![Calculation Node_Add](https://static-docs.nocobase.com/58a455540d26945251cd143eb4b16579.png)

## إعدادات العقدة

![Calculation Node_Configuration](https://static-docs.nocobase.com/6a155de3f6a883d8cd1881b2d9c33874.png)

### محرك الحساب

يحدد محرك الحساب البنية المدعومة للتعبير. محركات الحساب المدعومة حاليًا هي [Math.js](https://mathjs.org/) و [Formula.js](https://formulajs.info/). يحتوي كل محرك على عدد كبير من الدوال الشائعة المضمنة وطرق معالجة البيانات. للاستخدامات المحددة، يمكنك الرجوع إلى وثائقهم الرسمية.

:::info{title=تلميح}
تجدر الإشارة إلى أن المحركات المختلفة تختلف في طريقة الوصول إلى فهارس المصفوفات. تبدأ فهارس Math.js من `1`، بينما تبدأ فهارس Formula.js من `0`.
:::

بالإضافة إلى ذلك، إذا كنت بحاجة إلى دمج سلاسل نصية بسيطة، يمكنك استخدام "قالب السلسلة النصية" مباشرةً. سيقوم هذا المحرك باستبدال المتغيرات في التعبير بقيمها المقابلة، ثم يعيد السلسلة النصية المدمجة.

### التعبير

التعبير هو تمثيل نصي (سلسلة نصية) لصيغة حسابية، ويمكن أن يتكون من متغيرات وثوابت وعوامل حسابية ودوال مدعومة. يمكنك استخدام المتغيرات من سياق سير العمل، مثل نتيجة العقدة السابقة لعقدة الحساب، أو المتغيرات المحلية للحلقة.

إذا كان إدخال التعبير لا يتوافق مع البنية، فسيتم عرض خطأ في إعدادات العقدة. إذا لم يكن المتغير موجودًا أو كان نوعه غير متطابق أثناء التنفيذ الفعلي، أو إذا تم استخدام دالة غير موجودة، فستتوقف عقدة الحساب مبكرًا بحالة خطأ.

## مثال

### حساب إجمالي سعر الطلب

عادةً ما قد يحتوي الطلب على عدة سلع، ولكل سلعة سعر وكمية مختلفان. يتطلب حساب إجمالي سعر الطلب مجموع حاصل ضرب سعر وكمية جميع السلع. بعد تحميل قائمة تفاصيل الطلب (لمجموعة بيانات علاقة واحد إلى متعدد)، يمكنك استخدام عقدة الحساب لحساب إجمالي سعر الطلب:

![Calculation Node_Example_Configuration](https://static-docs.nocobase.com/85966b0116afb49aa966eeaa85e78dae.png)

هنا، يمكن لدالة `SUMPRODUCT` من Formula.js حساب مجموع حاصل ضرب كل صف في مصفوفتين من نفس الطول، وبالتالي الحصول على إجمالي سعر الطلب.