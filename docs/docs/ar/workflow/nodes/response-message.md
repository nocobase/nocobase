---
pkg: '@nocobase/plugin-workflow-response-message'
---
:::tip إشعار الترجمة بالذكاء الاصطناعي
تمت ترجمة هذه الوثائق تلقائيًا بواسطة الذكاء الاصطناعي.
:::


# رسالة الاستجابة

## مقدمة

تُستخدم عقدة رسالة الاستجابة لإرسال رسائل مخصصة من سير العمل إلى العميل الذي قام بإرسال الإجراء، وذلك في أنواع معينة من سير العمل.

:::info{title=ملاحظة}
حاليًا، يتم دعم استخدامها في سير عمل من نوع "حدث ما قبل الإجراء" و "حدث الإجراء المخصص" في وضع المزامنة.
:::

## إنشاء عقدة

في أنواع سير العمل المدعومة، يمكنك إضافة عقدة "رسالة الاستجابة" في أي مكان ضمن سير العمل. انقر على زر الزائد ("+") في سير العمل لإضافة عقدة "رسالة الاستجابة":

![إضافة عقدة](https://static-docs.nocobase.com/eac2b3565e95e4ce59f340624062ed3d.png)

توجد رسالة الاستجابة كصفيف (array) خلال عملية الطلب بأكملها. عند تنفيذ أي عقدة رسالة استجابة في سير العمل، يتم إلحاق محتوى الرسالة الجديد بالصفيف. وعندما يرسل الخادم الاستجابة، يتم إرسال جميع الرسائل إلى العميل معًا.

## إعدادات العقدة

محتوى الرسالة هو سلسلة نصية قالبية (template string) يمكن إدراج المتغيرات فيها. يمكنك تنظيم محتوى هذا القالب بحرية في إعدادات العقدة:

![إعدادات العقدة](https://static-docs.nocobase.com/d5fa5f4002d50baf3ba16048818fddfc.png)

عندما يتم تنفيذ سير العمل وصولاً إلى هذه العقدة، سيتم تحليل القالب لتوليد محتوى الرسالة. في الإعدادات المذكورة أعلاه، سيتم استبدال المتغير "Local variable / Loop all products / Loop object / Product / Title" بقيمة محددة في سير العمل الفعلي، على سبيل المثال:

```
مخزون منتج "iPhone 14 pro" غير كافٍ
```

![محتوى الرسالة](https://static-docs.nocobase.com/06bd4a6b6ec499c853f0c39987f63a6a.png)

## إعدادات سير العمل

تعتمد حالة رسالة الاستجابة على حالة نجاح أو فشل تنفيذ سير العمل. سيؤدي فشل تنفيذ أي عقدة إلى فشل سير العمل بأكمله. في هذه الحالة، سيعود محتوى الرسالة إلى العميل بحالة فشل ويتم عرضه.

إذا كنت بحاجة إلى تحديد حالة فشل بشكل صريح في سير العمل، يمكنك استخدام "عقدة النهاية" في سير العمل وتكوينها لتكون في حالة فشل. عند تنفيذ هذه العقدة، سيخرج سير العمل بحالة فشل، وسيتم إرجاع الرسالة إلى العميل بحالة فشل.

إذا لم ينتج سير العمل بأكمله حالة فشل وتم تنفيذه بنجاح حتى النهاية، فسيعود محتوى الرسالة إلى العميل بحالة نجاح.

:::info{title=ملاحظة}
إذا تم تعريف عدة عقد لرسائل الاستجابة في سير العمل، فإن العقد التي تم تنفيذها ستلحق محتوى الرسالة بصفيف. وعند إرجاعها أخيرًا إلى العميل، سيتم إرجاع وعرض جميع محتويات الرسائل معًا.
:::

## حالات الاستخدام

### سير عمل "حدث ما قبل الإجراء"

يسمح استخدام رسالة الاستجابة في سير عمل "حدث ما قبل الإجراء" بإرسال ملاحظات الرسائل المقابلة إلى العميل بعد انتهاء سير العمل. للتفاصيل، راجع [حدث ما قبل الإجراء](../triggers/pre-action.md).

### سير عمل "حدث الإجراء المخصص"

يسمح استخدام رسالة الاستجابة في "حدث الإجراء المخصص" في وضع المزامنة بإرسال ملاحظات الرسائل المقابلة إلى العميل بعد انتهاء سير العمل. للتفاصيل، راجع [حدث الإجراء المخصص](../triggers/custom-action.md).