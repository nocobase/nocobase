---
pkg: '@nocobase/plugin-workflow-request'
---
:::tip إشعار الترجمة بالذكاء الاصطناعي
تمت ترجمة هذه الوثائق تلقائيًا بواسطة الذكاء الاصطناعي.
:::


# طلب HTTP

## مقدمة

عند الحاجة إلى التفاعل مع نظام ويب آخر، يمكن استخدام عقدة طلب HTTP. عند التنفيذ، ترسل هذه العقدة طلب HTTP إلى العنوان المحدد وفقًا لإعداداتها. يمكنها حمل البيانات بتنسيق JSON أو `application/x-www-form-urlencoded` لإتمام التفاعل مع الأنظمة الخارجية.

إذا كنت معتادًا على أدوات إرسال الطلبات مثل Postman، فستتمكن من إتقان استخدام عقدة طلب HTTP بسرعة. على عكس هذه الأدوات، يمكن لجميع المعلمات في عقدة طلب HTTP استخدام متغيرات السياق من سير العمل الحالي، مما يتيح دمجًا عضويًا مع عمليات الأعمال في النظام.

## التثبيت

إضافة مدمجة، لا تتطلب تثبيتًا.

## إنشاء عقدة

في واجهة إعدادات سير العمل، انقر على زر الزائد ("+") في المسار لإضافة عقدة "طلب HTTP":

![HTTP Request_Add](https://static-docs.nocobase.com/46f2a6fc3f6869c80f8fbd362a54e644.png)

## إعدادات العقدة

![HTTP Request Node_Configuration](https://static-docs.nocobase.com/2fcb29af66b892fa704add52e2974a52.png)

### طريقة الطلب

طرق طلب HTTP الاختيارية: `GET`، `POST`، `PUT`، `PATCH`، و `DELETE`.

### عنوان URL للطلب

عنوان URL لخدمة HTTP، يجب أن يتضمن جزء البروتوكول (`http://` أو `https://`). يوصى باستخدام `https://`.

### تنسيق بيانات الطلب

هذا هو `Content-Type` في ترويسة الطلب. للاطلاع على التنسيقات المدعومة، راجع قسم "[جسم الطلب](#request-body)".

### إعدادات ترويسة الطلب

أزواج المفتاح-القيمة لجزء ترويسة الطلب. يمكن للقيم ذات الصلة استخدام متغيرات سياق سير العمل.

:::info{title=تلميح}
يتم تكوين ترويسة الطلب `Content-Type` عبر تنسيق بيانات الطلب. لا داعي لملئها هنا، وأي تجاوز سيكون غير فعال.
:::

### معلمات الطلب

أزواج المفتاح-القيمة لجزء استعلام الطلب. يمكن للقيم ذات الصلة استخدام متغيرات سياق سير العمل.

### جسم الطلب

جزء الجسم (Body) من الطلب. يتم دعم تنسيقات مختلفة اعتمادًا على `Content-Type` المختار.

#### `application/json`

يدعم نصًا بتنسيق JSON قياسي. يمكنك إدراج متغيرات من سياق سير العمل باستخدام زر المتغيرات في الزاوية العلوية اليمنى من محرر النصوص.

:::info{title=تلميح}
يجب استخدام المتغيرات داخل سلسلة نصية (string) في JSON، على سبيل المثال: `{ "a": "{{$context.data.a}}" }`.
:::

#### `application/x-www-form-urlencoded`

تنسيق أزواج المفتاح-القيمة. يمكن للقيم استخدام متغيرات من سياق سير العمل. عند تضمين المتغيرات، سيتم تحليلها كقالب نصي وربطها لتشكيل القيمة النصية النهائية.

#### `application/xml`

يدعم نصًا بتنسيق XML قياسي. يمكنك إدراج متغيرات من سياق سير العمل باستخدام زر المتغيرات في الزاوية العلوية اليمنى من محرر النصوص.

#### `multipart/form-data` <Badge>v1.8.0+</Badge>

يدعم أزواج المفتاح-القيمة لبيانات النموذج. يمكن تحميل الملفات عند تعيين نوع البيانات إلى كائن ملف. يمكن اختيار الملفات فقط عبر المتغيرات من كائنات الملفات الموجودة في السياق، مثل نتائج استعلام على مجموعة ملفات أو بيانات علاقة من مجموعة ملفات مرتبطة.

:::info{title=تلميح}
عند اختيار بيانات الملف، تأكد من أن المتغير يتوافق مع كائن ملف واحد، وليس قائمة ملفات (في استعلام علاقة متعددة، ستكون قيمة حقل العلاقة مصفوفة).
:::

### إعدادات المهلة

عندما لا يستجيب الطلب لفترة طويلة، يمكن استخدام إعداد المهلة لإلغاء تنفيذه. إذا انتهت مهلة الطلب، فسيتم إنهاء سير العمل الحالي مبكرًا بحالة فشل.

### تجاهل الإخفاقات

تعتبر عقدة الطلب رموز حالة HTTP القياسية بين `200` و `299` (شاملة) حالات نجاح، وتعتبر جميع الحالات الأخرى فشلًا. إذا تم تحديد خيار "تجاهل الطلبات الفاشلة ومتابعة سير العمل"، فستستمر العقد اللاحقة في سير العمل في التنفيذ حتى لو فشل الطلب.

## استخدام نتيجة الاستجابة

يمكن تحليل نتيجة استجابة طلب HTTP بواسطة عقدة [استعلام JSON](./json-query.md) لاستخدامها في العقد اللاحقة.

اعتبارًا من الإصدار `v1.0.0-alpha.16`، يمكن استخدام ثلاثة أجزاء من استجابة نتيجة عقدة الطلب كمتغيرات منفصلة:

*   رمز حالة الاستجابة
*   ترويسات الاستجابة
*   بيانات الاستجابة

![HTTP Request Node_Using Response Result](https://static-docs.nocobase.com/20240529110610.png)

عادةً ما يكون رمز حالة الاستجابة رمز حالة HTTP قياسيًا في شكل رقمي، مثل `200`، `403`، وما إلى ذلك (كما يقدمه مزود الخدمة).

ترويسات الاستجابة (Response headers) تكون بتنسيق JSON. لا تزال كل من الترويسات وبيانات الاستجابة بتنسيق JSON بحاجة إلى التحليل باستخدام عقدة JSON قبل أن يمكن استخدامها.

## مثال

على سبيل المثال، يمكننا استخدام عقدة الطلب للربط مع منصة سحابية لإرسال رسائل SMS إشعارية. قد تبدو إعدادات واجهة برمجة تطبيقات (API) لخدمة رسائل SMS سحابية، مثل واجهة إرسال الرسائل القصيرة من Alibaba Cloud، كما يلي (تحتاج إلى الرجوع إلى وثائق API المحددة لتكييف المعلمات):

![HTTP Request Node_Configuration](https://static-docs.nocobase.com/20240515124004.png)

عندما يقوم سير العمل بتشغيل هذه العقدة، ستستدعي واجهة برمجة تطبيقات الرسائل القصيرة (SMS API) بالمحتوى المكون. إذا كان الطلب ناجحًا، فسيتم إرسال رسالة SMS عبر خدمة الرسائل القصيرة السحابية.