:::tip إشعار الترجمة بالذكاء الاصطناعي
تمت ترجمة هذه الوثائق تلقائيًا بواسطة الذكاء الاصطناعي.
:::

## الميزات المتقدمة

### ترقيم الصفحات

#### 1. تحديث أرقام الصفحات

##### الصيغة
ما عليك سوى إدراجه في برنامج Office الخاص بك.

##### مثال
في Microsoft Word:
- استخدم وظيفة "إدراج ← رقم الصفحة"
في LibreOffice:
- استخدم وظيفة "إدراج ← حقل ← رقم الصفحة"

##### النتيجة
في التقرير الذي تم إنشاؤه، سيتم تحديث أرقام الصفحات تلقائيًا في كل صفحة.


#### 2. إنشاء جدول المحتويات

##### الصيغة
ما عليك سوى إدراجه في برنامج Office الخاص بك.

##### مثال
في Microsoft Word:
- استخدم وظيفة "إدراج ← فهرس وجدول ← جدول المحتويات"
في LibreOffice:
- استخدم وظيفة "إدراج ← جدول المحتويات والفهرس ← جدول، فهرس أو قائمة مراجع"

##### النتيجة
سيتم تحديث جدول محتويات التقرير تلقائيًا بناءً على محتوى المستند.


#### 3. تكرار رؤوس الجداول

##### الصيغة
ما عليك سوى إدراجه في برنامج Office الخاص بك.

##### مثال
في Microsoft Word:
- انقر بزر الفأرة الأيمن على رأس الجدول ← خصائص الجدول ← حدد "تكرار كصف رأس في أعلى كل صفحة"
في LibreOffice:
- انقر بزر الفأرة الأيمن على رأس الجدول ← خصائص الجدول ← علامة تبويب تدفق النص ← حدد "تكرار العنوان"

##### النتيجة
عندما يمتد الجدول على عدة صفحات، سيتكرر الرأس تلقائيًا في أعلى كل صفحة.


### التدويل (i18n)

#### 1. ترجمة النصوص الثابتة

##### الصيغة
استخدم الوسم `{t(text)}` لتدويل النصوص الثابتة:
```
{t(meeting)}
```

##### مثال
في القالب:
```
{t(meeting)} {t(apples)}
```
توفر بيانات JSON أو قاموس الترجمة الخارجي (على سبيل المثال لـ "fr-fr") الترجمات المقابلة (على سبيل المثال، "meeting" ← "rendez-vous" و "apples" ← "Pommes").

##### النتيجة
عند إنشاء التقرير، سيتم استبدال النص بالترجمة المقابلة بناءً على اللغة المستهدفة.


#### 2. ترجمة النصوص الديناميكية

##### الصيغة
لمحتوى البيانات، يمكنك استخدام المنسق `:t`، على سبيل المثال:
```
{d.id:ifEQ(2):show({t(monday)}):elseShow({t(tuesday)})}
```

##### مثال
في القالب:
```
{d.id:ifEQ(2):show({t(monday)}):elseShow({t(tuesday)})}
```
توفر بيانات JSON وقاموس الترجمة الترجمات المناسبة.

##### النتيجة
بناءً على الشرط، سيكون الناتج إما "lundi" أو "mardi" (باستخدام اللغة المستهدفة كمثال).


### ربط المفتاح بالقيمة

#### 1. تحويل التعداد (:convEnum)

##### الصيغة
```
{data:convEnum(enumName)}
```
على سبيل المثال:
```
0:convEnum('ORDER_STATUS')
```

##### مثال
في مثال خيارات API، يتم توفير ما يلي:
```json
{
  "enum": {
    "ORDER_STATUS": ["pending", "sent", "delivered"]
  }
}
```
في القالب:
```
0:convEnum('ORDER_STATUS')
```

##### النتيجة
يُخرج "pending"؛ إذا تجاوز الفهرس نطاق التعداد، فسيتم إخراج القيمة الأصلية.


### الصور الديناميكية
:::info
يدعم حاليًا أنواع ملفات XLSX و DOCX
:::
يمكنك إدراج "صور ديناميكية" في قوالب المستندات، مما يعني أن الصور النائبة في القالب سيتم استبدالها تلقائيًا بصور حقيقية أثناء العرض بناءً على البيانات. هذه العملية بسيطة للغاية وتتطلب فقط:

1.  إدراج صورة مؤقتة كصورة نائبة
2.  تعديل "النص البديل" لتلك الصورة لتعيين تسمية الحقل
3.  عرض المستند، وسيقوم النظام تلقائيًا باستبدالها بالصورة الفعلية

سنشرح أدناه طرق التشغيل لملفات DOCX و XLSX من خلال أمثلة محددة.


#### إدراج الصور الديناميكية في ملفات DOCX
##### استبدال صورة واحدة

1.  افتح قالب DOCX الخاص بك وأدرج صورة مؤقتة (يمكن أن تكون أي صورة نائبة، مثل [صورة زرقاء صلبة](https://static-docs.nocobase.com/solid-color-image-2025-04-14-11-00-26.png))

:::info
**تعليمات تنسيق الصور**

-   حاليًا، تدعم الصور النائبة تنسيق PNG فقط. نوصي باستخدام مثالنا المقدم [صورة زرقاء صلبة](https://static-docs.nocobase.com/solid-color-image-2025-04-14-11-00-26.png)
-   تدعم الصور المعروضة المستهدفة تنسيقات PNG و JPG و JPEG فقط. قد تفشل أنواع الصور الأخرى في العرض.

**تعليمات حجم الصور**

سواء لملفات DOCX أو XLSX، سيتبع حجم الصورة النهائية المعروضة أبعاد الصورة المؤقتة في القالب. وهذا يعني أن الصورة البديلة الفعلية ستتكيّف تلقائيًا لتطابق حجم الصورة النائبة التي أدرجتها. إذا كنت ترغب في أن يكون حجم الصورة المعروضة 150×150، فيرجى استخدام صورة مؤقتة في القالب وتعديلها إلى هذا الحجم.
:::

2.  انقر بزر الفأرة الأيمن على هذه الصورة، وقم بتعديل "النص البديل" الخاص بها، واملأ تسمية حقل الصورة التي ترغب في إدراجها، على سبيل المثال `{d.imageUrl}`:

![20250414211130-2025-04-14-21-11-31](https://static-docs.nocobase.com/20250414211130-2025-04-14-21-11-31.png)

3.  استخدم بيانات المثال التالية للعرض:
```json
{
  "name": "Apple",
  "imageUrl": "https://images.pexels.com/photos/206959/pexels-photo-206959.jpeg",
}
```

4.  في النتيجة المعروضة، سيتم استبدال الصورة المؤقتة بالصورة الفعلية:

![20250414203444-2025-04-14-20-34-46](https://static-docs.nocobase.com/20250414203444-2025-04-14-20-34-46.png)

##### استبدال صور متعددة بحلقة تكرارية

إذا كنت ترغب في إدراج مجموعة من الصور في القالب، مثل قائمة المنتجات، يمكنك أيضًا تنفيذ ذلك من خلال الحلقات التكرارية. الخطوات المحددة هي كما يلي:

1.  افترض أن بياناتك كالتالي:
```json
{
  "products": [
    {
      "name": "Apple",
      "imageUrl": "https://images.pexels.com/photos/206959/pexels-photo-206959.jpeg",
    },
    {
      "name": "Banana",
      "imageUrl": "https://images.pexels.com/photos/61127/pexels-photo-61127.jpeg",
    },
  ]
}
```

2.  قم بإعداد منطقة حلقة تكرارية في قالب DOCX، وأدرج صورًا مؤقتة في كل عنصر من عناصر الحلقة مع تعيين النص البديل على `{d.products[i].imageUrl}`، كما هو موضح أدناه:

![20250414205418-2025-04-14-20-54-19](https://static-docs.nocobase.com/20250414205418-2025-04-14-20-54-19.png)

3.  بعد العرض، سيتم استبدال جميع الصور المؤقتة بصور البيانات الخاصة بها:

![20250414205503-2025-04-14-20-55-05](https://static-docs.nocobase.com/20250414205503-2025-04-14-20-55-05.png)

#### إدراج الصور الديناميكية في ملفات XLSX

طريقة التشغيل في قوالب Excel (XLSX) هي نفسها بشكل أساسي، فقط لاحظ النقاط التالية:

1.  بعد إدراج صورة، يرجى التأكد من تحديد "صورة داخل الخلية" بدلاً من أن تطفو الصورة فوق الخلية.

![20250414211643-2025-04-14-21-16-45](https://static-docs.nocobase.com/20250414211643-2025-04-14-21-16-45.png)

2.  بعد تحديد الخلية، انقر لعرض "النص البديل" لملء تسمية الحقل، مثل `{d.imageUrl}`.

### الرمز الشريطي (الباركود)
:::info
يدعم حاليًا أنواع ملفات XLSX و DOCX
:::

#### إنشاء الرموز الشريطية (مثل رموز QR)

يعمل إنشاء الرموز الشريطية بنفس طريقة الصور الديناميكية، ويتطلب ثلاث خطوات فقط:

1.  أدرج صورة مؤقتة في القالب لتحديد موضع الرمز الشريطي
2.  عدّل "النص البديل" للصورة واكتب تسمية حقل تنسيق الرمز الشريطي، على سبيل المثال `{d.code:barcode(qrcode)}`، حيث `qrcode` هو نوع الرمز الشريطي (انظر القائمة المدعومة أدناه)

![20250414214626-2025-04-14-21-46-28](https://static-docs.nocobase.com/20250414214626-2025-04-14-21-46-28.png)

3.  بعد العرض، سيتم استبدال الصورة النائبة تلقائيًا بصورة الرمز الشريطي المقابلة:

![20250414214925-2025-04-14-21-49-26](https://static-docs.nocobase.com/20250414214925-2025-04-14-21-49-26.png)

#### أنواع الرموز الشريطية المدعومة

| اسم الرمز الشريطي | النوع   |
| ----------------- | ------ |
| رمز QR             | qrcode |