---
pkg: '@nocobase/plugin-workflow-json-variable-mapping'
---
:::tip
เอกสารนี้แปลโดย AI หากมีข้อมูลที่ไม่ถูกต้อง โปรดดู[เวอร์ชันภาษาอังกฤษ](/en)
:::

# การแมปตัวแปร JSON

> v1.6.0

## บทนำ

ใช้สำหรับแมปโครงสร้าง JSON ที่ซับซ้อนจากผลลัพธ์ของโหนดต้นทาง ให้เป็นตัวแปร เพื่อนำไปใช้ในโหนดถัดไปครับ/ค่ะ ตัวอย่างเช่น หลังจากแมปผลลัพธ์จากโหนด SQL Action และ HTTP Request แล้ว คุณสามารถนำค่าคุณสมบัติ (property values) เหล่านั้นไปใช้ในโหนดถัดไปได้เลยครับ/ค่ะ

:::info{title=เคล็ดลับ}
ต่างจากโหนด JSON Calculation นะครับ/คะ โหนดการแมปตัวแปร JSON ไม่รองรับการกำหนด Expression เอง และไม่ได้อิงตามเอนจินภายนอกครับ/ค่ะ โดยจะใช้สำหรับแมปค่าคุณสมบัติ (property values) ในโครงสร้าง JSON เท่านั้น แต่ใช้งานได้ง่ายกว่าครับ/ค่ะ
:::

## การสร้างโหนด

ในหน้าจอการตั้งค่าเวิร์กโฟลว์ ให้คลิกปุ่มเครื่องหมายบวก (“+”) ในโฟลว์ เพื่อเพิ่มโหนด “การแมปตัวแปร JSON” ครับ/ค่ะ

![สร้างโหนด](https://static-docs.nocobase.com/20250113173635.png)

## การตั้งค่าโหนด

### แหล่งข้อมูล

แหล่งข้อมูลสามารถเป็นได้ทั้งผลลัพธ์จากโหนดต้นทาง หรือเป็นออบเจกต์ข้อมูล (data object) ในบริบทของกระบวนการ (process context) ครับ/ค่ะ โดยปกติแล้วจะเป็นออบเจกต์ข้อมูลที่ไม่มีโครงสร้างในตัว เช่น ผลลัพธ์จากโหนด SQL หรือโหนด HTTP Request ครับ/ค่ะ

![แหล่งข้อมูล](https://static-docs.nocobase.com/20250113173720.png)

### การป้อนข้อมูลตัวอย่าง

เพียงแค่คุณวางข้อมูลตัวอย่าง (sample data) แล้วคลิกปุ่ม Parse ระบบก็จะทำการ Parse และสร้างรายการตัวแปรให้โดยอัตโนมัติครับ/ค่ะ

![ป้อนข้อมูลตัวอย่าง](https://static-docs.nocobase.com/20250113182327.png)

หากมีตัวแปรใดในรายการที่สร้างขึ้นอัตโนมัติที่คุณไม่ต้องการใช้งาน คุณสามารถคลิกปุ่มลบเพื่อนำออกได้เลยครับ/ค่ะ

:::info{title=เคล็ดลับ}
ข้อมูลตัวอย่างไม่ใช่ผลลัพธ์สุดท้ายของการทำงานจริงนะครับ/คะ แต่ใช้เพื่อช่วยในการสร้างรายการตัวแปรเท่านั้นครับ/ค่ะ
:::

### เส้นทางรวมดัชนีอาร์เรย์

หากไม่ได้เลือกตัวเลือกนี้ เนื้อหาในอาร์เรย์จะถูกแมปตามวิธีการจัดการตัวแปรเริ่มต้นของเวิร์กโฟลว์ NocoBase ครับ/ค่ะ ตัวอย่างเช่น หากป้อนข้อมูลตัวอย่างดังนี้:

```json
{
  "a": 1,
  "b": [
    {
      "c": 2
    },
    {
      "c": 3
    }
  ]
}
```

ในตัวแปรที่สร้างขึ้น `b.c` จะแทนอาร์เรย์ `[2, 3]` ครับ/ค่ะ

แต่ถ้าเลือกตัวเลือกนี้ เส้นทางตัวแปรจะรวมดัชนีอาร์เรย์ (array index) เข้าไปด้วย ตัวอย่างเช่น `b.0.c` และ `b.1.c` ครับ/ค่ะ

![20250113184056](https://static-docs.nocobase.com/20250113184056.png)

เมื่อมีการรวมดัชนีอาร์เรย์ คุณต้องตรวจสอบให้แน่ใจว่าดัชนีอาร์เรย์ในข้อมูลที่ป้อนมีความสอดคล้องกัน มิฉะนั้นจะทำให้เกิดข้อผิดพลาดในการ Parse ครับ/ค่ะ

## การนำไปใช้ในโหนดถัดไป

ในการตั้งค่าของโหนดถัดไป คุณสามารถใช้ตัวแปรที่สร้างโดยโหนดการแมปตัวแปร JSON ได้เลยครับ/ค่ะ

![20250113203658](https://static-docs.nocobase.com/20250113203658.png)

แม้ว่าโครงสร้าง JSON อาจจะซับซ้อน แต่หลังจากทำการแมปแล้ว คุณก็เพียงแค่เลือกตัวแปรตามเส้นทางที่ต้องการได้เลยครับ/ค่ะ