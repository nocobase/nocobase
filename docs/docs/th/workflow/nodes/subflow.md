---
pkg: '@nocobase/plugin-workflow-subflow'
---
:::tip
เอกสารนี้แปลโดย AI หากมีข้อมูลที่ไม่ถูกต้อง โปรดดู[เวอร์ชันภาษาอังกฤษ](/en)
:::

# เรียกใช้เวิร์กโฟลว์

## บทนำ

ใช้สำหรับเรียกใช้เวิร์กโฟลว์อื่น ๆ จากภายในเวิร์กโฟลว์เดียวกันครับ/ค่ะ โดยคุณสามารถใช้ตัวแปรจากเวิร์กโฟลว์ปัจจุบันเป็นอินพุตสำหรับซับเวิร์กโฟลว์ (sub-workflow) และนำเอาต์พุตของซับเวิร์กโฟลว์มาใช้เป็นตัวแปรในเวิร์กโฟลว์ปัจจุบันสำหรับโหนดถัดไปได้ครับ/ค่ะ

กระบวนการเรียกใช้เวิร์กโฟลว์แสดงดังรูปด้านล่างนี้ครับ/ค่ะ

![20241230134634](https://static-docs.nocobase.com/20241230134634.png)

การเรียกใช้เวิร์กโฟลว์ช่วยให้คุณสามารถนำตรรกะของกระบวนการทั่วไปกลับมาใช้ซ้ำได้ครับ/ค่ะ เช่น การส่งอีเมล, SMS เป็นต้น หรือจะใช้เพื่อแบ่งเวิร์กโฟลว์ที่ซับซ้อนออกเป็นหลาย ๆ ซับเวิร์กโฟลว์ เพื่อให้ง่ายต่อการจัดการและบำรุงรักษาก็ได้ครับ/ค่ะ

โดยพื้นฐานแล้ว เวิร์กโฟลว์ไม่ได้แยกแยะว่ากระบวนการใดเป็นซับเวิร์กโฟลว์หรือไม่ครับ/ค่ะ เวิร์กโฟลว์ใด ๆ ก็สามารถถูกเรียกใช้เป็นซับเวิร์กโฟลว์โดยเวิร์กโฟลว์อื่นได้ และยังสามารถเรียกใช้เวิร์กโฟลว์อื่นได้เช่นกันครับ/ค่ะ เวิร์กโฟลว์ทั้งหมดมีความเท่าเทียมกัน มีเพียงความสัมพันธ์ของการเรียกใช้และถูกเรียกใช้เท่านั้นครับ/ค่ะ

เช่นเดียวกันครับ/ค่ะ การใช้งานการเรียกใช้เวิร์กโฟลว์จะเกิดขึ้นในสองตำแหน่งดังนี้:

1.  ในเวิร์กโฟลว์หลัก: ทำหน้าที่เป็นผู้เรียกใช้ โดยเรียกใช้เวิร์กโฟลว์อื่น ๆ ผ่านโหนด “เรียกใช้เวิร์กโฟลว์” ครับ/ค่ะ
2.  ในซับเวิร์กโฟลว์: ทำหน้าที่เป็นผู้ถูกเรียกใช้ โดยบันทึกตัวแปรที่ต้องการส่งออก (output) จากเวิร์กโฟลว์ปัจจุบันผ่านโหนด “เอาต์พุตเวิร์กโฟลว์” ซึ่งสามารถนำไปใช้โดยโหนดถัดไปในเวิร์กโฟลว์ที่เรียกใช้ได้ครับ/ค่ะ

## การสร้างโหนด

ในหน้าจอการตั้งค่าเวิร์กโฟลว์ ให้คลิกปุ่มเครื่องหมายบวก (“+”) ในเวิร์กโฟลว์ เพื่อเพิ่มโหนด “เรียกใช้เวิร์กโฟลว์” ครับ/ค่ะ

![Add Invoke Workflow Node](https://static-docs.nocobase.com/20241230001323.png)

## การตั้งค่าโหนด

### การเลือกเวิร์กโฟลว์

เลือกเวิร์กโฟลว์ที่ต้องการเรียกใช้ครับ/ค่ะ คุณสามารถค้นหาได้อย่างรวดเร็วผ่านช่องค้นหาได้เลยครับ/ค่ะ

![Select Workflow](https://static-docs.nocobase.com/20241230001534.png)

:::info{title=เคล็ดลับ}
*   เวิร์กโฟลว์ที่ยังไม่ได้เปิดใช้งานก็สามารถถูกเรียกใช้เป็นซับเวิร์กโฟลว์ได้ครับ/ค่ะ
*   เมื่อเวิร์กโฟลว์ปัจจุบันอยู่ในโหมดซิงโครนัส (synchronous) จะสามารถเรียกใช้ได้เฉพาะซับเวิร์กโฟลว์ที่อยู่ในโหมดซิงโครนัสเท่านั้นครับ/ค่ะ
:::

### การตั้งค่าตัวแปรทริกเกอร์ของเวิร์กโฟลว์

หลังจากเลือกเวิร์กโฟลว์แล้ว คุณจะต้องตั้งค่าตัวแปรของทริกเกอร์ เพื่อใช้เป็นข้อมูลอินพุตสำหรับเรียกใช้ซับเวิร์กโฟลว์ครับ/ค่ะ คุณสามารถเลือกข้อมูลแบบคงที่ (static data) หรือเลือกตัวแปรจากเวิร์กโฟลว์ปัจจุบันได้เลยครับ/ค่ะ

![Configure Trigger Variables](https://static-docs.nocobase.com/20241230162722.png)

ทริกเกอร์แต่ละประเภทจะต้องการตัวแปรที่แตกต่างกันไปครับ/ค่ะ คุณสามารถตั้งค่าได้บนฟอร์มตามความต้องการเลยครับ/ค่ะ

## โหนดเอาต์พุตเวิร์กโฟลว์

โปรดดูเนื้อหาในโหนด [เอาต์พุตเวิร์กโฟลว์](./output.md) เพื่อตั้งค่าตัวแปรเอาต์พุตของซับเวิร์กโฟลว์ครับ/ค่ะ

## การใช้งานเอาต์พุตเวิร์กโฟลว์

กลับมาที่เวิร์กโฟลว์หลักครับ/ค่ะ ในโหนดอื่น ๆ ที่อยู่ถัดจากโหนดเรียกใช้เวิร์กโฟลว์ หากคุณต้องการใช้ค่าเอาต์พุตของซับเวิร์กโฟลว์ คุณสามารถเลือกผลลัพธ์จากโหนดเรียกใช้เวิร์กโฟลว์ได้เลยครับ/ค่ะ หากซับเวิร์กโฟลว์ส่งออกค่าแบบง่าย (simple value) เช่น สตริง (string), ตัวเลข (number), ค่าตรรกะ (boolean), วันที่ (date ซึ่งเป็นสตริงในรูปแบบ UTC) เป็นต้น คุณสามารถนำไปใช้ได้โดยตรงครับ/ค่ะ แต่หากเป็นออบเจกต์ที่ซับซ้อน (complex object) เช่น ออบเจกต์จากคอลเลกชัน (Collection) คุณจะต้องทำการแมป (map) ผ่านโหนด JSON Parse ก่อน จึงจะสามารถใช้คุณสมบัติ (properties) ภายในได้ครับ/ค่ะ มิฉะนั้นจะสามารถใช้งานได้ในฐานะออบเจกต์ทั้งหมดเท่านั้นครับ/ค่ะ

หากซับเวิร์กโฟลว์ไม่ได้ตั้งค่าโหนดเอาต์พุตเวิร์กโฟลว์ หรือไม่มีค่าเอาต์พุตใด ๆ เมื่อคุณใช้ผลลัพธ์จากโหนดเรียกใช้เวิร์กโฟลว์ในเวิร์กโฟลว์หลัก คุณจะได้รับเพียงค่าว่างเปล่า (`null`) เท่านั้นครับ/ค่ะ