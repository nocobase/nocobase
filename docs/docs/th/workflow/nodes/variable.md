---
pkg: '@nocobase/plugin-workflow-variable'
---
:::tip
เอกสารนี้แปลโดย AI หากมีข้อมูลที่ไม่ถูกต้อง โปรดดู[เวอร์ชันภาษาอังกฤษ](/en)
:::

# ตัวแปร

## บทนำ

คุณสามารถประกาศตัวแปรในเวิร์กโฟลว์ หรือกำหนดค่าให้กับตัวแปรที่ประกาศไว้แล้วได้ครับ/ค่ะ โดยทั่วไปแล้วจะใช้เพื่อเก็บข้อมูลชั่วคราวภายในเวิร์กโฟลว์

## การสร้างโหนด

ในหน้าจอการตั้งค่าเวิร์กโฟลว์ ให้คลิกปุ่มเครื่องหมายบวก ("+") ในเวิร์กโฟลว์ เพื่อเพิ่มโหนด "ตัวแปร" ครับ/ค่ะ

![เพิ่มโหนดตัวแปร](https://static-docs.nocobase.com/53b1e48e777bfff7f2a08271526ef3ee.png)

## การตั้งค่าโหนด

### โหมด

โหนดตัวแปรจะคล้ายกับตัวแปรในการเขียนโปรแกรมครับ/ค่ะ ซึ่งต้องประกาศก่อนจึงจะสามารถใช้งานและกำหนดค่าได้ ดังนั้น เมื่อสร้างโหนดตัวแปร คุณต้องเลือกโหมดของตัวแปร โดยมีสองโหมดให้เลือกดังนี้ครับ/ค่ะ

![เลือกโหมด](https://static-docs.nocobase.com/49d8b7b501de6faef6f303262aa14550.png)

- ประกาศตัวแปรใหม่: สร้างตัวแปรใหม่ครับ/ค่ะ
- กำหนดค่าให้กับตัวแปรที่มีอยู่แล้ว: กำหนดค่าให้กับตัวแปรที่ประกาศไว้ก่อนหน้านี้ในเวิร์กโฟลว์ ซึ่งเทียบเท่ากับการแก้ไขค่าของตัวแปรครับ/ค่ะ

เมื่อโหนดที่กำลังสร้างเป็นโหนดตัวแปรแรกในเวิร์กโฟลว์ คุณจะสามารถเลือกได้เฉพาะโหมดการประกาศเท่านั้นครับ/ค่ะ เนื่องจากยังไม่มีตัวแปรใด ๆ ที่พร้อมให้กำหนดค่า

เมื่อคุณเลือกที่จะกำหนดค่าให้กับตัวแปรที่ประกาศไว้แล้ว คุณจะต้องเลือกตัวแปรเป้าหมายด้วยครับ/ค่ะ ซึ่งก็คือโหนดที่ประกาศตัวแปรนั้น:

![เลือกตัวแปรที่จะกำหนดค่า](https://static-docs.nocobase.com/1ce8911548d7347e693d8cc8ac1953eb.png)

### ค่า

ค่าของตัวแปรสามารถเป็นประเภทใดก็ได้ครับ/ค่ะ ไม่ว่าจะเป็นค่าคงที่ เช่น สตริง ตัวเลข ค่าตรรกะ วันที่ หรืออาจเป็นตัวแปรอื่น ๆ จากเวิร์กโฟลว์ก็ได้

ในโหมดการประกาศ การตั้งค่าตัวแปรจะเทียบเท่ากับการกำหนดค่าเริ่มต้นให้กับตัวแปรนั้นครับ/ค่ะ

![ประกาศค่าเริ่มต้น](https://static-docs.nocobase.com/4ce2c508986565ad537343013758c6a4.png)

ในโหมดการกำหนดค่า การตั้งค่าตัวแปรจะเทียบเท่ากับการแก้ไขค่าของตัวแปรเป้าหมายที่ประกาศไว้แล้วให้เป็นค่าใหม่ และการใช้งานในขั้นตอนถัดไปก็จะใช้ค่าใหม่นี้ครับ/ค่ะ

![กำหนดค่าตัวแปรทริกเกอร์ให้กับตัวแปรที่ประกาศไว้](https://static-docs.nocobase.com/858bae180712ad279ae6a964a77a7659.png)

## การใช้งานค่าของตัวแปร

ในโหนดถัดไปหลังจากโหนดตัวแปร คุณสามารถใช้ค่าของตัวแปรได้โดยเลือกตัวแปรที่ประกาศไว้จากกลุ่ม "ตัวแปรโหนด" ครับ/ค่ะ ตัวอย่างเช่น ในโหนดการสอบถาม (query node) คุณสามารถใช้ค่าของตัวแปรเป็นเงื่อนไขในการสอบถามได้:

![ใช้ค่าตัวแปรเป็นเงื่อนไขการกรองการสอบถาม](https://static-docs.nocobase.com/1ca91c295254ff85999a1751499f14bc.png)

## ตัวอย่าง

โหนดตัวแปรจะมีประโยชน์มากยิ่งขึ้นในสถานการณ์ที่มีการแตกสาขา (branches) ครับ/ค่ะ โดยจะใช้ในการคำนวณหรือรวมค่าใหม่เข้ากับค่าเดิม (คล้ายกับ `reduce`/`concat` ในการเขียนโปรแกรม) และนำไปใช้หลังจากสิ้นสุดสาขาแล้ว ตัวอย่างต่อไปนี้จะแสดงการใช้สาขาแบบวนซ้ำ (loop branch) และโหนดตัวแปรเพื่อสร้างสตริงผู้รับ

อันดับแรก ให้สร้างเวิร์กโฟลว์ที่ถูกทริกเกอร์โดยคอลเลกชัน ซึ่งจะทำงานเมื่อข้อมูล "บทความ" มีการอัปเดต และโหลดข้อมูลความสัมพันธ์ "ผู้เขียน" ที่เกี่ยวข้องล่วงหน้า (เพื่อใช้ในการดึงข้อมูลผู้รับ) ครับ/ค่ะ

![ตั้งค่าทริกเกอร์](https://static-docs.nocobase.com/93327530a93c695c637d74cdfdcd5cde.png)

จากนั้น ให้สร้างโหนดตัวแปร เพื่อเก็บสตริงผู้รับครับ/ค่ะ

![โหนดตัวแปรผู้รับ](https://static-docs.nocobase.com/d26fa4a7e7ee4f34e0d8392a51c6666e.png)

ถัดไป ให้สร้างโหนดสาขาแบบวนซ้ำ (loop branch node) เพื่อวนซ้ำผ่านผู้เขียนของบทความ และนำข้อมูลผู้รับของพวกเขามาต่อเข้ากับตัวแปรผู้รับครับ/ค่ะ

![วนซ้ำผ่านผู้เขียนในบทความ](https://static-docs.nocobase.com/083fe62c943c17a643dc47ec2872e07c.png)

ภายในสาขาแบบวนซ้ำ ให้สร้างโหนดการคำนวณ (calculation node) ก่อน เพื่อนำผู้เขียนปัจจุบันมาต่อเข้ากับสตริงผู้เขียนที่เก็บไว้แล้วครับ/ค่ะ

![ต่อสตริงผู้รับ](https://static-docs.nocobase.com/5d21a990162f32cb8818d27b16fd1bcd.png)

หลังจากโหนดการคำนวณ ให้สร้างโหนดตัวแปรอีกหนึ่งโหนด เลือกโหมดการกำหนดค่า โดยเลือกโหนดตัวแปรผู้รับเป็นเป้าหมายการกำหนดค่า และเลือกผลลัพธ์จากโหนดการคำนวณเป็นค่าครับ/ค่ะ

![กำหนดสตริงผู้รับที่ต่อกันแล้วให้กับโหนดผู้รับ](https://static-docs.nocobase.com/fc40ed95dd9b61d924b7ca11b23f9482.png)

ด้วยวิธีนี้ หลังจากสาขาแบบวนซ้ำเสร็จสิ้น ตัวแปรผู้รับจะเก็บสตริงผู้รับของผู้เขียนบทความทั้งหมดครับ/ค่ะ จากนั้น หลังจากวนซ้ำเสร็จสิ้น คุณสามารถใช้โหนดคำขอ HTTP (HTTP Request node) เพื่อเรียกใช้ API สำหรับส่งอีเมล โดยส่งค่าของตัวแปรผู้รับเป็นพารามิเตอร์ผู้รับไปยัง API ได้เลยครับ/ค่ะ

![ส่งอีเมลถึงผู้รับผ่านโหนดคำขอ](https://static-docs.nocobase.com/37f71aa1a63e172bcb2dce10a250947e.png)

ณ จุดนี้ ฟังก์ชันการส่งอีเมลจำนวนมากแบบง่าย ๆ ก็ได้ถูกนำมาใช้โดยใช้การวนซ้ำและโหนดตัวแปรแล้วครับ/ค่ะ