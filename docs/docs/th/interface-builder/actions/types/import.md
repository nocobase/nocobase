---
pkg: "@nocobase/plugin-action-import"
---
:::tip
เอกสารนี้แปลโดย AI หากมีข้อมูลที่ไม่ถูกต้อง โปรดดู[เวอร์ชันภาษาอังกฤษ](/en)
:::

# นำเข้า

## บทนำ

คุณสามารถนำเข้าข้อมูลโดยใช้เทมเพลต Excel ได้ครับ/ค่ะ โดยคุณสามารถกำหนดได้ว่าจะนำเข้าฟิลด์ใดบ้าง และระบบจะสร้างเทมเพลตให้โดยอัตโนมัติ

![20251029165818](https://static-docs.nocobase.com/20251029165818.png)

## คำแนะนำการนำเข้า

### ฟิลด์ประเภทตัวเลข

รองรับค่าตัวเลขและเปอร์เซ็นต์ครับ/ค่ะ ข้อความอย่าง `N/A` หรือ `-` จะถูกกรองออกไป

| ตัวเลข 1 | เปอร์เซ็นต์ | ตัวเลข 2 | ตัวเลข 3 |
| -------- | ----------- | -------- | -------- |
| 123      | 25%         | N/A      | -        |

เมื่อแปลงเป็น JSON จะได้ดังนี้ครับ/ค่ะ

```ts
{
  "ตัวเลข 1": 123,
  "เปอร์เซ็นต์": 0.25,
  "ตัวเลข 2": null,
  "ตัวเลข 3": null,
}
```

### ฟิลด์ประเภทบูลีน

ข้อความที่รองรับสำหรับการนำเข้า (ภาษาอังกฤษไม่คำนึงถึงตัวพิมพ์เล็ก-ใหญ่) มีดังนี้ครับ/ค่ะ:

- `Yes`, `Y`, `True`, `1`, `ใช่`
- `No`, `N`, `False`, `0`, `ไม่ใช่`

| ฟิลด์ 1 | ฟิลด์ 2 | ฟิลด์ 3 | ฟิลด์ 4 | ฟิลด์ 5 |
| ------- | ------- | ------- | ------- | ------- |
| ไม่ใช่  | ใช่     | Y       | true    | 0       |

เมื่อแปลงเป็น JSON จะได้ดังนี้ครับ/ค่ะ

```ts
{
  "Field1": false,
  "Field2": true,
  "Field3": true,
  "Field4": true,
  "Field5": false,
}
```

### ฟิลด์ประเภทวันที่

| DateOnly            | Local(+08:00)       | GMT                 |
| ------------------- | ------------------- | ------------------- |
| 2023-01-18 22:22:22 | 2023-01-18 22:22:22 | 2023-01-18 22:22:22 |

เมื่อแปลงเป็น JSON จะได้ดังนี้ครับ/ค่ะ

```ts
{
  "DateOnly": "2023-01-18T00:00:00.000Z",
  "Local(+08:00)": "2023-01-18T14:22:22.000Z",
  "GMT": "2023-01-18T22:22:22.000Z",
}
```

### ฟิลด์ประเภทตัวเลือก

ทั้งค่าตัวเลือก (Option Value) และป้ายกำกับตัวเลือก (Option Label) สามารถใช้เป็นข้อความสำหรับนำเข้าได้ครับ/ค่ะ โดยตัวเลือกหลายรายการจะคั่นด้วยเครื่องหมายจุลภาค (`,` `，`) หรือเครื่องหมายวรรคตอน (`、`)

ตัวอย่างเช่น ฟิลด์ `Priority` มีตัวเลือกดังนี้ครับ/ค่ะ:

| ค่าตัวเลือก | ป้ายกำกับตัวเลือก |
| ----------- | ----------------- |
| low         | ต่ำ               |
| medium      | ปานกลาง           |
| high        | สูง               |

ทั้งค่าตัวเลือกและป้ายกำกับตัวเลือกสามารถใช้เป็นข้อความสำหรับนำเข้าได้ครับ/ค่ะ

| Priority |
| -------- |
| สูง     |
| low      |

เมื่อแปลงเป็น JSON จะได้ดังนี้ครับ/ค่ะ

```ts
[{ 优先级: 'high' }, { 优先级: 'low' }];
```

### ฟิลด์เขตการปกครองของจีน

| ภูมิภาค 1      | ภูมิภาค 2      |
| ------------- | ------------- |
| 北京市/市辖区 | 天津市/市辖区 |

เมื่อแปลงเป็น JSON จะได้ดังนี้ครับ/ค่ะ

```ts
{
  "地区1": ["11","1101"],
  "地区2": ["12","1201"]
}
```

### ฟิลด์ไฟล์แนบ

| ไฟล์แนบ                                  |
| ---------------------------------------- |
| https://www.nocobase.com/images/logo.png |

เมื่อแปลงเป็น JSON จะได้ดังนี้ครับ/ค่ะ

```ts
{
  "附件": [
    {
      "filename": "logo.png",
      "title": "logo.png",
      "extname": ".png",
      "url": "https://www.nocobase.com/images/logo.png"
    }
  ]
}
```

### ฟิลด์ประเภทความสัมพันธ์

ข้อมูลหลายรายการจะคั่นด้วยเครื่องหมายจุลภาค (`,` `，`) หรือเครื่องหมายวรรคตอน (`、`) ครับ/ค่ะ

| แผนก/ชื่อ | หมวดหมู่/หัวข้อ |
| -------- | --------------- |
| ทีมพัฒนา  | หมวดหมู่ 1, หมวดหมู่ 2 |

เมื่อแปลงเป็น JSON จะได้ดังนี้ครับ/ค่ะ

```ts
{
  "Department": [1], // 1 คือ ID ของเรคคอร์ดแผนกที่มีชื่อว่า "ทีมพัฒนา"
  "Category": [1,2], // 1,2 คือ ID ของเรคคอร์ดหมวดหมู่ที่มีหัวข้อว่า "หมวดหมู่ 1" และ "หมวดหมู่ 2"
}
```

### ฟิลด์ประเภท JSON

| JSON1           |
| --------------- |
| {"key":"value"} |

เมื่อแปลงเป็น JSON จะได้ดังนี้ครับ/ค่ะ

```ts
{
  "JSON": {"key":"value"}
}
```

### ฟิลด์ประเภทรูปทรงเรขาคณิตบนแผนที่

| Point | Line        | Polygon           | Circle |
| ----- | ----------- | ----------------- | ------ |
| 1,2   | (1,2),(3,4) | (1,2),(3,4),(1,2) | 1,2,3  |

เมื่อแปลงเป็น JSON จะได้ดังนี้ครับ/ค่ะ

```ts
{
  "Point": [1,2],
  "Line": [[1,2], [3,4]],
  "Polygon": [[1,2], [3,4], [1,2]],
  "Circle": [1,2,3]
}
```

## รูปแบบการนำเข้าที่กำหนดเอง

คุณสามารถลงทะเบียน `ValueParser` ที่กำหนดเองได้ผ่านเมธอด `db.registerFieldValueParsers()` ครับ/ค่ะ ตัวอย่างเช่น:

```ts
import { BaseValueParser } from '@nocobase/database';

class PointValueParser extends BaseValueParser {
  async setValue(value) {
    if (Array.isArray(value)) {
      this.value = value;
    } else if (typeof value === 'string') {
      this.value = value.split(',');
    } else {
      this.errors.push('Value invalid');
    }
  }
}

const db = new Database();

// เมื่อนำเข้าฟิลด์ที่มี type=point ข้อมูลจะถูกแยกวิเคราะห์โดย PointValueParser
db.registerFieldValueParsers({
  point: PointValueParser,
});
```

ตัวอย่างการนำเข้า

| Point |
| ----- |
| 1,2   |

เมื่อแปลงเป็น JSON จะได้ดังนี้ครับ/ค่ะ

```ts
{
  "Point": [1,2]
}
```

## การตั้งค่าแอคชัน

![20251029170959](https://static-docs.nocobase.com/20251029170959.png)

- กำหนดค่าฟิลด์ที่สามารถนำเข้าได้

![20251029171036](https://static-docs.nocobase.com/20251029171036.png)

- [กฎการเชื่อมโยง](/interface-builder/actions/action-settings/linkage-rule): สำหรับแสดง/ซ่อนปุ่มแบบไดนามิกครับ/ค่ะ
- [แก้ไขปุ่ม](/interface-builder/actions/action-settings/edit-button): สำหรับแก้ไขชื่อ, ประเภท และไอคอนของปุ่มครับ/ค่ะ