:::tip
เอกสารนี้แปลโดย AI หากมีข้อมูลที่ไม่ถูกต้อง โปรดดู[เวอร์ชันภาษาอังกฤษ](/en)
:::


## คำถามที่พบบ่อยและวิธีแก้ไข

### 1. คอลัมน์และเซลล์ว่างในเทมเพลต Excel หายไปเมื่อเรนเดอร์

**ปัญหาที่พบ**: ในเทมเพลต Excel หากเซลล์ใดไม่มีเนื้อหาหรือสไตล์ อาจถูกลบออกในระหว่างการเรนเดอร์ ทำให้เซลล์นั้นหายไปจากเอกสารฉบับสุดท้ายครับ/ค่ะ

**วิธีแก้ไข**:

- **เติมสีพื้นหลัง**: กำหนดสีพื้นหลังให้กับเซลล์ว่างในพื้นที่เป้าหมาย เพื่อให้แน่ใจว่าเซลล์ยังคงมองเห็นได้ในระหว่างกระบวนการเรนเดอร์ครับ/ค่ะ
- **แทรกช่องว่าง**: ใส่ช่องว่าง (space character) ลงในเซลล์ว่าง เพื่อคงโครงสร้างของเซลล์ไว้ แม้ว่าจะไม่มีเนื้อหาจริงก็ตามครับ/ค่ะ
- **กำหนดเส้นขอบ**: เพิ่มสไตล์เส้นขอบให้กับตาราง เพื่อเน้นขอบเขตของเซลล์ และป้องกันไม่ให้เซลล์หายไปในระหว่างการเรนเดอร์ครับ/ค่ะ

**ตัวอย่าง**:

ในเทมเพลต Excel ให้กำหนดพื้นหลังสีเทาอ่อนสำหรับเซลล์เป้าหมายทั้งหมด และแทรกช่องว่างในเซลล์ที่ว่างเปล่าครับ/ค่ะ

### 2. เซลล์ที่ผสาน (Merged Cells) ไม่ทำงานเมื่อส่งออก

**ปัญหาที่พบ**: เมื่อใช้ฟังก์ชันวนซ้ำ (loop) เพื่อส่งออกตาราง หากมีเซลล์ที่ผสานอยู่ในเทมเพลต อาจทำให้ผลลัพธ์การเรนเดอร์ผิดปกติ เช่น เอฟเฟกต์การผสานหายไป หรือข้อมูลคลาดเคลื่อนครับ/ค่ะ

**วิธีแก้ไข**:

- **หลีกเลี่ยงการใช้เซลล์ที่ผสาน**: พยายามหลีกเลี่ยงการใช้เซลล์ที่ผสานในตารางที่ส่งออกด้วยการวนซ้ำ เพื่อให้แน่ใจว่าข้อมูลจะถูกเรนเดอร์อย่างถูกต้องครับ/ค่ะ
- **ใช้การจัดกึ่งกลางข้ามคอลัมน์**: หากต้องการให้ข้อความอยู่กึ่งกลางในแนวนอนข้ามหลายเซลล์ ให้ใช้ฟังก์ชัน "จัดกึ่งกลางข้ามคอลัมน์" (Center Across Selection) แทนการผสานเซลล์ครับ/ค่ะ
- **จำกัดตำแหน่งการผสานเซลล์**: หากจำเป็นต้องใช้เซลล์ที่ผสาน ให้ผสานเฉพาะด้านบนหรือด้านขวาของตารางเท่านั้น หลีกเลี่ยงการผสานด้านล่างหรือด้านซ้าย เพื่อป้องกันการสูญเสียเอฟเฟกต์การผสานในระหว่างการเรนเดอร์ครับ/ค่ะ

### 3. เนื้อหาที่อยู่ใต้พื้นที่เรนเดอร์แบบวนซ้ำทำให้รูปแบบผิดเพี้ยน

**ปัญหาที่พบ**: ในเทมเพลต Excel หากมีเนื้อหาอื่น ๆ (เช่น สรุปคำสั่งซื้อ, หมายเหตุ) อยู่ใต้พื้นที่วนซ้ำที่ขยายตัวตามรายการข้อมูล (เช่น รายละเอียดคำสั่งซื้อ) ในระหว่างการเรนเดอร์ แถวข้อมูลที่สร้างโดยการวนซ้ำจะขยายลงมาด้านล่าง ซึ่งจะทับหรือดันเนื้อหาคงที่ด้านล่าง ทำให้รูปแบบของเอกสารฉบับสุดท้ายผิดเพี้ยนและเนื้อหาซ้อนทับกันครับ/ค่ะ

**วิธีแก้ไข**:

  * **ปรับเลย์เอาต์ โดยวางพื้นที่วนซ้ำไว้ด้านล่างสุด**: นี่เป็นวิธีที่แนะนำมากที่สุดครับ/ค่ะ ให้วางพื้นที่ตารางที่ต้องการเรนเดอร์แบบวนซ้ำไว้ที่ด้านล่างสุดของเวิร์กชีตทั้งหมด ย้ายข้อมูลสรุป ลายเซ็น หรือข้อมูลอื่น ๆ ที่เคยอยู่ด้านล่างขึ้นไปไว้ด้านบนของพื้นที่วนซ้ำ วิธีนี้จะช่วยให้ข้อมูลที่วนซ้ำสามารถขยายลงมาได้อย่างอิสระโดยไม่กระทบกับองค์ประกอบอื่น ๆ ครับ/ค่ะ
  * **สำรองแถวว่างให้เพียงพอ**: หากจำเป็นต้องวางเนื้อหาไว้ใต้พื้นที่วนซ้ำ คุณสามารถประมาณจำนวนแถวสูงสุดที่การวนซ้ำอาจสร้างขึ้นได้ และแทรกแถวว่างจำนวนมากพอด้วยตนเองเพื่อเป็นบัฟเฟอร์ระหว่างพื้นที่วนซ้ำกับเนื้อหาด้านล่าง อย่างไรก็ตาม วิธีนี้มีความเสี่ยง หากข้อมูลจริงเกินจำนวนแถวที่ประมาณไว้ ปัญหาก็จะเกิดขึ้นอีกครั้งครับ/ค่ะ
  * **ใช้เทมเพลต Word**: หากข้อกำหนดของเลย์เอาต์ซับซ้อนและไม่สามารถแก้ไขได้ด้วยการปรับโครงสร้าง Excel ให้พิจารณาใช้เอกสาร Word เป็นเทมเพลตครับ/ค่ะ ตารางใน Word จะดันเนื้อหาด้านล่างลงไปโดยอัตโนมัติเมื่อจำนวนแถวเพิ่มขึ้น ซึ่งจะไม่มีปัญหาเรื่องเนื้อหาซ้อนทับกัน ทำให้เหมาะสำหรับการสร้างเอกสารแบบไดนามิกประเภทนี้มากกว่าครับ/ค่ะ

**ตัวอย่าง**:

**วิธีที่ผิด**: วางข้อมูล "สรุปคำสั่งซื้อ" ไว้ใต้ตาราง "รายละเอียดคำสั่งซื้อ" ที่มีการวนซ้ำทันทีครับ/ค่ะ
![20250820080712](https://static-docs.nocobase.com/20250820080712.png)

**วิธีที่ถูกต้อง 1 (ปรับเลย์เอาต์)**: ย้ายข้อมูล "สรุปคำสั่งซื้อ" ไปไว้ด้านบนของตาราง "รายละเอียดคำสั่งซื้อ" เพื่อให้พื้นที่วนซ้ำเป็นองค์ประกอบที่อยู่ด้านล่างสุดของหน้าครับ/ค่ะ
![20250820082226](https://static-docs.nocobase.com/20250820082226.png)

**วิธีที่ถูกต้อง 2 (สำรองแถวว่าง)**: สำรองแถวว่างจำนวนมากระหว่าง "รายละเอียดคำสั่งซื้อ" และ "สรุปคำสั่งซื้อ" เพื่อให้แน่ใจว่าเนื้อหาที่วนซ้ำมีพื้นที่เพียงพอสำหรับการขยายตัวครับ/ค่ะ
![20250820081510](https://static-docs.nocobase.com/20250820081510.png)

**วิธีที่ถูกต้อง 3**: ใช้เทมเพลต Word ครับ/ค่ะ

### 4. มีข้อความแจ้งเตือนข้อผิดพลาดขณะเรนเดอร์เทมเพลต

**ปัญหาที่พบ**: ในระหว่างกระบวนการเรนเดอร์เทมเพลต ระบบจะแสดงข้อความแจ้งเตือนข้อผิดพลาด ทำให้การเรนเดอร์ล้มเหลวครับ/ค่ะ

**สาเหตุที่เป็นไปได้**:

- **ข้อผิดพลาดของ Placeholder**: ชื่อ Placeholder ไม่ตรงกับฟิลด์ในชุดข้อมูล หรือมีข้อผิดพลาดทางไวยากรณ์ครับ/ค่ะ
- **ข้อมูลขาดหาย**: ชุดข้อมูลไม่มีฟิลด์ที่อ้างอิงในเทมเพลตครับ/ค่ะ
- **การใช้ Formatter ไม่ถูกต้อง**: พารามิเตอร์ของ Formatter ผิดพลาด หรือใช้ประเภทการจัดรูปแบบที่ไม่รองรับครับ/ค่ะ

**วิธีแก้ไข**:

- **ตรวจสอบ Placeholder**: ตรวจสอบให้แน่ใจว่าชื่อ Placeholder ในเทมเพลตตรงกับชื่อฟิลด์ในชุดข้อมูล และมีไวยากรณ์ที่ถูกต้องครับ/ค่ะ
- **ตรวจสอบชุดข้อมูล**: ยืนยันว่าชุดข้อมูลมีฟิลด์ทั้งหมดที่อ้างอิงในเทมเพลต และรูปแบบข้อมูลเป็นไปตามข้อกำหนดครับ/ค่ะ
- **ปรับ Formatter**: ตรวจสอบวิธีการใช้งาน Formatter ให้แน่ใจว่าพารามิเตอร์ถูกต้อง และใช้ประเภทการจัดรูปแบบที่รองรับครับ/ค่ะ

**ตัวอย่าง**:

**เทมเพลตที่ไม่ถูกต้อง**:
```
Order ID: {d.orderId}
Order Date: {d.orderDate:format('YYYY/MM/DD')}
Total Amount: {d.totalAmount:format('0.00')}
```

**ชุดข้อมูล**:
```json
{
  "orderId": "A123456789",
  "orderDate": "2025-01-01T10:00:00Z"
  // ขาดฟิลด์ totalAmount
}
```

**วิธีแก้ไข**: เพิ่มฟิลด์ `totalAmount` ลงในชุดข้อมูล หรือลบการอ้างอิงถึง `totalAmount` ออกจากเทมเพลตครับ/ค่ะ