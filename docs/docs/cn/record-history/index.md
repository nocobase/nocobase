---
pkg: '@nocobase/plugin-record-history'
---

# 历史记录

## 介绍

历史记录插件用于追踪数据的变更过程，自动保存新增、修改、删除操作的快照与差异记录，帮助用户快速回溯数据变化、审计操作行为。

![](https://static-docs.nocobase.com/202511011338499.png)

## 启用历史记录

### 添加数据表和字段

首先进入历史记录插件配置页面，添加需要记录操作历史的数据表和字段。为了提高记录效率，避免数据冗余，建议仅配置必要的数据表和字段，如唯一 ID, 创建日期、更新日期，创建人、更新人等字段，通常不需要记录。

![](https://static-docs.nocobase.com/202511011315010.png)

![](https://static-docs.nocobase.com/202511011316342.png)

### 同步历史数据快照

- 在启用历史记录前创建的数据，只有在第一次更新时生成快照后，后续变更才能被记录；因此首次更新或删除不会留下历史。
- 如果需要保留既有数据的历史，可以执行一次快照同步。
- 单表快照的数据量 = 记录数 × 需记录字段数。
- 若数据量庞大，建议通过数据范围筛选，仅同步重要数据。

![](https://static-docs.nocobase.com/202511011319386.png)

![](https://static-docs.nocobase.com/202511011319284.png)

点击“同步历史记录快照”按钮，设置需要同步的字段和数据范围，即可开始同步。

![](https://static-docs.nocobase.com/202511011320958.png)

同步任务会在后台排队进行，可以刷新列表查看任务是否完成。

## 使用历史记录区块

### 添加区块

选择历史记录区块，并选择数据表，可以添加对应数据表的历史记录区块

![](https://static-docs.nocobase.com/202511011323410.png)

![](https://static-docs.nocobase.com/202511011331667.png)

如果是在某个数据记录弹窗中添加历史记录区块，可以选择“当前记录”，添加针对数据记录的历史记录区块。

![](https://static-docs.nocobase.com/202511011338042.png)

![](https://static-docs.nocobase.com/202511011338499.png)

### 编辑描述文案模板

点击区块配置上的“编辑模板”，可以对操作记录的描述文案进行配置。

![](https://static-docs.nocobase.com/202511011340406.png)

目前支持对创建、更新、删除记录的描述文案分别配置；其中对于更新记录，还支持配置字段变更的描述文案，既支持统一配置，也支持对某个字段进行单独配置。

![](https://static-docs.nocobase.com/202511011346400.png)

在配置文案时可以使用变量。

![](https://static-docs.nocobase.com/202511011347163.png)

配置完成后，可以选择对“当前数据表的所有历史记录区块”生效或者“仅当前历史记录区块”生效。

![](https://static-docs.nocobase.com/202511011348885.png)
