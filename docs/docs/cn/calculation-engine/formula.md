# Formula.js

[Formula.js](http://formulajs.info/) 提供了大量兼容 Excel 的函数。

## 函数参考

### 日期

| Function | Definition | Example call | Parameters | Expected result |
| :--- | :--- | :--- | :--- | :--- |
| **DATE** | 根据给定的年、月和日创建日期。 | `DATE(2008, 7, 8)` | 年份（整数），月份（1-12），日期（1-31）。 | Tue Jul 08 2008 00:00:00 GMT-0700 (PDT) |
| **DATEVALUE** | 将文本格式的日期转换为日期序列号。 | `DATEVALUE('8/22/2011')` | 表示日期的文本字符串 | Mon Aug 22 2011 00:00:00 GMT-0700 (PDT) |
| **DAY** | 返回指定日期中的日部分。 | `DAY('15-Apr-11')` | 日期值或日期文本字符串。 | 15 |
| **DAYS** | 计算两个日期之间的天数。 | `DAYS('3/15/11', '2/1/11')` | 结束日期，开始日期。 | 42 |
| **DAYS360** | 基于一年360天计算两个日期间的天数。 | `DAYS360('1-Jan-11', '31-Dec-11')` | 起始日期，结束日期。 | 360 |
| **EDATE** | 返回指定月份数之前或之后的日期。 | `EDATE('1/15/11', -1)` | 起始日期，月份数（正数为将来，负数为过去）。 | Wed Dec 15 2010 00:00:00 GMT-0800 (PST) |
| **EOMONTH** | 返回指定月份数之前或之后的月末日期。 | `EOMONTH('1/1/11', -3)` | 起始日期，月份数（正数为将来，负数为过去）。 | Sun Oct 31 2010 00:00:00 GMT-0700 (PDT) |
| **HOUR** | 返回时间中的小时部分。 | `HOUR('7/18/2011 7:45:00 AM')` | 时间值或时间文本字符串。 | 7 |
| **MINUTE** | 返回时间中的分钟部分。 | `MINUTE('2/1/2011 12:45:00 PM')` | 时间值或时间文本字符串。 | 45 |
| **ISOWEEKNUM** | 返回一年中给定日期所在的ISO周数。 | `ISOWEEKNUM('3/9/2012')` | 日期值或日期文本字符串。 | 10 |
| **MONTH** | 返回指定日期中的月部分。 | `MONTH('15-Apr-11')` | 日期值或日期文本字符串。 | 4 |
| **NETWORKDAYS** | 计算两个日期间的工作日数，不包括周末和指定的假期。 | `NETWORKDAYS('10/1/2012', '3/1/2013', ['11/22/2012'])` | 开始日期，结束日期，可选假期数组。 | 109 |
| **NETWORKDAYSINTL** | 计算两个日期间的工作日数，允许自定义周末，并排除指定假期。 | `NETWORKDAYSINTL('1/1/2006', '2/1/2006', 7, ['1/2/2006'])` | 开始日期，结束日期，周末模式，可选假期数组。 | 23 |
| **NOW** | 返回当前日期和时间。 | `NOW()` | 无参数。 | Thu Feb 20 2020 23:02:55 GMT+0100 (Central European Standard Time) |
| **SECOND** | 返回时间中的秒部分。 | `SECOND('2/1/2011 4:48:18 PM')` | 时间值或时间文本字符串。 | 18 |
| **TIME** | 根据给定的小时、分钟和秒创建时间。 | `TIME(16, 48, 10)` | 小时（0-23），分钟（0-59），秒（0-59）。 | 0.7001157407407408 |
| **TIMEVALUE** | 将文本格式的时间转换为时间序列号。 | `TIMEVALUE('22-Aug-2011 6:35 AM')` | 文本字符串，表示时间。 | 0.2743055555555556 |
| **TODAY** | 返回今天的日期。 | `TODAY()` | 无参数。 | Thu Feb 20 2020 23:02:55 GMT+0100 (Central European Standard Time) |
| **WEEKDAY** | 返回一周中某一天的数字。 | `WEEKDAY('2/14/2008', 3)` | 日期值或日期文本字符串，返回类型（1-3）。 | 3 |
| **YEAR** | 返回指定日期中的年部分。 | `YEAR('7/5/2008')` | 日期值或日期文本字符串。 | 2008 |
| **WEEKNUM** | 返回一年中给定日期所在的周数。 | `WEEKNUM('3/9/2012', 2)` | 日期值或日期文本字符串，可选周开始日（1=星期日，2=星期一）。 | 11 |
| **WORKDAY** | 返回从起始日期起指定工作日数之前或之后的日期，不包括周末和指定的假期。 | `WORKDAY('10/1/2008', 151, ['11/26/2008', '12/4/2008'])` | 起始日期，工作日数，可选假期数组。 | Mon May 04 2009 00:00:00 GMT-0700 (PDT) |
| **WORKDAYINTL** | 返回从起始日期起指定工作日数之前或之后的日期，允许自定义周末，并排除指定假期。 | `WORKDAYINTL('1/1/2012', 30, 17)` | 起始日期，工作日数，周末模式。 | Sun Feb 05 2012 00:00:00 GMT-0800 (PST) |
| **YEARFRAC** | 计算两个日期之间的年分数。 | `YEARFRAC('1/1/2012', '7/30/2012', 3)` | 开始日期，结束日期，可选基础（日计数基准）。 | 0.5780821917808219 |

### 金融

| Function | Definition | Example call | Parameters | Expected result |
| :--- | :--- | :--- | :--- | :--- |
| **ACCRINT** | 计算定期支付利息的有价证券的应计利息。 | `ACCRINT('01/01/2011', '02/01/2011', '07/01/2014', 0.1, 1000, 1, 0)` | 起始日期，首次支付利息日期，结算日期，年利率，面值，期间数，基础。 | 350 |
| **CUMIPMT** | 计算一系列付款中累积的利息支付。 | `CUMIPMT(0.1/12, 30*12, 100000, 13, 24, 0)` | 利率，总期数，现值，开始期数，结束期数，支付类型（0=期末，1=期初）。 | -9916.77251395708 |
| **CUMPRINC** | 计算一系列付款中累积的本金支付。 | `CUMPRINC(0.1/12, 30*12, 100000, 13, 24, 0)` | 利率，总期数，现值，开始期数，结束期数，支付类型（0=期末，1=期初）。 | -614.0863271085149 |
| **DB** | 使用固定余额递减法计算折旧。 | `DB(1000000, 100000, 6, 1, 6)` | 成本，残值，使用寿命，期间，月份。 | 159500 |
| **DDB** | 使用双倍余额递减法或其他指定方法计算折旧。 | `DDB(1000000, 100000, 6, 1, 1.5)` | 成本，残值，使用寿命，期间，因子。 | 250000 |
| **DOLLARDE** | 将分数表示的价格转换为小数表示。 | `DOLLARDE(1.1, 16)` | 分数形式的美元价格，分母。 | 1.625 |
| **DOLLARFR** | 将小数表示的价格转换为分数表示。 | `DOLLARFR(1.625, 16)` | 小数形式的美元价格，分母。 | 1.1 |
| **EFFECT** | 计算实际年利率。 | `EFFECT(0.1, 4)` | 名义年利率，每年复利次数。 | 0.10381289062499977 |
| **FV** | 计算投资的未来价值。 | `FV(0.1/12, 10, -100, -1000, 0)` | 每期利率，期数，每期支付额，现值，支付类型（0=期末，1=期初）。 | 2124.874409194097 |
| **FVSCHEDULE** | 根据一系列复利率计算本金的未来价值。 | `FVSCHEDULE(100, [0.09,0.1,0.11])` | 本金，利率数组。 | 133.08900000000003 |
| **IPMT** | 计算特定期间内的利息支付。 | `IPMT(0.1/12, 6, 2*12, 100000, 1000000, 0)` | 每期利率，期间，总期数，现值，未来值，支付类型（0=期末，1=期初）。 | 928.8235718400465 |
| **IRR** | 计算内部收益率。 | `IRR([-75000,12000,15000,18000,21000,24000], 0.075)` | 现金流数组，估计值。 | 0.05715142887178447 |
| **ISPMT** | 计算特定期间内的利息支付（适用于贷款）。 | `ISPMT(0.1/12, 6, 2*12, 100000)` | 每期利率，期间，总期数，贷款金额。 | -625 |
| **MIRR** | 计算修正内部收益率。 | `MIRR([-75000,12000,15000,18000,21000,24000], 0.1, 0.12)` | 现金流数组，融资利率，再投资利率。 | 0.07971710360838036 |
| **NOMINAL** | 计算名义年利率。 | `NOMINAL(0.1, 4)` | 实际年利率，每年复利次数。 | 0.09645475633778045 |
| **NPER** | 计算达到目标值所需的期数。 | `NPER(0.1/12, -100, -1000, 10000, 0)` | 每期利率，每期支付额，现值，未来值，支付类型（0=期末，1=期初）。 | 63.39385422740764 |
| **NPV** | 计算一系列未来现金流的净现值。 | `NPV(0.1, -10000, 2000, 4000, 8000)` | 每期折现率，现金流数组。 | 1031.3503176012546 |
| **PDURATION** | 计算达到特定值所需的时间。 | `PDURATION(0.1, 1000, 2000)` | 每期利率，现值，未来值。 | 7.272540897341714 |
| **PMT** | 计算贷款的每期支付额。 | `PMT(0.1/12, 2*12, 1000, 10000, 0)` | 每期利率，总期数，现值，未来值，支付类型（0=期末，1=期初）。 | -42426.08563793503 |
| **PPMT** | 计算特定期间内的本金支付。 | `PPMT(0.1/12, 6, 2*12, 100000, 1000000, 0)` | 每期利率，期间，总期数，现值，未来值，支付类型（0=期末，1=期初）。 | -43354.909209775076 |
| **PV** | 计算投资的现值。 | `PV(0.1/12, 2*12, 1000, 10000, 0)` | 每期利率，期数，每期支付额，未来值，支付类型（0=期末，1=期初）。 | -29864.950264779152 |
| **RATE** | 计算每期利率。 | `RATE(2*12, -1000, -10000, 100000, 0, 0.1)` | 总期数，每期支付额，现值，未来值，支付类型（0=期末，1=期初），估计值。 | 0.06517891177181533 |

### 工程

| Function | Definition | Example call | Parameters | Expected result |
| :--- | :--- | :--- | :--- | :--- |
| **BIN2DEC** | 将二进制数转换为十进制数。 | `BIN2DEC(101010)` | 二进制数值。 | 42 |
| **BIN2HEX** | 将二进制数转换为十六进制数。 | `BIN2HEX(101010)` | 二进制数值。 | 2a |
| **BIN2OCT** | 将二进制数转换为八进制数。 | `BIN2OCT(101010)` | 二进制数值。 | 52 |
| **BITAND** | 执行两个数字的按位与运算。 | `BITAND(42, 24)` | 整数，整数。 | 8 |
| **BITLSHIFT** | 对数字进行左移位操作。 | `BITLSHIFT(42, 24)` | 整数，移位量。 | 704643072 |
| **BITOR** | 执行两个数字的按位或运算。 | `BITOR(42, 24)` | 整数，整数。 | 58 |
| **BITRSHIFT** | 对数字进行右移位操作。 | `BITRSHIFT(42, 2)` | 整数，移位量。 | 10 |
| **BITXOR** | 执行两个数字的按位异或运算。 | `BITXOR(42, 24)` | 整数，整数。 | 50 |
| **COMPLEX** | 创建复数。 | `COMPLEX(3, 4)` | 实部，虚部。 | 3+4i |
| **CONVERT** | 在不同单位之间转换数值。 | `CONVERT(64, 'kibyte', 'bit')` | 数值，原始单位，目标单位。 | 524288 |
| **DEC2BIN** | 将十进制数转换为二进制数。 | `DEC2BIN(42)` | 十进制数值。 | 101010 |
| **DEC2HEX** | 将十进制数转换为十六进制数。 | `DEC2HEX(42)` | 十进制数值。 | 2a |
| **DEC2OCT** | 将十进制数转换为八进制数。 | `DEC2OCT(42)` | 十进制数值。 | 52 |
| **DELTA** | 测试两个值是否相等。 | `DELTA(42, 42)` | 数值，数值。 | 1 |
| **ERF** | 计算误差函数。 | `ERF(1)` | 上限。 | 0.8427007929497149 |
| **ERFC** | 计算互补误差函数。 | `ERFC(1)` | 下限。 | 0.1572992070502851 |
| **GESTEP** | 测试一个数是否大于或等于另一个数。 | `GESTEP(42, 24)` | 数值，阈值。 | 1 |
| **HEX2BIN** | 将十六进制数转换为二进制数。 | `HEX2BIN('2a')` | 十六进制数值。 | 101010 |
| **HEX2DEC** | 将十六进制数转换为十进制数。 | `HEX2DEC('2a')` | 十六进制数值。 | 42 |
| **HEX2OCT** | 将十六进制数转换为八进制数。 | `HEX2OCT('2a')` | 十六进制数值。 | 52 |
| **IMABS** | 计算复数的绝对值（模）。 | `IMABS('3+4i')` | 复数。 | 5 |
| **IMAGINARY** | 返回复数的虚部。 | `IMAGINARY('3+4i')` | 复数。 | 4 |
| **IMARGUMENT** | 计算复数的幅角。 | `IMARGUMENT('3+4i')` | 复数。 | 0.9272952180016122 |
| **IMCONJUGATE** | 计算复数的共轭。 | `IMCONJUGATE('3+4i')` | 复数。 | 3-4i |
| **IMCOS** | 计算复数的余弦。 | `IMCOS('1+i')` | 复数。 | 0.8337300251311491-0.9888977057628651i |
| **IMCOSH** | 计算复数的双曲余弦。 | `IMCOSH('1+i')` | 复数。 | 0.8337300251311491+0.9888977057628651i |
| **IMCOT** | 计算复数的余切。 | `IMCOT('1+i')` | 复数。 | 0.21762156185440265-0.8680141428959249i |
| **IMCSC** | 计算复数的余割。 | `IMCSC('1+i')` | 复数。 | 0.6215180171704283-0.3039310016284264i |
| **IMCSCH** | 计算复数的双曲余割。 | `IMCSCH('1+i')` | 复数。 | 0.3039310016284264-0.6215180171704283i |
| **IMDIV** | 计算两个复数的除法。 | `IMDIV('1+2i', '3+4i')` | 被除复数，除复数。 | 0.44+0.08i |
| **IMEXP** | 计算复数的指数。 | `IMEXP('1+i')` | 复数。 | 1.4686939399158851+2.2873552871788423i |
| **IMLN** | 计算复数的自然对数。 | `IMLN('1+i')` | 复数。 | 0.3465735902799727+0.7853981633974483i |
| **IMLOG10** | 计算复数的以10为底的对数。 | `IMLOG10('1+i')` | 复数。 | 0.1505149978319906+0.3410940884604603i |
| **IMLOG2** | 计算复数的以2为底的对数。 | `IMLOG2('1+i')` | 复数。 | 0.5000000000000001+1.1330900354567985i |
| **IMPOWER** | 计算复数的幂。 | `IMPOWER('1+i', 2)` | 复数，幂次。 | 1.2246063538223775e-16+2.0000000000000004i |
| **IMPRODUCT** | 计算多个复数的乘积。 | `IMPRODUCT('1+2i', '3+4i', '5+6i')` | 复数数组。 | -85+20i |
| **IMREAL** | 返回复数的实部。 | `IMREAL('3+4i')` | 复数。 | 3 |
| **IMSEC** | 计算复数的正割。 | `IMSEC('1+i')` | 复数。 | 0.4983370305551868+0.591083841721045i |
| **IMSECH** | 计算复数的双曲正割。 | `IMSECH('1+i')` | 复数。 | 0.4983370305551868-0.591083841721045i |
| **IMSIN** | 计算复数的正弦。 | `IMSIN('1+i')` | 复数。 | 1.2984575814159773+0.6349639147847361i |
| **IMSINH** | 计算复数的双曲正弦。 | `IMSINH('1+i')` | 复数。 | 0.6349639147847361+1.2984575814159773i |
| **IMSQRT** | 计算复数的平方根。 | `IMSQRT('1+i')` | 复数。 | 1.0986841134678098+0.45508986056222733i |
| **IMSUB** | 计算两个复数的减法。 | `IMSUB('3+4i', '1+2i')` | 被减复数，减复数。 | 2+2i |
| **IMSUM** | 计算多个复数的和。 | `IMSUM('1+2i', '3+4i', '5+6i')` | 复数数组。 | 9+12i |
| **IMTAN** | 计算复数的正切。 | `IMTAN('1+i')` | 复数。 | 0.2717525853195117+1.0839233273386946i |
| **OCT2BIN** | 将八进制数转换为二进制数。 | `OCT2BIN('52')` | 八进制数值。 | 101010 |
| **OCT2DEC** | 将八进制数转换为十进制数。 | `OCT2DEC('52')` | 八进制数值。 | 42 |
| **OCT2HEX** | 将八进制数转换为十六进制数。 | `OCT2HEX('52')` | 八进制数值。 | 2a |

### 逻辑

| Function | Definition | Example call | Parameters | Expected result |
| :--- | :--- | :--- | :--- | :--- |
| **AND** | 当所有参数都为真时返回真，否则返回假。 | `AND(true, false, true)` | 参数是一个或多个逻辑值（布尔值），只有所有参数均为真时函数才返回真。 | |
| **FALSE** | 返回逻辑值假。 | `FALSE()` | 无参数。 | |
| **IF** | 根据条件的真假返回不同的值。 | `IF(true, 'Hello!', 'Goodbye!')` | 条件，条件为真时的值，条件为假时的值。 | Hello! |
| **IFS** | 检查多个条件，并返回第一个为真的结果值。 | `IFS(false, 'Hello!', true, 'Goodbye!')` | 多对条件和对应的值，成对出现。 | Goodbye! |
| **NOT** | 反转逻辑值，真变假，假变真。 | `NOT(true)` | 一个逻辑值（布尔值）。 | |
| **OR** | 当任一参数为真时返回真，否则返回假。 | `OR(true, false, true)` | 参数是一个或多个逻辑值（布尔值），只要有一个参数为真函数即返回真。 | |
| **SWITCH** | 根据表达式的值返回匹配的结果值，若无匹配则返回默认值。 | `SWITCH(7, 9, 'Nine', 7, 'Seven')` | 表达式，匹配值1，结果值1，...，[默认值]。 | Seven |
| **TRUE** | 返回逻辑值真。 | `TRUE()` | 无参数。 | |
| **XOR** | 当且仅当有奇数个参数为真时返回真，否则返回假。 | `XOR(true, false, true)` | 参数是一个或多个逻辑值（布尔值），有奇数个参数为真时返回真。 | |

### 数学

| Function | Definition | Example call | Parameters | Expected result |
| :--- | :--- | :--- | :--- | :--- |
| **ABS** | 返回数值的绝对值。 | `ABS(-4)` | 数值。 | 4 |
| **ACOS** | 计算反余弦值（弧度）。 | `ACOS(-0.5)` | 介于-1和1之间的数值。 | 2.0943951023931957 |
| **ACOSH** | 计算反双曲余弦值。 | `ACOSH(10)` | 大于等于1的数值。 | 2.993222846126381 |
| **ACOT** | 计算反正切值（弧度）。 | `ACOT(2)` | 任意数值。 | 0.46364760900080615 |
| **ACOTH** | 计算反双曲正切值。 | `ACOTH(6)` | 绝对值大于1的数值。 | 0.16823611831060645 |
| **AGGREGATE** | 执行聚合运算，忽略错误或隐藏行。 | `AGGREGATE(9, 4, [-5,15], [32,'Hello World!'])` | 函数号，选项，数组1，...，数组N。 | 10,32 |
| **ARABIC** | 将罗马数字转换为阿拉伯数字。 | `ARABIC('MCMXII')` | 罗马数字字符串。 | 1912 |
| **ASIN** | 计算反正弦值（弧度）。 | `ASIN(-0.5)` | 介于-1和1之间的数值。 | -0.5235987755982988 |
| **ASINH** | 计算反双曲正弦值。 | `ASINH(-2.5)` | 任意数值。 | -1.6472311463710965 |
| **ATAN** | 计算反正切值（弧度）。 | `ATAN(1)` | 任意数值。 | 0.7853981633974483 |
| **ATAN2** | 根据坐标计算反正切值（弧度）。 | `ATAN2(-1, -1)` | y坐标，x坐标。 | -2.356194490192345 |
| **ATANH** | 计算反双曲正切值。 | `ATANH(-0.1)` | 介于-1和1之间的数值。 | -0.10033534773107562 |
| **BASE** | 将数值转换为指定基数的文本表示。 | `BASE(15, 2, 10)` | 数值，基数，[最小长度]。 | 0000001111 |
| **CEILING** | 将数值向上舍入到最接近的倍数。 | `CEILING(-5.5, 2, -1)` | 数值，倍数，[模式]。 | -6 |
| **CEILINGMATH** | 将数值向上舍入，使用指定的倍数和方向。 | `CEILINGMATH(-5.5, 2, -1)` | 数值，[倍数]，[模式]。 | -6 |
| **CEILINGPRECISE** | 将数值向上舍入到最接近的倍数，不考虑符号。 | `CEILINGPRECISE(-4.1, -2)` | 数值，[倍数]。 | -4 |
| **COMBIN** | 计算组合数。 | `COMBIN(8, 2)` | 总数，选中数。 | 28 |
| **COMBINA** | 计算允许重复的组合数。 | `COMBINA(4, 3)` | 总数，选中数。 | 20 |
| **COS** | 计算余弦值（弧度）。 | `COS(1)` | 角度（弧度）。 | 0.5403023058681398 |
| **COSH** | 计算双曲余弦值。 | `COSH(1)` | 任意数值。 | 1.5430806348152437 |
| **COT** | 计算余切值（弧度）。 | `COT(30)` | 角度（弧度）。 | -0.15611995216165922 |
| **COTH** | 计算双曲余切值。 | `COTH(2)` | 任意数值。 | 1.0373147207275482 |
| **CSC** | 计算余割值（弧度）。 | `CSC(15)` | 角度（弧度）。 | 1.5377805615408537 |
| **CSCH** | 计算双曲余割值。 | `CSCH(1.5)` | 任意数值。 | 0.46964244059522464 |
| **DECIMAL** | 将文本形式的数字转换为十进制。 | `DECIMAL('FF', 16)` | 文本，基数。 | 255 |
| **ERF** | 计算误差函数。 | `ERF(1)` | 上限。 | 0.8427007929497149 |
| **ERFC** | 计算互补误差函数。 | `ERFC(1)` | 下限。 | 0.1572992070502851 |
| **EVEN** | 将数值向上舍入到最接近的偶数。 | `EVEN(-1)` | 数值。 | -2 |
| **EXP** | 计算e的幂次方。 | `EXP(1)` | 指数。 | 2.718281828459045 |
| **FACT** | 计算阶乘。 | `FACT(5)` | 非负整数。 | 120 |
| **FACTDOUBLE** | 计算双阶乘。 | `FACTDOUBLE(7)` | 非负整数。 | 105 |
| **FLOOR** | 将数值向下舍入到最接近的倍数。 | `FLOOR(-3.1)` | 数值，倍数。 | -4 |
| **FLOORMATH** | 将数值向下舍入，使用指定的倍数和方向。 | `FLOORMATH(-4.1, -2, -1)` | 数值，[倍数]，[模式]。 | -4 |
| **FLOORPRECISE** | 将数值向下舍入到最接近的倍数，不考虑符号。 | `FLOORPRECISE(-3.1, -2)` | 数值，[倍数]。 | -4 |
| **GCD** | 计算最大公约数。 | `GCD(24, 36, 48)` | 两个或多个整数。 | 12 |
| **INT** | 将数值向下取整为最接近的整数。 | `INT(-8.9)` | 数值。 | -9 |
| **ISEVEN** | 测试数值是否为偶数。 | `ISEVEN(-2.5)` | 数值。 | |
| **ISOCEILING** | 将数值向上舍入到最接近的倍数，遵循ISO标准。 | `ISOCEILING(-4.1, -2)` | 数值，[倍数]。 | -4 |
| **ISODD** | 测试数值是否为奇数。 | `ISODD(-2.5)` | 数值。 | |
| **LCM** | 计算最小公倍数。 | `LCM(24, 36, 48)` | 两个或多个整数。 | 144 |
| **LN** | 计算自然对数。 | `LN(86)` | 正值。 | 4.454347296253507 |
| **LOG** | 计算指定底数的对数。 | `LOG(8, 2)` | 数值，底数。 | 3 |
| **LOG10** | 计算以10为底的对数。 | `LOG10(100000)` | 正值。 | 5 |
| **MOD** | 计算两数相除的余数。 | `MOD(3, -2)` | 被除数，除数。 | -1 |
| **MROUND** | 将数值四舍五入到最接近的倍数。 | `MROUND(-10, -3)` | 数值，倍数。 | -9 |
| **MULTINOMIAL** | 计算多项式系数。 | `MULTINOMIAL(2, 3, 4)` | 两个或多个非负整数。 | 1260 |
| **ODD** | 将数值向上舍入到最接近的奇数。 | `ODD(-1.5)` | 数值。 | -3 |
| **POWER** | 计算幂次方。 | `POWER(5, 2)` | 底数，指数。 | 25 |
| **PRODUCT** | 计算多个数值的乘积。 | `PRODUCT(5, 15, 30)` | 一个或多个数值。 | 2250 |
| **QUOTIENT** | 计算两数相除的商，不包括余数。 | `QUOTIENT(-10, 3)` | 被除数，除数。 | -3 |
| **RADIANS** | 将角度转换为弧度。 | `RADIANS(180)` | 角度。 | 3.141592653589793 |
| **RAND** | 生成0到1之间的随机实数。 | `RAND()` | 无参数。 | [Random real number between 0 and 1] |
| **RANDBETWEEN** | 生成指定范围内的随机整数。 | `RANDBETWEEN(-1, 1)` | 下限，上限。 | [Random integer between bottom and top] |
| **ROUND** | 按指定位数四舍五入数值。 | `ROUND(626.3, -3)` | 数值，位数。 | 1000 |
| **ROUNDDOWN** | 将数值向下舍入到指定位数。 | `ROUNDDOWN(-3.14159, 2)` | 数值，位数。 | -3.14 |
| **ROUNDUP** | 将数值向上舍入到指定位数。 | `ROUNDUP(-3.14159, 2)` | 数值，位数。 | -3.15 |
| **SEC** | 计算正割值（弧度）。 | `SEC(45)` | 角度（弧度）。 | 1.9035944074044246 |
| **SECH** | 计算双曲正割值。 | `SECH(45)` | 任意数值。 | 5.725037161098787e-20 |
| **SIGN** | 返回数值的符号。 | `SIGN(-0.00001)` | 数值。 | -1 |
| **SIN** | 计算正弦值（弧度）。 | `SIN(1)` | 角度（弧度）。 | 0.8414709848078965 |
| **SINH** | 计算双曲正弦值。 | `SINH(1)` | 任意数值。 | 1.1752011936438014 |
| **SQRT** | 计算平方根。 | `SQRT(16)` | 非负数值。 | 4 |
| **SQRTPI** | 计算数值与π的乘积的平方根。 | `SQRTPI(2)` | 非负数值。 | 2.5066282746310002 |
| **SUBTOTAL** | 计算子集的汇总值，忽略隐藏行。 | `SUBTOTAL(9, [-5,15], [32,'Hello World!'])` | 函数号，数组1，...，数组N。 | 10,32 |
| **SUM** | 计算数值总和，忽略文本。 | `SUM(-5, 15, 32, 'Hello World!')` | 一个或多个数值。 | 42 |
| **SUMIF** | 根据条件求和。 | `SUMIF([2,4,8,16], '>5')` | 数组，条件。 | 24 |
| **SUMIFS** | 根据多个条件求和。 | `SUMIFS([2,4,8,16], [1,2,3,4], '>=2', [1,2,4,8], '<=4')` | 求和数组，条件数组1，条件1，...，条件数组N，条件N。 | 12 |
| **SUMPRODUCT** | 计算数组元素的乘积之和。 | `SUMPRODUCT([[1,2],[3,4]], [[1,0],[0,1]])` | 两个或多个数组。 | 5 |
| **SUMSQ** | 计算数值的平方和。 | `SUMSQ(3, 4)` | 一个或多个数值。 | 25 |
| **SUMX2MY2** | 计算两个数组对应元素平方差之和。 | `SUMX2MY2([1,2], [3,4])` | 数组1，数组2。 | -20 |
| **SUMX2PY2** | 计算两个数组对应元素平方和之和。 | `SUMX2PY2([1,2], [3,4])` | 数组1，数组2。 | 30 |
| **SUMXMY2** | 计算两个数组对应元素差的平方和。 | `SUMXMY2([1,2], [3,4])` | 数组1，数组2。 | 8 |
| **TAN** | 计算正切值（弧度）。 | `TAN(1)` | 角度（弧度）。 | 1.5574077246549023 |
| **TANH** | 计算双曲正切值。 | `TANH(-2)` | 任意数值。 | -0.9640275800758168 |
| **TRUNC** | 截断数值，不进行四舍五入。 | `TRUNC(-8.9)` | 数值，[位数]。 | -8 |

### 统计

| Function | Definition | Example call | Parameters | Expected result |
| :--- | :--- | :--- | :--- | :--- |
| **AVEDEV** | 计算平均绝对偏差。 | `AVEDEV([2,4], [8,16])` | 参数是数值数组，表示数据点。 | 4.5 |
| **AVERAGE** | 计算算术平均值。 | `AVERAGE([2,4], [8,16])` | 参数是数值数组，表示要平均的数据点。 | 7.5 |
| **AVERAGEA** | 计算包含文本和逻辑值在内的平均值。 | `AVERAGEA([2,4], [8,16])` | 参数是数值、文本或逻辑值的数组，所有非空值都将被计算。 | 7.5 |
| **AVERAGEIF** | 基于单个条件计算平均值。 | `AVERAGEIF([2,4,8,16], '>5', [1, 2, 3, 4])` | 第一个参数是数值数组，第二个参数是条件，第三个参数是可选的数值数组用于平均。 | 3.5 |
| **AVERAGEIFS** | 基于多个条件计算平均值。 | `AVERAGEIFS([2,4,8,16], [1,2,3,4], '>=2', [1,2,4,8], '<=4')` | 第一个参数是数值数组，后跟成对的条件数组和条件表达式。 | 6 |
| **BETADIST** | 计算累积贝塔概率密度函数。 | `BETADIST(2, 8, 10, true, 1, 3)` | 参数依次是值、α、β、累积标志、A（可选）和B（可选）。 | 0.6854705810117458 |
| **BETAINV** | 计算累积贝塔概率密度函数的反函数。 | `BETAINV(0.6854705810117458, 8, 10, 1, 3)` | 参数依次是概率、α、β、A（可选）和B（可选）。 | 1.9999999999999998 |
| **BINOMDIST** | 计算二项分布的概率。 | `BINOMDIST(6, 10, 0.5, false)` | 参数依次是试验次数、成功次数、成功概率、累积标志。 | 0.205078125 |
| **CORREL** | 计算两个数据集的相关系数。 | `CORREL([3,2,4,5,6], [9,7,12,15,17])` | 参数是两个数值数组，表示两个数据集。 | 0.9970544855015815 |
| **COUNT** | 计算数值单元格的数量。 | `COUNT([1,2], [3,4])` | 参数是数值数组或范围。 | 4 |
| **COUNTA** | 计算非空单元格的数量。 | `COUNTA([1, null, 3, 'a', '', 'c'])` | 参数是任意类型的数组或范围。 | 4 |
| **COUNTBLANK** | 计算空白单元格的数量。 | `COUNTBLANK([1, null, 3, 'a', '', 'c'])` | 参数是任意类型的数组或范围。 | 2 |
| **COUNTIF** | 基于条件计算单元格数量。 | `COUNTIF(['Caen', 'Melbourne', 'Palo Alto', 'Singapore'], 'a')` | 参数是数值或文本数组以及条件。 | 3 |
| **COUNTIFS** | 基于多个条件计算单元格数量。 | `COUNTIFS([2,4,8,16], [1,2,3,4], '>=2', [1,2,4,8], '<=4')` | 参数是成对的条件数组和条件表达式。 | 2 |
| **COVARIANCEP** | 计算总体协方差。 | `COVARIANCEP([3,2,4,5,6], [9,7,12,15,17])` | 参数是两个数值数组，表示两个数据集。 | 5.2 |
| **COVARIANCES** | 计算样本协方差。 | `COVARIANCES([2,4,8], [5,11,12])` | 参数是两个数值数组，表示两个数据集。 | 9.666666666666668 |
| **DEVSQ** | 计算偏差平方和。 | `DEVSQ([2,4,8,16])` | 参数是数值数组，表示数据点。 | 115 |
| **EXPONDIST** | 计算指数分布。 | `EXPONDIST(0.2, 10, true)` | 参数依次是值、λ、累积标志。 | 0.8646647167633873 |
| **FDIST** | 计算F概率分布。 | `FDIST(15.2069, 6, 4, false)` | 参数依次是值、自由度1、自由度2、累积标志。 | 0.0012237917087831735 |
| **FINV** | 计算F概率分布的反函数。 | `FINV(0.01, 6, 4)` | 参数依次是概率、自由度1、自由度2。 | 0.10930991412457851 |
| **FISHER** | 计算费舍尔变换。 | `FISHER(0.75)` | 参数是一个数值，表示相关系数。 | 0.9729550745276566 |
| **FISHERINV** | 计算费舍尔逆变换。 | `FISHERINV(0.9729550745276566)` | 参数是一个数值，表示费舍尔变换的结果。 | 0.75 |
| **FORECAST** | 根据已知的x和y值预测新x值的y值。 | `FORECAST(30, [6,7,9,15,21], [20,28,31,38,40])` | 参数依次是新x值、已知y值数组、已知x值数组。 | 10.607253086419755 |
| **FREQUENCY** | 计算频数分布。 | `FREQUENCY([79,85,78,85,50,81,95,88,97], [70,79,89])` | 参数依次是数据数组、分组边界数组。 | 1,2,4,2 |
| **GAMMA** | 计算伽玛函数值。 | `GAMMA(2.5)` | 参数是一个正数。 | 1.3293403919101043 |
| **GAMMALN** | 计算伽玛函数的自然对数。 | `GAMMALN(10)` | 参数是一个正数。 | 12.801827480081961 |
| **GAUSS** | 计算标准正态分布下的概率。 | `GAUSS(2)` | 参数是一个数值，表示z分数。 | 0.4772498680518208 |
| **GEOMEAN** | 计算几何平均值。 | `GEOMEAN([2,4], [8,16])` | 参数是数值数组，表示数据点。 | 5.656854249492381 |
| **GROWTH** | 根据已知数据预测指数增长值。 | `GROWTH([2,4,8,16], [1,2,3,4], [5])` | 参数依次是已知y值数组、已知x值数组、新x值数组。 | 32.00000000000003 |
| **HARMEAN** | 计算调和平均值。 | `HARMEAN([2,4], [8,16])` | 参数是数值数组，表示数据点。 | 4.266666666666667 |
| **HYPGEOMDIST** | 计算超几何分布。 | `HYPGEOMDIST(1, 4, 8, 20, false)` | 参数依次是样本中成功的次数、样本大小、总体中成功的次数、总体大小、累积标志。 | 0.3632610939112487 |
| **INTERCEPT** | 计算线性回归的截距。 | `INTERCEPT([2,3,9,1,8], [6,5,11,7,5])` | 参数依次是已知y值数组、已知x值数组。 | 0.04838709677419217 |
| **KURT** | 计算峰度。 | `KURT([3,4,5,2,3,4,5,6,4,7])` | 参数是数值数组，表示数据点。 | -0.15179963720841627 |
| **LARGE** | 返回第k大的值。 | `LARGE([3,5,3,5,4,4,2,4,6,7], 3)` | 参数依次是数值数组、k值。 | 5 |
| **LINEST** | 执行线性回归分析。 | `LINEST([1,9,5,7], [0,4,2,3], true, true)` | 参数依次是已知y值数组、已知x值数组、是否返回附加统计信息、是否返回更多统计信息。 | 2,1 |
| **LOGNORMDIST** | 计算对数正态分布。 | `LOGNORMDIST(4, 3.5, 1.2, true)` | 参数依次是值、平均值、标准差、累积标志。 | 0.0390835557068005 |
| **LOGNORMINV** | 计算对数正态分布的反函数。 | `LOGNORMINV(0.0390835557068005, 3.5, 1.2, true)` | 参数依次是概率、平均值、标准差、累积标志。 | 4.000000000000001 |
| **MAX** | 返回最大值。 | `MAX([0.1,0.2], [0.4,0.8], [true, false])` | 参数是数值数组。 | 0.8 |
| **MAXA** | 返回包括文本和逻辑值的最大值。 | `MAXA([0.1,0.2], [0.4,0.8], [true, false])` | 参数是数值、文本或逻辑值的数组。 | 1 |
| **MEDIAN** | 返回中位数。 | `MEDIAN([1,2,3], [4,5,6])` | 参数是数值数组。 | 3.5 |
| **MIN** | 返回最小值。 | `MIN([0.1,0.2], [0.4,0.8], [true, false])` | 参数是数值数组。 | 0.1 |
| **MINA** | 返回包括文本和逻辑值的最小值。 | `MINA([0.1,0.2], [0.4,0.8], [true, false])` | 参数是数值、文本或逻辑值的数组。 | 0 |
| **MODEMULT** | 返回出现频率最高的值数组。 | `MODEMULT([1,2,3,4,3,2,1,2,3])` | 参数是数值数组。 | 2,3 |
| **MODESNGL** | 返回最常出现的单个值。 | `MODESNGL([1,2,3,4,3,2,1,2,3])` | 参数是数值数组。 | 2 |
| **NORMDIST** | 计算正态分布。 | `NORMDIST(42, 40, 1.5, true)` | 参数依次是值、平均值、标准差、累积标志。 | 0.9087887802741321 |
| **NORMINV** | 计算正态分布的反函数。 | `NORMINV(0.9087887802741321, 40, 1.5)` | 参数依次是概率、平均值、标准差。 | 42 |
| **NORMSDIST** | 计算标准正态分布。 | `NORMSDIST(1, true)` | 参数是一个数值，表示z分数。 | 0.8413447460685429 |
| **NORMSINV** | 计算标准正态分布的反函数。 | `NORMSINV(0.8413447460685429)` | 参数是一个概率值。 | 1.0000000000000002 |
| **PEARSON** | 计算皮尔逊乘积矩相关系数。 | `PEARSON([9,7,5,3,1], [10,6,1,5,3])` | 参数是两个数值数组，表示两个数据集。 | 0.6993786061802354 |
| **PERCENTILEEXC** | 计算排除百分位数。 | `PERCENTILEEXC([1,2,3,4], 0.3)` | 参数依次是数值数组、k值。 | 1.5 |
| **PERCENTILEINC** | 计算包含百分位数。 | `PERCENTILEINC([1,2,3,4], 0.3)` | 参数依次是数值数组、k值。 | 1.9 |
| **PERCENTRANKEXC** | 计算排除百分比排名。 | `PERCENTRANKEXC([1,2,3,4], 2, 2)` | 参数依次是数值数组、x值、显著性（可选）。 | 0.4 |
| **PERCENTRANKINC** | 计算包含百分比排名。 | `PERCENTRANKINC([1,2,3,4], 2, 2)` | 参数依次是数值数组、x值、显著性（可选）。 | 0.33 |
| **PERMUT** | 计算排列数。 | `PERMUT(100, 3)` | 参数依次是总数n、选择数k。 | 970200 |
| **PERMUTATIONA** | 计算允许重复的排列数。 | `PERMUTATIONA(4, 3)` | 参数依次是总数n、选择数k。 | 64 |
| **PHI** | 计算标准正态分布的密度函数。 | `PHI(0.75)` | 参数是一个数值，表示z分数。 | 0.30113743215480443 |
| **POISSONDIST** | 计算泊松分布。 | `POISSONDIST(2, 5, true)` | 参数依次是事件次数、平均值、累积标志。 | 0.12465201948308113 |
| **PROB** | 计算概率之和。 | `PROB([1,2,3,4], [0.1,0.2,0.2,0.1], 2, 3)` | 参数依次是数值数组、概率数组、下限、上限。 | 0.4 |
| **QUARTILEEXC** | 计算排除四分位数。 | `QUARTILEEXC([1,2,3,4], 1)` | 参数依次是数值数组、quart值。 | 1.25 |
| **QUARTILEINC** | 计算包含四分位数。 | `QUARTILEINC([1,2,3,4], 1)` | 参数依次是数值数组、quart值。 | 1.75 |
| **RANKAVG** | 计算平均排名。 | `RANKAVG(4, [2,4,4,8,8,16], false)` | 参数依次是数值、数值数组、排序方式（升序/降序）。 | 4.5 |
| **RANKEQ** | 计算等于指定值的排名。 | `RANKEQ(4, [2,4,4,8,8,16], false)` | 参数依次是数值、数值数组、排序方式（升序/降序）。 | 4 |
| **RSQ** | 计算决定系数。 | `RSQ([9,7,5,3,1], [10,6,1,5,3])` | 参数是两个数值数组，表示两个数据集。 | 0.4891304347826088 |
| **SKEW** | 计算偏度。 | `SKEW([3,4,5,2,3,4,5,6,4,7])` | 参数是数值数组，表示数据点。 | 0.3595430714067974 |
| **SKEWP** | 计算基于总体的偏度。 | `SKEWP([3,4,5,2,3,4,5,6,4,7])` | 参数是数值数组，表示数据点。 | 0.303193339354144 |
| **SLOPE** | 计算线性回归的斜率。 | `SLOPE([1,9,5,7], [0,4,2,3])` | 参数依次是已知y值数组、已知x值数组。 | 2 |
| **SMALL** | 返回第k小的值。 | `SMALL([3,5,3,5,4,4,2,4,6,7], 3)` | 参数依次是数值数组、k值。 | 3 |
| **STANDARDIZE** | 将值标准化为z分数。 | `STANDARDIZE(42, 40, 1.5)` | 参数依次是值、平均值、标准差。 | 1.3333333333333333 |
| **STDEVA** | 计算包含文本和逻辑值的标准差。 | `STDEVA([2,4], [8,16], [true, false])` | 参数是数值、文本或逻辑值的数组。 | 6.013872850889572 |
| **STDEVP** | 计算总体标准差。 | `STDEVP([2,4], [8,16], [true, false])` | 参数是数值数组。 | 5.361902647381804 |
| **STDEVPA** | 计算基于总体并包含文本和逻辑值的标准差。 | `STDEVPA([2,4], [8,16], [true, false])` | 参数是数值、文本或逻辑值的数组。 | 5.489889697333535 |
| **STDEVS** | 计算样本标准差。 | `VARS([2,4], [8,16], [true, false])` | 参数是数值数组。 | 6.191391873668904 |
| **STEYX** | 计算预测值的标准误差。 | `STEYX([2,3,9,1,8,7,5], [6,5,11,7,5,4,4])` | 参数依次是已知y值数组、已知x值数组。 | 3.305718950210041 |
| **TINV** | 计算t分布的反函数。 | `TINV(0.9946953263673741, 1)` | 参数依次是概率、自由度。 | 59.99999999996535 |
| **TRIMMEAN** | 计算内部平均值。 | `TRIMMEAN([4,5,6,7,2,3,4,5,1,2,3], 0.2)` | 参数依次是数值数组、修剪比例。 | 3.7777777777777777 |
| **VARA** | 计算包含文本和逻辑值的方差。 | `VARA([2,4], [8,16], [true, false])` | 参数是数值、文本或逻辑值的数组。 | 36.16666666666667 |
| **VARP** | 计算总体方差。 | `VARP([2,4], [8,16], [true, false])` | 参数是数值数组。 | 28.75 |
| **VARPA** | 计算基于总体并包含文本和逻辑值的方差。 | `VARPA([2,4], [8,16], [true, false])` | 参数是数值、文本或逻辑值的数组。 | 30.13888888888889 |
| **VARS** | 计算样本方差。 | `VARS([2,4], [8,16], [true, false])` | 参数是数值数组。 | 38.333333333333336 |
| **WEIBULLDIST** | 计算韦伯分布。 | `WEIBULLDIST(105, 20, 100, true)` | 参数依次是值、α、β、累积标志。 | 0.9295813900692769 |
| **ZTEST** | 计算z检验的单尾概率。 | `ZTEST([3,6,7,8,6,5,4,2,1,9], 4)` | 参数依次是数值数组、假设平均值。 | 0.09057419685136381 |

### 文本

| Function | Definition | Example call | Parameters | Expected result |
| :--- | :--- | :--- | :--- | :--- |
| **CHAR** | 将数字代码转换为对应的字符。 | `CHAR(65)` | 参数是数字，表示字符的编码。 | A |
| **CLEAN** | 移除文本中的所有非打印字符。 | `CLEAN('Monthly report')` | 参数是包含要清理的文本字符串。 | Monthly report |
| **CODE** | 返回文本字符串中第一个字符的数字代码。 | `CODE('A')` | 参数是包含单个字符的文本字符串。 | 65 |
| **CONCATENATE** | 将多个文本字符串合并为一个字符串。 | `CONCATENATE('Andreas', ' ', 'Hauser')` | 参数是一个或多个要连接的文本字符串。 | Andreas Hauser |
| **EXACT** | 检查两个字符串是否完全相同，区分大小写。 | `EXACT('Word', 'word')` | 参数是两个要比较的文本字符串。 | |
| **FIND** | 从起始位置开始查找子字符串的位置。 | `FIND('M', 'Miriam McGovern', 3)` | 参数包括要查找的文本、源文本和可选的起始位置。 | 8 |
| **LEFT** | 从字符串左侧提取指定数量的字符。 | `LEFT('Sale Price', 4)` | 参数是文本字符串和要提取的字符数。 | Sale |
| **LEN** | 返回文本字符串中的字符数。 | `LEN('Phoenix, AZ')` | 参数是包含要计数的文本字符串。 | 11 |
| **LOWER** | 将所有字符转换为小写。 | `LOWER('E. E. Cummings')` | 参数是要转换的文本字符串。 | e. e. cummings |
| **MID** | 从字符串中间提取指定数量的字符。 | `MID('Fluid Flow', 7, 20)` | 参数是文本字符串、起始位置和要提取的字符数。 | Flow |
| **NUMBERVALUE** | 根据指定的分隔符将文本转换为数字。 | `NUMBERVALUE('2.500,27', ',', '.')` | 参数是文本字符串、小数分隔符和组分隔符。 | 2500.27 |
| **PROPER** | 将每个单词的首字母大写。 | `PROPER('this is a TITLE')` | 参数是要格式化的文本字符串。 | This Is A Title |
| **REPLACE** | 用新文本替换旧文本中的部分。 | `REPLACE('abcdefghijk', 6, 5, '*')` | 参数是原始文本、起始位置、要替换的字符数和新文本。 | abcde*k |
| **REPT** | 根据指定次数重复文本。 | `REPT('*-', 3)` | 参数是文本字符串和重复次数。 | *-*-*- |
| **RIGHT** | 从字符串右侧提取指定数量的字符。 | `RIGHT('Sale Price', 5)` | 参数是文本字符串和要提取的字符数。 | Price |
| **ROMAN** | 将阿拉伯数字转换为罗马数字。 | `ROMAN(499)` | 参数是要转换的阿拉伯数字。 | CDXCIX |
| **SEARCH** | 在文本中查找子字符串，不区分大小写。 | `SEARCH('margin', 'Profit Margin')` | 参数包括要查找的文本和源文本。 | 8 |
| **SUBSTITUTE** | 用新文本替换旧文本中的特定实例。 | `SUBSTITUTE('Quarter 1, 2011', '1', '2', 3)` | 参数是原始文本、旧文本、新文本和可选的替换实例。 | Quarter 1, 2012 |
| **T** | 如果参数是文本，则返回该文本；否则返回空字符串。 | `T('Rainfall')` | 参数可以是任何类型的数据。 | Rainfall |
| **TRIM** | 去除文本前后的空格，内部多于一个的空格保留为一个。 | `TRIM(' First Quarter Earnings ')` | 参数是要修剪的文本字符串。 | First Quarter Earnings |
| **TEXTJOIN** | 将多个文本项连接成一个字符串，使用指定的分隔符。 | `TEXTJOIN(' ', true, 'The', '', 'sun', 'will', 'come', 'up', 'tomorrow.')` | 参数是分隔符、忽略空值标志和要连接的文本项。 | The sun will come up tomorrow. |
| **UNICHAR** | 返回给定Unicode数字对应的字符。 | `UNICHAR(66)` | 参数是Unicode字符代码。 | B |
| **UNICODE** | 返回文本的第一个字符的Unicode数字。 | `UNICODE('B')` | 参数是包含单个字符的文本字符串。 | 66 |
| **UPPER** | 将所有字符转换为大写。 | `UPPER('total')` | 参数是要转换的文本字符串。 | TOTAL |
