---
pkg: "@nocobase/plugin-action-export-pro"
---

# 导出 Pro

## 介绍

导出 Pro 插件在普通导出功能的基础上提供了增强功能。

## 安装

此插件依赖异步任务管理插件，使用前需先开启异步任务管理插件。

## 功能增强

- 支持异步导出操作，独立线程执行，支持大量数据导出。
- 支持附件导出。

## 使用手册

### 导出模式配置

![20251029172829](https://static-docs.nocobase.com/20251029172829.png)

![20251029172914](https://static-docs.nocobase.com/20251029172914.png)


在导出按钮上，可以配置导出模式，可选的三种导出模式：

- 自动：根据导出时的数据量判断导出的模式，如果数据量小于 1000 条 （附件导出时为 100 条），则使用同步导出，如果数据量大于 1000 条（附件导出时为 100 条），则使用异步导出。
- 同步：使用同步导出，导出时会将会在主线程中运行，适合小规模数据，若在同步模式下执行大规模的数据导出，可能会导致系统阻塞、卡顿且无法处理其他用户的请求。
- 异步：使用异步导出，导出时将会在独立的后台线程中执行，不会阻塞当前系统的使用。

### 异步导出

在执行导出之后，导出的流程将在独立的后台线程中执行，无需用户手动配置。在用户界面中，执行导出操作后，右上方会显示当前正在执行的导出任务，并且实时展示任务进度。

![20251029173028](https://static-docs.nocobase.com/20251029173028.png)

导出结束后，可在导出任务中下载导出文件。

#### 并发导出
并发导出任务较多时，会受服务器配置的影响，从而导致系统响应变慢，所以推荐系统开发者配置最大任务导出并发数（默认为 3），当超过配置的并发数时，进入排队状态。
![20250505171706](https://static-docs.nocobase.com/20250505171706.png)

并发数配置方式：环境变量 ASYNC_TASK_MAX_CONCURRENCY=并发数

在不同配置与数据复杂度综合测试下，推荐并发数：
- 2核 CPU，并发数 3。
- 4核 CPU，并发数 5。

#### 关于性能 
当您发现导出过程异常缓慢（参考如下）时，可能是数据表结构导致的性能问题。

| 数据特征 | 索引类型 | 数据量 | 导出时长 |
|---------|---------|--------|---------|
| 无关系字段 | 主键/唯一约束 | 100万 | 3～6分钟 |  
| 无关系字段 | 普通索引 | 100万 | 6～10分钟 | 
| 无关系字段 | 联合索引(非唯一) | 100万 | 30分钟 | 
| 关系字段<br>(一对一，一对多，<br>多对一，多对多) | 主键/唯一约束 | 50万 | 15～30分钟 | 关系字段导致性能降低 |

为确保高效导出，建议您：
1. 数据表须满足以下条件：

| 条件类型 | 必要条件 | 其他说明 |
|---------|------------------------|------|
| 表结构（至少满足一项） | 有主键<br>有唯一约束<br>有索引（唯一、普通、联合） | 优先级：主键 > 唯一约束 > 索引
| 字段特性 | 主键/唯一约束/索引（其中之一）必须具有可排序特性，如：自增ID、雪花ID、UUID v1、时间戳、数字等<br>（注意：UUID v3/v4/v5、普通字符串等不可排序字段会影响性能） | 无 |

2. 减少不必要导出的字段，尤其是关系字段（关系字段导致性能问题仍在优化）
![20250506215940](https://static-docs.nocobase.com/20250506215940.png)
3. 已满足以上条件，仍有导出缓慢现象，可进行日志分析，或反馈至官方。
![20250505182122](https://static-docs.nocobase.com/20250505182122.png)


- [联动规则](/interface-builder/actions/action-settings/linkage-rule)：动态显示/隐藏按钮；
- [编辑按钮](/interface-builder/actions/action-settings/edit-button)：编辑按钮的标题、类型、图标；
