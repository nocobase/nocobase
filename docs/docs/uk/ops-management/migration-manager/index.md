---
pkg: '@nocobase/plugin-migration-manager'
---
:::tip Повідомлення про переклад ШІ
Ця документація була автоматично перекладена штучним інтелектом.
:::

# Менеджер міграцій

## Вступ

Менеджер міграцій допомагає переносити конфігурації застосунків з одного середовища в інше. Він зосереджений на міграції саме «конфігурацій застосунків». Якщо ж вам потрібна повна міграція даних, радимо скористатися [Менеджером резервного копіювання](../backup-manager/index.mdx) для створення резервної копії та відновлення всього застосунку.

## Встановлення

Менеджер міграцій залежить від [плагіна](../backup-manager/index.mdx) Менеджера резервного копіювання. Будь ласка, переконайтеся, що його вже встановлено та активовано.

## Процес та принципи роботи

Менеджер міграцій переносить таблиці та дані з основної бази даних згідно з визначеними правилами міграції, переміщуючи їх з одного екземпляра застосунку в інший. Зверніть увагу, що він не переносить дані із зовнішніх баз даних або підзастосунків.

![20250102202546](https://static-docs.nocobase.com/20250102202546.png)

## Правила міграції

### Вбудовані правила

Менеджер міграцій може переносити всі таблиці в основній базі даних і підтримує п'ять вбудованих правил:

-   **Лише структура**: Переносить лише структуру (схему) таблиць — дані не вставляються та не оновлюються.
-   **Перезаписати (очистити та вставити заново)**: Видаляє всі наявні записи з цільової таблиці бази даних, а потім вставляє нові дані.
-   **Вставити або оновити (Upsert)**: Перевіряє, чи існує кожен запис (за первинним ключем). Якщо існує, оновлює його; якщо ні — вставляє.
-   **Вставити, ігноруючи дублікати (Insert-ignore)**: Вставляє нові записи, але якщо запис вже існує (за первинним ключем), вставка ігнорується (оновлення не відбувається).
-   **Пропустити**: Повністю пропускає обробку таблиці (без змін структури, без міграції даних).

**Примітки:**

-   Правила «Перезаписати», «Вставити або оновити» та «Вставити, ігноруючи дублікати» також синхронізують зміни структури таблиці.
-   Якщо таблиця використовує автоінкрементний ID як первинний ключ або не має первинного ключа, правила «Вставити або оновити» та «Вставити, ігноруючи дублікати» не можуть бути застосовані.
-   Правила «Вставити або оновити» та «Вставити, ігноруючи дублікати» покладаються на первинний ключ для визначення, чи існує запис.

### Детальний дизайн

![20250102204909](https://static-docs.nocobase.com/20250102204909.png)

### Інтерфейс конфігурації

Налаштування правил міграції

![20250102205450](https://static-docs.nocobase.com/20250102205450.png)

Увімкнення незалежних правил

![20250107105005](https://static-docs.nocobase.com/20250107105005.png)

Вибір незалежних правил та таблиць, які оброблятимуться за поточними незалежними правилами

![20250107104644](https://static-docs.nocobase.com/20250107104644.png)

## Файли міграції

![20250102205844](https://static-docs.nocobase.com/20250102205844.png)

### Створення нової міграції

![20250102205857](https://static-docs.nocobase.com/20250102205857.png)

### Виконання міграції

![20250102205915](https://static-docs.nocobase.com/20250102205915.png)

Перевірка змінних середовища застосунку (дізнайтеся більше про [Змінні середовища](#))

![20250102212311](https://static-docs.nocobase.com/20250102212311.png)

Якщо якісь змінні відсутні, з'явиться спливаюче вікно, яке запропонує користувачеві ввести необхідні нові змінні середовища, а потім продовжити.

![20250102210009](https://static-docs.nocobase.com/20250102210009.png)

## Журнали міграцій

![20250102205738](https://static-docs.nocobase.com/20250102205738.png)

## Відкат

Перед виконанням будь-якої міграції поточний застосунок автоматично створює резервну копію. Якщо міграція не вдалася або результати не відповідають очікуванням, ви можете відкотити зміни за допомогою [Менеджера резервного копіювання](../backup-manager/index.mdx).

![20250105195029](https://static-docs.nocobase.com/20250105195029.png)