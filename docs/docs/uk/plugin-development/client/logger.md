:::tip Повідомлення про переклад ШІ
Ця документація була автоматично перекладена штучним інтелектом.
:::


# Логер

NocoBase пропонує високопродуктивну систему логування, засновану на [pino](https://github.com/pinojs/pino). У будь-якому місці, де доступний `context`, ви можете отримати екземпляр логера через `ctx.logger` для запису ключових журналів під час виконання плагіна або системи.

## Основне використання

```ts
// Запис критичних помилок (наприклад, збій ініціалізації)
ctx.logger.fatal('Ініціалізація застосунку не вдалася', { error });

// Запис загальних помилок (наприклад, помилки запиту API)
ctx.logger.error('Не вдалося завантажити дані', { status, message });

// Запис попереджень (наприклад, ризики продуктивності або незвичайні дії користувача)
ctx.logger.warn('Поточна форма містить незбережені зміни');

// Запис загальної інформації про роботу (наприклад, компонент завантажено)
ctx.logger.info('Компонент профілю користувача завантажено');

// Запис налагоджувальної інформації (наприклад, зміни стану)
ctx.logger.debug('Поточний стан користувача', { user });

// Запис детальної інформації для трасування (наприклад, процес рендерингу)
ctx.logger.trace('Компонент відрендерено', { component: 'UserProfile' });
```

Ці методи відповідають різним рівням логування (від найвищого до найнижчого):

| Рівень | Метод | Опис |
|------|------|------|
| `fatal` | `ctx.logger.fatal()` | Критичні помилки, що зазвичай призводять до завершення роботи програми |
| `error` | `ctx.logger.error()` | Журнали помилок, що вказують на збій запиту або операції |
| `warn` | `ctx.logger.warn()` | Попереджувальна інформація, що сповіщає про потенційні ризики або неочікувані ситуації |
| `info` | `ctx.logger.info()` | Звичайна інформація про роботу |
| `debug` | `ctx.logger.debug()` | Налагоджувальна інформація для середовища розробки |
| `trace` | `ctx.logger.trace()` | Детальна інформація для трасування, зазвичай для глибокої діагностики |

## Формат логів

Кожен вивід логу має структурований формат JSON і за замовчуванням містить такі поля:

| Поле | Тип | Опис |
|------|------|------|
| `level` | number | Рівень логування |
| `time` | number | Мітка часу (мілісекунди) |
| `pid` | number | ID процесу |
| `hostname` | string | Ім'я хоста |
| `msg` | string | Повідомлення логу |
| Інші | object | Користувацька контекстна інформація |

Приклад виводу:

```json
{
  "level": 30,
  "time": 1730540153064,
  "pid": 12765,
  "hostname": "nocobase.local",
  "msg": "HelloModel rendered",
  "a": "a"
}
```

## Прив'язка контексту

`ctx.logger` автоматично вбудовує контекстну інформацію, таку як поточний плагін, модуль або джерело запиту, що дозволяє точніше відстежувати походження логів.

```ts
plugin.context.logger.info('Плагін ініціалізовано');
model.context.logger.error('Перевірка моделі не вдалася', { model: 'User' });
```

Приклад виводу (з контекстом):

```json
{
  "level": 30,
  "msg": "Plugin initialized",
  "plugin": "plugin-audit-trail"
}
```

## Користувацький логер

Ви можете створювати власні екземпляри логера в плагінах, успадковуючи або розширюючи конфігурації за замовчуванням:

```ts
const logger = ctx.logger.child({ module: 'MyPlugin' });
logger.info('Підмодуль запущено');
```

Дочірні логери успадковують конфігурацію основного логера та автоматично додають контекст.

## Ієрархія рівнів логування

Рівні логування Pino дотримуються числового визначення від найвищого до найнижчого, де менші числа вказують на нижчий пріоритет.  
Нижче наведено повну таблицю ієрархії рівнів логування:

| Назва рівня | Значення | Назва методу | Опис |
|-----------|--------|----------|------|
| `fatal` | 60 | `logger.fatal()` | Критичні помилки, що зазвичай призводять до неможливості продовження роботи програми |
| `error` | 50 | `logger.error()` | Загальні помилки, що вказують на збій запиту або винятки в операціях |
| `warn` | 40 | `logger.warn()` | Попереджувальна інформація, що сповіщає про потенційні ризики або неочікувані ситуації |
| `info` | 30 | `logger.info()` | Загальна інформація, що фіксує стан системи або нормальні операції |
| `debug` | 20 | `logger.debug()` | Налагоджувальна інформація для аналізу проблем на етапі розробки |
| `trace` | 10 | `logger.trace()` | Детальна інформація для трасування, для глибокої діагностики |
| `silent` | -Infinity | (без відповідного методу) | Вимкнути весь вивід логів |

Pino виводить лише ті логи, рівень яких більший або дорівнює поточному налаштуванню `level`. Наприклад, якщо рівень логування встановлено на `info`, логи `debug` та `trace` будуть ігноруватися.

## Найкращі практики у розробці плагінів

1.  **Використовуйте контекстний логер**  
    Використовуйте `ctx.logger` у контекстах плагінів, моделей або застосунків, щоб автоматично додавати інформацію про джерело.

2.  **Розрізняйте рівні логування**  
    - Використовуйте `error` для запису бізнес-винятків  
    - Використовуйте `info` для запису змін стану  
    - Використовуйте `debug` для запису налагоджувальної інформації під час розробки  

3.  **Уникайте надмірного логування**  
    Особливо на рівнях `debug` та `trace` рекомендується вмикати їх лише в середовищах розробки.

4.  **Використовуйте структуровані дані**  
    Передавайте об'єктні параметри замість об'єднання рядків, це допомагає в аналізі та фільтрації логів.

Дотримуючись цих практик, розробники можуть ефективніше відстежувати виконання плагінів, усувати проблеми та підтримувати структурованість і розширюваність системи логування.