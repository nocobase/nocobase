:::tip –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–µ—Ä–µ–∫–ª–∞–¥ –®–Ü
–¶—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è –±—É–ª–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–µ—Ä–µ–∫–ª–∞–¥–µ–Ω–∞ —à—Ç—É—á–Ω–∏–º —ñ–Ω—Ç–µ–ª–µ–∫—Ç–æ–º.
:::


# –ó–∞–ø–∏—Ç–∏

NocoBase –ø—Ä–æ–ø–æ–Ω—É—î `APIClient`, –ø–æ–±—É–¥–æ–≤–∞–Ω–∏–π –Ω–∞ –±–∞–∑—ñ [Axios](https://axios-http.com/), —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ HTTP-–∑–∞–ø–∏—Ç–∏ –∑ –±—É–¥—å-—è–∫–æ–≥–æ –º—ñ—Å—Ü—è, –¥–µ –¥–æ—Å—Ç—É–ø–Ω–∏–π `Context`.

–¢–∏–ø–æ–≤—ñ –º—ñ—Å—Ü—è, –¥–µ –º–æ–∂–Ω–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ `Context`, –≤–∫–ª—é—á–∞—é—Ç—å:

- `app.context`
- `engine.context`
- `plugin.context`
- `model.context`

## ctx.api.request()

`ctx.api.request()` ‚Äî —Ü–µ –Ω–∞–π–ø–æ—à–∏—Ä–µ–Ω—ñ—à–∏–π –º–µ—Ç–æ–¥ –¥–ª—è –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤. –ô–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ —Ç–∞ –∑–Ω–∞—á–µ–Ω–Ω—è, —â–æ –ø–æ–≤–µ—Ä—Ç–∞—é—Ç—å—Å—è, –ø–æ–≤–Ω—ñ—Å—Ç—é –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å [axios.request()](https://axios-http.com/docs/req_config).

```ts
request<T = any, R = AxiosResponse<T>, D = any>(
  config: AxiosRequestConfig<D>,
): Promise<R>;
```

–ë–∞–∑–æ–≤–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

```ts
await ctx.api.request({
  url: 'users:list',
  method: 'get',
});
```

–í–∏ –º–æ–∂–µ—Ç–µ –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –∑–∞–ø–∏—Ç—ñ–≤ Axios:

```ts
await ctx.api.request({
  url: 'users:create',
  method: 'post',
  data: {
    name: 'Tao Tao',
  },
});
```

## ctx.api.axios

`ctx.api.axios` ‚Äî —Ü–µ –µ–∫–∑–µ–º–ø–ª—è—Ä `AxiosInstance`, –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —è–∫–æ–≥–æ –≤–∏ –º–æ–∂–µ—Ç–µ –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –≥–ª–æ–±–∞–ª—å–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –∞–±–æ –¥–æ–¥–∞–≤–∞—Ç–∏ –ø–µ—Ä–µ—Ö–æ–ø–ª—é–≤–∞—á—ñ –∑–∞–ø–∏—Ç—ñ–≤.

–ó–º—ñ–Ω–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º

```ts
axios.defaults.headers.common['Authorization'] = AUTH_TOKEN;
axios.defaults.headers.post['Content-Type'] = 'application/x-www-form-urlencoded';
```

–î–æ–∫–ª–∞–¥–Ω—ñ—à–µ –ø—Ä–æ –¥–æ—Å—Ç—É–ø–Ω—ñ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –¥–∏–≤—ñ—Ç—å—Å—è –≤ [Axios Default Config](https://axios-http.com/docs/config_defaults).

## –ü–µ—Ä–µ—Ö–æ–ø–ª—é–≤–∞—á—ñ –∑–∞–ø–∏—Ç—ñ–≤ —Ç–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π

–ü–µ—Ä–µ—Ö–æ–ø–ª—é–≤–∞—á—ñ –¥–æ–∑–≤–æ–ª—è—é—Ç—å –æ–±—Ä–æ–±–ª—è—Ç–∏ –∑–∞–ø–∏—Ç–∏ –¥–æ —ó—Ö –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è –∞–±–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –ø—ñ—Å–ª—è —ó—Ö –æ—Ç—Ä–∏–º–∞–Ω–Ω—è. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –º–æ–∂–Ω–∞ —É–Ω—ñ—Ñ—ñ–∫–æ–≤–∞–Ω–æ –¥–æ–¥–∞–≤–∞—Ç–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∑–∞–ø–∏—Ç—ñ–≤, —Å–µ—Ä—ñ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –∞–±–æ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—Ç–∏ —î–¥–∏–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫–∏.

### –ü—Ä–∏–∫–ª–∞–¥ –ø–µ—Ä–µ—Ö–æ–ø–ª—é–≤–∞—á–∞ –∑–∞–ø–∏—Ç—ñ–≤

```ts
// –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è qs –¥–ª—è —Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ params
axios.interceptors.request.use((config) => {
  config.paramsSerializer = (params) =>
    qs.stringify(params, {
      strictNullHandling: true,
      arrayFormat: 'brackets',
    });
  return config;
});

// –í–ª–∞—Å–Ω—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∑–∞–ø–∏—Ç—ñ–≤
axios.interceptors.request.use((config) => {
  config.headers['Authorization'] = `Bearer token123`;
  config.headers['X-Hostname'] = 'localhost';
  config.headers['X-Timezone'] = '+08:00';
  config.headers['X-Locale'] = 'zh-CN';
  config.headers['X-Role'] = 'admin';
  config.headers['X-Authenticator'] = 'basic';
  config.headers['X-App'] = 'sub1';
  return config;
});
```

### –ü—Ä–∏–∫–ª–∞–¥ –ø–µ—Ä–µ—Ö–æ–ø–ª—é–≤–∞—á–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π

```ts
axios.interceptors.response.use(
  (response) => response,
  (error) => {
    // –£ —Ä–∞–∑—ñ –ø–æ–º–∏–ª–∫–∏ –∑–∞–ø–∏—Ç—É, –≤—ñ–¥–æ–±—Ä–∞–∑–∏—Ç–∏ —É–Ω—ñ—Ñ—ñ–∫–æ–≤–∞–Ω–µ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è
    ctx.notification.error({
      message: '–ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞ –∑–∞–ø–∏—Ç',
    });
    return Promise.reject(error);
  },
);
```

## –í–ª–∞—Å–Ω—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∑–∞–ø–∏—Ç—ñ–≤ NocoBase Server

–ù–∏–∂—á–µ –Ω–∞–≤–µ–¥–µ–Ω–æ –≤–ª–∞—Å–Ω—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∑–∞–ø–∏—Ç—ñ–≤, —è–∫—ñ –ø—ñ–¥—Ç—Ä–∏–º—É—î NocoBase Server. –á—Ö –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è —Å—Ü–µ–Ω–∞—Ä—ñ—ó–≤ –∑ –∫—ñ–ª—å–∫–æ–º–∞ –∑–∞—Å—Ç–æ—Å—É–Ω–∫–∞–º–∏, —ñ–Ω—Ç–µ—Ä–Ω–∞—Ü—ñ–æ–Ω–∞–ª—ñ–∑–∞—Ü—ñ—ó, –∫—ñ–ª—å–∫–æ–º–∞ —Ä–æ–ª—è–º–∏ –∞–±–æ –∫—ñ–ª—å–∫–æ–º–∞ –º–µ—Ç–æ–¥–∞–º–∏ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó.

| –ó–∞–≥–æ–ª–æ–≤–æ–∫           | –û–ø–∏—Å                                                  |
| ----------------- | ----------------------------------------------------- |
| `X-App`           | –í–∫–∞–∑—É—î –ø–æ—Ç–æ—á–Ω–∏–π –∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫ —É —Å—Ü–µ–Ω–∞—Ä—ñ—è—Ö –∑ –∫—ñ–ª—å–∫–æ–º–∞ –∑–∞—Å—Ç–æ—Å—É–Ω–∫–∞–º–∏ |
| `X-Locale`         | –ü–æ—Ç–æ—á–Ω–∞ –º–æ–≤–∞ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥: `zh-CN`, `en-US`)           |
| `X-Hostname`       | –Ü–º'—è —Ö–æ—Å—Ç–∞ –∫–ª—ñ—î–Ω—Ç–∞                                    |
| `X-Timezone`       | –ß–∞—Å–æ–≤–∏–π –ø–æ—è—Å –∫–ª—ñ—î–Ω—Ç–∞ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥: `+08:00`)           |
| `X-Role`           | –ü–æ—Ç–æ—á–Ω–∞ —Ä–æ–ª—å                                          |
| `X-Authenticator`  | –ú–µ—Ç–æ–¥ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞            |

> üí° **–ü—ñ–¥–∫–∞–∑–∫–∞**  
> –¶—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∑–∞–ø–∏—Ç—ñ–≤ –∑–∞–∑–≤–∏—á–∞–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤—Å—Ç–∞–≤–ª—è—é—Ç—å—Å—è –ø–µ—Ä–µ—Ö–æ–ø–ª—é–≤–∞—á–∞–º–∏, —Ç–æ–º—É —ó—Ö –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤—Å—Ç–∞–Ω–æ–≤–ª—é–≤–∞—Ç–∏ –≤—Ä—É—á–Ω—É. –õ–∏—à–µ –≤ –æ—Å–æ–±–ª–∏–≤–∏—Ö –≤–∏–ø–∞–¥–∫–∞—Ö (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —É —Ç–µ—Å—Ç–æ–≤–∏—Ö —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞—Ö –∞–±–æ —Å—Ü–µ–Ω–∞—Ä—ñ—è—Ö –∑ –∫—ñ–ª—å–∫–æ–º–∞ –µ–∫–∑–µ–º–ø–ª—è—Ä–∞–º–∏) —ó—Ö –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥–æ–¥–∞–≤–∞—Ç–∏ –≤—Ä—É—á–Ω—É.

## –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö

–£ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö React –≤–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –æ–±'—î–∫—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç—É –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `useFlowContext()` —ñ –ø–æ—Ç—ñ–º –≤–∏–∫–ª–∏–∫–∞—Ç–∏ `ctx.api` –¥–ª—è –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤.

```ts
import { useFlowContext } from '@nocobase/client';

const MyComponent = () => {
  const ctx = useFlowContext();

  const fetchData = async () => {
    const response = await ctx.api.request({
      url: '/api/posts',
      method: 'get',
    });
    console.log(response.data);
  };

  useEffect(() => {
    fetchData();
  }, []);

  return <div>–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</div>;
};
```

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∑ `useRequest` –≤—ñ–¥ ahooks

–£ —Ä–µ–∞–ª—å–Ω—ñ–π —Ä–æ–∑—Ä–æ–±—Ü—ñ –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ö—É–∫ `useRequest` –≤—ñ–¥ [ahooks](https://ahooks.js.org/hooks/use-request/index), —â–æ–± –∑—Ä—É—á–Ω—ñ—à–µ –∫–µ—Ä—É–≤–∞—Ç–∏ –∂–∏—Ç—Ç—î–≤–∏–º —Ü–∏–∫–ª–æ–º —Ç–∞ —Å—Ç–∞–Ω–æ–º –∑–∞–ø–∏—Ç—ñ–≤.

```ts
import { useFlowContext } from '@nocobase/client';
import { useRequest } from 'ahooks';

const MyComponent = () => {
  const ctx = useFlowContext();

  const { data, loading, error, refresh } = useRequest(() =>
    ctx.api.request({
      url: 'posts:list',
      method: 'get',
    }),
  );

  if (loading) return <div>–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</div>;
  if (error) return <div>–ü–æ–º–∏–ª–∫–∞ –∑–∞–ø–∏—Ç—É: {error.message}</div>;

  return (
    <div>
      <button onClick={refresh}>–û–Ω–æ–≤–∏—Ç–∏</button>
      <pre>{JSON.stringify(data?.data, null, 2)}</pre>
    </div>
  );
};
```

–¢–∞–∫–∏–π –ø—ñ–¥—Ö—ñ–¥ —Ä–æ–±–∏—Ç—å –ª–æ–≥—ñ–∫—É –∑–∞–ø–∏—Ç—ñ–≤ –±—ñ–ª—å—à –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–æ—é, –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∫–µ—Ä—É—é—á–∏ —Å—Ç–∞–Ω–∞–º–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è, –æ–±—Ä–æ–±–∫–æ—é –ø–æ–º–∏–ª–æ–∫ —Ç–∞ –ª–æ–≥—ñ–∫–æ—é –æ–Ω–æ–≤–ª–µ–Ω–Ω—è, —â–æ –¥—É–∂–µ –∑—Ä—É—á–Ω–æ –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö.