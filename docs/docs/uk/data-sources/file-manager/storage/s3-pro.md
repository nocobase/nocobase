---
pkg: "@nocobase/plugin-file-storage-s3-pro"
---
:::tip Повідомлення про переклад ШІ
Ця документація була автоматично перекладена штучним інтелектом.
:::



# Зберігання файлів: S3 (Pro)

## Вступ

Розширюючи можливості плагіна для керування файлами, ця версія додає підтримку типів зберігання, сумісних з протоколом S3. Ви можете легко інтегрувати будь-який сервіс об'єктного зберігання, що підтримує S3, наприклад, Amazon S3, Alibaba Cloud OSS, Tencent Cloud COS, MinIO, Cloudflare R2 та інші. Це значно підвищує сумісність та гнучкість ваших рішень для зберігання.

## Особливості

1. **Завантаження з клієнта:** Файли завантажуються безпосередньо в сервіс зберігання, минаючи сервер NocoBase. Це забезпечує більш ефективний та швидкий процес завантаження.

2. **Приватний доступ:** Усі URL-адреси файлів є тимчасовими авторизованими посиланнями з підписом, що гарантує безпечний та обмежений у часі доступ до файлів.

## Сценарії використання

1. **Керування таблицями файлів:** Централізоване керування та зберігання всіх завантажених файлів, підтримка різних типів файлів та методів зберігання для зручної класифікації та пошуку.

2. **Зберігання вкладень у полях:** Зберігання вкладень, завантажених через форми або записи, з можливістю їх асоціації з конкретними записами даних.

## Налаштування плагіна

1. Увімкніть плагін `plugin-file-storage-s3-pro`.

2. Перейдіть до "Setting -> FileManager", щоб отримати доступ до налаштувань керування файлами.

3. Натисніть кнопку "Add new" (Додати новий) та оберіть "S3 Pro".

![](https://static-docs.nocobase.com/20250102160704938.png)

4. У спливаючому вікні ви побачите детальну форму для заповнення. Зверніться до подальшої документації, щоб отримати відповідні параметри для вашого файлового сервісу та правильно ввести їх у форму.

![](https://static-docs.nocobase.com/20250413190828536.png)

## Налаштування постачальника послуг

### Amazon S3

#### Створення бакета

1. Відкрийте [консоль Amazon S3](https://ap-southeast-1.console.aws.amazon.com/s3/home).

2. Натисніть кнопку "Create bucket" (Створити бакет) у правій частині екрана.

![](https://static-docs.nocobase.com/file-storage-s3-pro-1735355969452.png)

3. Заповніть `Bucket Name` (Назва бакета), інші поля залиште за замовчуванням, прокрутіть сторінку донизу та натисніть кнопку **"Create"** (Створити), щоб завершити процес.

![](https://static-docs.nocobase.com/file-storage-s3-pro-1735355969622.png)

![](https://static-docs.nocobase.com/file-storage-s3-pro-1735355969811.png)

#### Налаштування CORS

1. У списку бакетів знайдіть і натисніть на щойно створений бакет, щоб перейти до його детальної сторінки.

![](https://static-docs.nocobase.com/file-storage-s3-pro-1735355969980.png)

2. Перейдіть на вкладку "Permission" (Дозволи) і прокрутіть униз до розділу налаштувань CORS.

![](https://static-docs.nocobase.com/file-storage-s3-pro-1735355970155.png)

![](https://static-docs.nocobase.com/file-storage-s3-pro-1735355970303.png)

3. Введіть наступну конфігурацію (за потреби можете її уточнити) та збережіть.

```json
[
    {
        "AllowedHeaders": [
            "*"
        ],
        "AllowedMethods": [
            "POST",
            "PUT"
        ],
        "AllowedOrigins": [
            "*"
        ],
        "ExposeHeaders": [
            "ETag"
        ],
        "MaxAgeSeconds": 3000
    }
]
```

![](https://static-docs.nocobase.com/file-storage-s3-pro-1735355970494.png)

#### Отримання AccessKey та SecretAccessKey

1. Натисніть кнопку "Security credentials" (Облікові дані безпеки) у верхньому правому куті сторінки.

![](https://static-docs.nocobase.com/file-storage-s3-pro-1735355970651.png)

2. Прокрутіть униз до розділу "Access Keys" (Ключі доступу) та натисніть кнопку "Create Access Key" (Створити ключ доступу).

![](https://static-docs.nocobase.com/file-storage-s3-pro-1735355970832.png)

3. Погодьтеся з умовами (тут демонструється використання основного облікового запису, але в робочому середовищі рекомендується використовувати IAM).

![](https://static-docs.nocobase.com/file-storage-s3-pro-1735355970996.png)

4. Збережіть відображені Access Key та Secret Access Key.

![](https://static-docs.nocobase.com/file-storage-s3-pro-1735355971168.png)

#### Отримання та налаштування параметрів

1. Використовуйте отримані `AccessKey ID` та `AccessKey Secret`.

2. Перейдіть на панель властивостей бакета, щоб знайти `Bucket Name` (Назва бакета) та `Region` (Регіон).

![](https://static-docs.nocobase.com/file-storage-s3-pro-1735355971345.png)

#### Публічний доступ (необов'язково)

Це необов'язкова конфігурація. Налаштуйте її, якщо вам потрібно зробити завантажені файли повністю публічними.

1. На панелі "Permissions" (Дозволи) прокрутіть до "Object Ownership" (Власність об'єктів), натисніть "Edit" (Редагувати) та увімкніть ACLs.

![](https://static-docs.nocobase.com/file-storage-s3-pro-1735355971508.png)

2. Прокрутіть до "Block public access" (Блокувати публічний доступ), натисніть "Edit" (Редагувати) та встановіть дозвіл на керування ACL.

![](https://static-docs.nocobase.com/file-storage-s3-pro-1735355971668.png)

3. У NocoBase встановіть прапорець "Public access" (Публічний доступ).

#### Налаштування мініатюр (необов'язково)

Ця конфігурація є необов'язковою і використовується, коли потрібно оптимізувати розмір або ефект попереднього перегляду зображень. **Зверніть увагу, що це розгортання може призвести до додаткових витрат. Для отримання детальної інформації про вартість зверніться до відповідних умов AWS.**

1. Відвідайте [Dynamic Image Transformation for Amazon CloudFront](https://aws.amazon.com/solutions/implementations/dynamic-image-transformation-for-amazon-cloudfront/?nc1=h_ls).

2. Натисніть кнопку `Launch in the AWS Console` (Запустити в консолі AWS) внизу сторінки, щоб розпочати розгортання рішення.
   ![](https://static-docs.nocobase.com/20250221164214117.png)

3. Дотримуйтесь підказок для завершення налаштування. Особливу увагу слід звернути на такі параметри:
   1. Під час створення стека вам потрібно буде вказати назву бакета Amazon S3, який містить вихідні зображення. Будь ласка, введіть назву бакета, який ви створили раніше.
   2. Якщо ви обрали розгортання демонстраційного інтерфейсу, після завершення розгортання ви зможете використовувати його для тестування функцій обробки зображень. У консолі AWS CloudFormation виберіть свій стек, перейдіть на вкладку "Outputs" (Виходи), знайдіть значення, що відповідає ключу `DemoUrl`, і натисніть на посилання, щоб відкрити демонстраційний інтерфейс.
   3. Це рішення використовує бібліотеку `sharp` Node.js для ефективної обробки зображень. Ви можете завантажити вихідний код з репозиторію GitHub та налаштувати його відповідно до своїх потреб.
   ![](https://static-docs.nocobase.com/20250221164315472.png)
   ![](https://static-docs.nocobase.com/20250221164404755.png)

4. Після завершення налаштування дочекайтеся, доки статус розгортання зміниться на `CREATE_COMPLETE`.

5. У налаштуваннях NocoBase зверніть увагу на наступне:
   1. `Thumbnail rule` (Правило мініатюр): Заповніть параметри обробки зображень, наприклад, `?width=100`. Детальніше дивіться в [документації AWS](https://docs.aws.amazon.com/solutions/latest/serverless-image-handler/use-supported-query-param-edits.html).
   2. `Access endpoint` (Кінцева точка доступу): Введіть значення з Outputs -> ApiEndpoint після розгортання.
   3. `Full access URL style` (Стиль URL повного доступу): Потрібно вибрати **Ignore** (Ігнорувати), оскільки назва бакета вже була вказана під час налаштування і не потрібна для доступу.
   ![](https://static-docs.nocobase.com/20250414152135514.png)

#### Приклад конфігурації

![](https://static-docs.nocobase.com/20250414152344959.png)

### Alibaba Cloud OSS

#### Створення бакета

1. Відкрийте [консоль OSS](https://oss.console.aliyun.com/overview).

![](https://static-docs.nocobase.com/file-storage-s3-pro-1735355972149.png)

2. Виберіть "Buckets" (Бакети) у лівому меню та натисніть кнопку "Create Bucket" (Створити бакет), щоб розпочати створення сховища.

![](https://static-docs.nocobase.com/file-storage-s3-pro-1735355972413.png)

3. Заповніть інформацію про бакет і натисніть кнопку "Create" (Створити).

   - `Bucket Name` (Назва бакета): Оберіть відповідно до ваших бізнес-потреб.
   - `Region` (Регіон): Оберіть найближчий регіон для ваших користувачів.
   - Інші налаштування можна залишити за замовчуванням або налаштувати за потреби.

![](https://static-docs.nocobase.com/file-storage-s3-pro-1735355972730.png)

#### Налаштування CORS

1. Перейдіть на сторінку деталей бакета, який ви щойно створили.

![](https://static-docs.nocobase.com/file-storage-s3-pro-1735355973018.png)

2. Натисніть "Content Security -> CORS" (Безпека контенту -> CORS) у центральному меню.

![](https://static-docs.nocobase.com/file-storage-s3-pro-1735355973319.png)

3. Натисніть кнопку "Create Rule" (Створити правило), заповніть відповідні поля, прокрутіть униз і натисніть "OK". Ви можете скористатися скріншотом нижче або налаштувати більш детальні параметри.

![](https://static-docs.nocobase.com/20250219171042784.png)

#### Отримання AccessKey та SecretAccessKey

1. Натисніть "AccessKey" під аватаром вашого облікового запису у верхньому правому куті.

![](https://static-docs.nocobase.com/file-storage-s3-pro-1735355973884.png)

2. Для демонстраційних цілей ми створимо AccessKey за допомогою основного облікового запису. У робочому середовищі рекомендується використовувати RAM для створення AccessKey. Інструкції можна знайти в [документації Alibaba Cloud](https://www.alibabacloud.com/help/en/ram/user-guide/create-an-accesskey-pair).

3. Натисніть кнопку "Create AccessKey" (Створити ключ доступу).

![](https://static-docs.nocobase.com/file-storage-s3-pro-1735355974171.png)

4. Пройдіть верифікацію облікового запису.

![](https://static-docs.nocobase.com/file-storage-s3-pro-1735355974509.png)

5. Збережіть відображені Access Key та Secret Access Key.

![](https://static-docs.nocobase.com/file-storage-s3-pro-1735355974781.png)

#### Отримання та налаштування параметрів

1. Використовуйте `AccessKey ID` та `AccessKey Secret`, отримані на попередньому кроці.

2. Перейдіть на сторінку деталей бакета, щоб отримати назву `Bucket` (Бакета).

![](https://static-docs.nocobase.com/file-storage-s3-pro-1735355975063.png)

3. Прокрутіть униз, щоб отримати `Region` (Регіон) (суфікс ".aliyuncs.com" не потрібен).

![](https://static-docs.nocobase.com/file-storage-s3-pro-1735355975437.png)

4. Отримайте адресу кінцевої точки та додайте префікс `https://` при введенні її в NocoBase.

![](https://static-docs.nocobase.com/file-storage-s3-pro-1735355975715.png)

#### Налаштування мініатюр (необов'язково)

Ця конфігурація є необов'язковою і використовується лише тоді, коли потрібно оптимізувати розмір або ефект попереднього перегляду зображень.

1. Заповніть відповідні параметри для `Thumbnail rule` (Правило мініатюр). Детальніше про налаштування параметрів дивіться в [документації Alibaba Cloud щодо обробки зображень](https://help.aliyun.com/zh/oss/user-guide/img-parameters/?spm=a2c4g.11186623.help-menu-31815.d_4_14_1_1.170243033CdbSm&scm=20140722.H_144582._.OR_help-T_cn~zh-V_1).

2. Залиште налаштування `Full upload URL style` (Стиль URL повного завантаження) та `Full access URL style` (Стиль URL повного доступу) однаковими.

#### Приклад конфігурації

![](https://static-docs.nocobase.com/20250414152525600.png)

### MinIO

#### Створення бакета

1. Натисніть меню **Buckets** (Бакети) ліворуч -> Натисніть **Create Bucket** (Створити бакет), щоб відкрити сторінку створення.
2. Введіть назву бакета, потім натисніть кнопку **Save** (Зберегти).

#### Отримання AccessKey та SecretAccessKey

1. Перейдіть до **Access Keys** (Ключі доступу) -> Натисніть кнопку **Create access key** (Створити ключ доступу), щоб відкрити сторінку створення.

![](https://static-docs.nocobase.com/20250106111922957.png)

2. Натисніть кнопку **Save** (Зберегти).

![](https://static-docs.nocobase.com/20250106111850639.png)

3. Збережіть **Access Key** та **Secret Key** зі спливаючого вікна для подальшого налаштування.

![](https://static-docs.nocobase.com/20250106112831483.png)

#### Налаштування параметрів

1. Перейдіть на сторінку **File manager** (Менеджер файлів) у NocoBase.

2. Натисніть кнопку **Add new** (Додати новий) та оберіть **S3 Pro**.

3. Заповніть форму:
   - **AccessKey ID** та **AccessKey Secret**: Використовуйте значення, збережені на попередньому кроці.
   - **Region** (Регіон): Приватно розгорнутий MinIO не має концепції регіону; ви можете встановити його як `"auto"`.
   - **Endpoint** (Кінцева точка): Введіть доменне ім'я або IP-адресу вашого розгорнутого сервісу.
   - Встановіть **Full access URL style** (Стиль URL повного доступу) на **Path-Style**.

#### Приклад конфігурації

![](https://static-docs.nocobase.com/20250414152700671.png)

### Tencent COS

Ви можете налаштувати його, посилаючись на вищезгадані файлові сервіси. Логіка налаштування схожа.

#### Приклад конфігурації

![](https://static-docs.nocobase.com/20250414153252872.png)

### Cloudflare R2

Ви можете налаштувати його, посилаючись на вищезгадані файлові сервіси. Логіка налаштування схожа.

#### Приклад конфігурації

![](https://static-docs.nocobase.com/20250414154500264.png)

## Посібник користувача

Зверніться до [документації плагіна file-manager](/data-sources/file-manager).