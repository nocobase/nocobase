---
pkg: "@nocobase/plugin-field-sort"
---
:::tip Повідомлення про переклад ШІ
Ця документація була автоматично перекладена штучним інтелектом.
:::

# Поле сортування

## Вступ

Поля сортування використовуються для впорядкування записів у колекції, підтримуючи сортування в межах груп.

:::warning
Оскільки поле сортування є частиною тієї ж колекції, запис не може бути призначений до кількох груп при використанні групового сортування.
:::

## Встановлення

Вбудований плагін, не потребує окремого встановлення.

## Посібник користувача

### Створення поля сортування

![20240409091123_rec_](https://static-docs.nocobase.com/20240409091123_rec_.gif)

При створенні полів сортування значення сортування будуть ініціалізовані:

- Якщо групове сортування не обрано, ініціалізація відбуватиметься на основі поля первинного ключа та поля дати створення.
- Якщо групове сортування обрано, дані спочатку будуть згруповані, а потім ініціалізація відбуватиметься на основі поля первинного ключа та поля дати створення.

:::warning{title="Пояснення щодо узгодженості транзакцій"}
- При створенні поля, якщо ініціалізація значення сортування не вдається, поле сортування не буде створено.
- У межах певного діапазону, якщо запис переміщується з позиції A в позицію B, значення сортування всіх записів між A і B зміняться. Якщо будь-яка частина цього оновлення не вдається, вся операція переміщення буде скасована, і значення сортування пов'язаних записів не зміняться.
:::

#### Приклад 1: Створення поля sort1

Поле sort1 не групується.

![20240409091510](https://static-docs.nocobase.com/20240409091510.png)

Поля сортування кожного запису будуть ініціалізовані на основі поля первинного ключа та поля дати створення:

![20240409092305](https://static-docs.nocobase.com/20240409092305.png)

#### Приклад 2: Створення поля sort2 на основі групування за Class ID

![20240409092620](https://static-docs.nocobase.com/20240409092620.png)

У цьому випадку всі записи в колекції спочатку будуть згруповані (за Class ID), а потім буде ініціалізовано поле сортування (sort2). Початкові значення кожного запису:

![20240409092847](https://static-docs.nocobase.com/20240409092847.png)

### Сортування перетягуванням

Поля сортування в основному використовуються для сортування записів у різних блоках за допомогою перетягування. Наразі сортування перетягуванням підтримують блоки таблиць та дошок (канбан).

:::warning
- Коли одне й те саме поле сортування використовується для сортування перетягуванням, використання його в кількох блоках може порушити існуючий порядок.
- Поле для сортування таблиць перетягуванням не може бути полем сортування з правилом групування.
  - Виняток: У блоці таблиці зв'язку «один-до-багатьох» зовнішній ключ може слугувати групою.
- Наразі лише блок дошки (канбан) підтримує сортування перетягуванням у межах груп.
:::

#### Сортування рядків таблиці перетягуванням

Блок таблиці

![20240409104621_rec_](https://static-docs.nocobase.com/20240409104621_rec_.gif)

Блок таблиці зв'язку

<video controls width="100%" src="https://static-docs.nocobase.com/20240409111903_rec_.mp4" title="Title"></video>

:::warning
У блоці зв'язку «один-до-багатьох»:

- Якщо вибрано негруповане поле сортування, то всі записи можуть брати участь у сортуванні.
- Якщо записи спочатку групуються за зовнішнім ключем, а потім сортуються, то правило сортування впливатиме лише на дані в межах поточної групи.

Кінцевий результат буде однаковим, але кількість записів, що беруть участь у сортуванні, відрізняється. Докладніше дивіться у розділі [Пояснення правил сортування](#пояснення-правил-сортування).
:::

#### Сортування карток дошки (канбан) перетягуванням

![20240409110423_rec_](https://static-docs.nocobase.com/20240409110423_rec_.gif)

### Пояснення правил сортування

#### Переміщення між негрупованими (або одногрупними) елементами

Припустимо, є набір даних:

```
[1,2,3,4,5,6,7,8,9]
```

Коли елемент, наприклад 5, переміщується вперед на позицію 3, змінюються лише позиції елементів 3, 4 та 5. Елемент 5 займає позицію 3, а елементи 3 і 4 зміщуються назад на одну позицію кожен.

```
[1,2,5,3,4,6,7,8,9]
```

Якщо потім перемістити елемент 6 назад на позицію 8, елемент 6 займає позицію 8, а елементи 7 і 8 зміщуються вперед на одну позицію кожен.

```
[1,2,5,3,4,7,8,6,9]
```

#### Переміщення елементів між різними групами

При груповому сортуванні, якщо запис переміщується до іншої групи, його групова приналежність також зміниться. Наприклад:

```
A: [1,2,3,4]
B: [5,6,7,8]
```

Коли елемент 1 переміщується після елемента 6 (поведінка за замовчуванням), його група також зміниться з A на B.

```
A: [2,3,4]
B: [5,6,1,7,8]
```

#### Зміни сортування не пов'язані з даними, що відображаються в інтерфейсі

Наприклад, розглянемо набір даних:

```
[1,2,3,4,5,6,7,8,9]
```

Інтерфейс відображає лише відфільтрований вигляд:

```
[1,5,9]
```

Коли елемент 1 переміщується на позицію елемента 9, позиції всіх проміжних елементів (2, 3, 4, 5, 6, 7, 8) також зміняться, навіть якщо вони невидимі.

```
[2,3,4,5,6,7,8,9,1]
```

Тепер інтерфейс відображає новий порядок на основі відфільтрованих елементів:

```
[5,9,1]
```