---
pkg: '@nocobase/plugin-workflow-date-calculation'
---
:::tip Повідомлення про переклад ШІ
Ця документація була автоматично перекладена штучним інтелектом.
:::

# Обчислення дати

## Вступ

Вузол обчислення дати надає дев'ять функцій обчислення, включаючи додавання та віднімання періоду часу, форматований вивід рядка часу та перетворення одиниць тривалості. Кожна функція має певні типи вхідних та вихідних значень, а також може отримувати результати інших вузлів як змінні параметри. Він використовує конвеєр обчислень для послідовного зв'язування результатів налаштованих функцій, щоб зрештою отримати очікуваний результат.

## Створення вузла

В інтерфейсі конфігурації робочого процесу натисніть кнопку плюса («+») у потоці, щоб додати вузол «Обчислення дати»:

![Обчислення дати Вузол_Створення вузла](https://static-docs.nocobase.com/[图片].png)

## Конфігурація вузла

![Обчислення дати Вузол_Конфігурація вузла](https://static-docs.nocobase.com/20240817184423.png)

### Вхідне значення

Вхідним значенням може бути змінна або константа дати. Змінна може бути даними, що запустили цей робочий процес, або результатом попереднього вузла в цьому робочому процесі. Для константи ви можете вибрати будь-яку дату.

### Тип вхідного значення

Визначає тип вхідного значення. Існує два можливих значення.

*   Тип «Дата»: означає, що вхідне значення може бути перетворене на тип дати й часу, наприклад, числовий штамп часу або рядок, що представляє час.
*   Тип «Число»: Оскільки тип вхідного значення впливає на вибір наступних кроків обчислення часу, необхідно правильно вибрати тип вхідного значення.

### Кроки обчислення

Кожен крок обчислення складається з функції обчислення та її конфігурації параметрів. Він використовує конвеєрну архітектуру, де результат обчислення попередньої функції слугує вхідним значенням для наступної функції. Таким чином, можна виконати серію обчислень і перетворень часу.

Після кожного кроку обчислення тип вихідних даних також фіксований і впливає на функції, доступні для наступного кроку обчислення. Обчислення може тривати лише за умови відповідності типів. В іншому випадку результат кроку буде кінцевим вихідним значенням вузла.

## Функції обчислення

### Додати період часу

-   Приймає тип вхідного значення: Дата
-   Параметри
    -   Кількість для додавання, яка може бути числом або вбудованою змінною вузла.
    -   Одиниця часу.
-   Тип вихідного значення: Дата
-   Приклад: Якщо вхідне значення `2024-7-15 00:00:00`, кількість `1`, а одиниця — «день», то результат обчислення буде `2024-7-16 00:00:00`.

### Відняти період часу

-   Приймає тип вхідного значення: Дата
-   Параметри
    -   Кількість для віднімання, яка може бути числом або вбудованою змінною вузла.
    -   Одиниця часу.
-   Тип вихідного значення: Дата
-   Приклад: Якщо вхідне значення `2024-7-15 00:00:00`, кількість `1`, а одиниця — «день», то результат обчислення буде `2024-7-14 00:00:00`.

### Обчислити різницю з іншим часом

-   Приймає тип вхідного значення: Дата
-   Параметри
    -   Дата, з якою потрібно обчислити різницю; це може бути константа дати або змінна з контексту робочого процесу.
    -   Одиниця часу.
    -   Чи брати абсолютне значення.
    -   Операція округлення: Можна вибрати збереження десяткових знаків, округлення до найближчого, округлення вгору та округлення вниз.
-   Тип вихідного значення: Число
-   Приклад: Якщо вхідне значення `2024-7-15 00:00:00`, об'єкт порівняння `2024-7-16 06:00:00`, одиниця — «день», абсолютне значення не береться, а десяткові знаки зберігаються, то результат обчислення буде `-1.25`.

:::info{title=Підказка}
При одночасній конфігурації абсолютного значення та округлення спочатку береться абсолютне значення, а потім застосовується округлення.
:::

### Отримати значення часу в певній одиниці

-   Приймає тип вхідного значення: Дата
-   Параметри
    -   Одиниця часу.
-   Тип вихідного значення: Число
-   Приклад: Якщо вхідне значення `2024-7-15 00:00:00`, а одиниця — «день», то результат обчислення буде `15`.

### Встановити дату на початок певної одиниці

-   Приймає тип вхідного значення: Дата
-   Параметри
    -   Одиниця часу.
-   Тип вихідного значення: Дата
-   Приклад: Якщо вхідне значення `2024-7-15 14:26:30`, а одиниця — «день», то результат обчислення буде `2024-7-15 00:00:00`.

### Встановити дату на кінець певної одиниці

-   Приймає тип вхідного значення: Дата
-   Параметри
    -   Одиниця часу.
-   Тип вихідного значення: Дата
-   Приклад: Якщо вхідне значення `2024-7-15 14:26:30`, а одиниця — «день», то результат обчислення буде `2024-7-15 23:59:59`.

### Перевірити на високосний рік

-   Приймає тип вхідного значення: Дата
-   Параметри
    -   Без параметрів
-   Тип вихідного значення: Булеве
-   Приклад: Якщо вхідне значення `2024-7-15 14:26:30`, то результат обчислення буде `true`.

### Форматувати як рядок

-   Приймає тип вхідного значення: Дата
-   Параметри
    -   Формат, дивіться [Day.js: Формат](https://day.js.org/docs/zh-CN/display/format)
-   Тип вихідного значення: Рядок
-   Приклад: Якщо вхідне значення `2024-7-15 14:26:30`, а формат `the time is YYYY/MM/DD HH:mm:ss`, то результат обчислення буде `the time is 2024/07/15 14:26:30`.

### Перетворити одиницю

-   Приймає тип вхідного значення: Число
-   Параметри
    -   Одиниця часу до перетворення.
    -   Одиниця часу після перетворення.
    -   Операція округлення: можна вибрати збереження десяткових знаків, округлення до найближчого, округлення вгору та округлення вниз.
-   Тип вихідного значення: Число
-   Приклад: Якщо вхідне значення `2`, одиниця до перетворення — «тиждень», одиниця після перетворення — «день», і десяткові знаки не зберігаються, то результат обчислення буде `14`.

## Приклад

![Обчислення дати Вузол_Приклад](https://static-docs.nocobase.com/20240817184137.png)

Припустимо, є акція, і ми хочемо, щоб при створенні кожного товару до його поля додавався час закінчення акції. Цей час закінчення — 23:59:59 останнього дня тижня, що настає після часу створення товару. Отже, ми можемо створити дві функції часу та запустити їх у конвеєрі:

-   Обчислити час для наступного тижня
-   Скинути результат до 23:59:59 останнього дня цього тижня

Таким чином, ми отримуємо бажане значення часу і передаємо його наступному вузлу, наприклад, вузлу модифікації колекції, щоб додати час закінчення акції до колекції.