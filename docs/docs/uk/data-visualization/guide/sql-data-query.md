:::tip Повідомлення про переклад ШІ
Ця документація була автоматично перекладена штучним інтелектом.
:::


# Запит даних у режимі SQL

На панелі "Запит даних" перейдіть у режим SQL, напишіть і виконайте запит, а потім безпосередньо використовуйте отриманий результат для відображення та рендерингу діаграм.

![20251027075805](https://static-docs.nocobase.com/20251027075805.png)

## Написання SQL-запитів
- На панелі "Запит даних" оберіть режим SQL.
- Введіть SQL-запит і натисніть "Виконати запит".
- Підтримуються складні SQL-запити, включно з багатотабличними JOIN та VIEW.

Приклад: сума замовлень за місяцями
```sql
SELECT 
  TO_CHAR(order_date, 'YYYY-MM') as mon,
  SUM(total_amount) AS total
FROM "order"
GROUP BY mon
ORDER BY mon ASC
LIMIT 100;
```

## Перегляд результатів
- Натисніть "Переглянути дані", щоб відкрити панель попереднього перегляду результатів.

![20251027080014](https://static-docs.nocobase.com/20251027080014.png)

Дані підтримують пагінацію; ви можете перемикатися між режимами Table (Таблиця) та JSON, щоб перевірити назви та типи стовпців.
![20251027080100](https://static-docs.nocobase.com/20251027080100.png)

## Мапування полів
- У налаштуваннях "Опції діаграми" виконайте мапування полів на основі стовпців результатів запиту.
- За замовчуванням перший стовпець автоматично використовується як вимір (вісь X або категорія), а другий — як показник (вісь Y або значення). Тому зверніть увагу на порядок стовпців у SQL-запиті:

```sql
SELECT 
  TO_CHAR(order_date, 'YYYY-MM') as mon, -- поле виміру в першому стовпці
  SUM(total_amount) AS total -- поле показника далі
```

![clipboard-image-1761524022](https://static-docs.nocobase.com/clipboard-image-1761524022.png)

## Використання контекстних змінних
Натисніть кнопку "x" у верхньому правому куті SQL-редактора, щоб обрати контекстні змінні.

![20251027081752](https://static-docs.nocobase.com/20251027081752.png)

Після підтвердження вираз змінної буде вставлено в позицію курсору (або замінить виділений текст) у SQL-запиті.

Наприклад, `{{ ctx.user.createdAt }}`. Зверніть увагу, не додавайте зайвих лапок.

![20251027081957](https://static-docs.nocobase.com/20251027081957.png)

## Більше прикладів
Більше прикладів використання можна знайти в [демо-застосунку NocoBase](https://demo3.sg.nocobase.com/admin/5xrop8s0bui).

**Рекомендації:**
- Стабілізуйте назви стовпців перед мапуванням на діаграми, щоб уникнути помилок у майбутньому.
- На етапі налагодження встановіть `LIMIT`, щоб зменшити кількість повернених рядків і прискорити попередній перегляд.

## Попередній перегляд, збереження та відкат
- Натисніть "Виконати запит", щоб запросити дані та оновити попередній перегляд діаграми.
- Натисніть "Зберегти", щоб зберегти поточний SQL-запит та пов'язані налаштування в базі даних.
- Натисніть "Скасувати", щоб повернутися до останнього збереженого стану та відкинути поточні незбережені зміни.