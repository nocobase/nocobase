:::tip Повідомлення про переклад ШІ
Ця документація була автоматично перекладена штучним інтелектом.
:::


# Синхронізація даних користувачів через HTTP API

## Отримання ключа API

Зверніться до розділу [Ключі API](/auth-verification/api-keys). Переконайтеся, що роль, призначена для ключа API, має необхідні дозволи для синхронізації даних користувачів.

## Огляд API

### Приклад

```bash
curl 'https://localhost:13000/api/userData:push' \
  -H 'Authorization: Bearer <token>' \
  --data-raw '{"dataType":"user","records":[]}' # Деталі тіла запиту дивіться нижче
```

### Кінцева точка

```bash
POST /api/userData:push
```

### Формат даних користувачів

#### UserData

| Параметр   | Тип                        | Опис                                                                                             |
| ---------- | -------------------------- | ------------------------------------------------------------------------------------------------ |
| `dataType` | `'user' \| 'department'`   | Обов'язковий. Тип даних, що надсилаються. Для надсилання даних користувачів використовуйте `user`. |
| `matchKey` | `'username' \| 'email' \| 'phone'` | Необов'язковий. Використовується для пошуку та зіставлення існуючих користувачів системи на основі вказаного поля. |
| `records`  | `UserRecord[]`             | Обов'язковий. Масив записів даних користувачів.                                                  |

#### UserRecord

| Параметр      | Тип        | Опис                                                                                                                              |
| ------------- | ---------- | --------------------------------------------------------------------------------------------------------------------------------- |
| `uid`         | `string`   | Обов'язковий. Унікальний ідентифікатор для вихідних даних користувача, що використовується для зв'язування вихідних даних із системним користувачем. Незмінний для одного користувача. |
| `nickname`    | `string`   | Необов'язковий. Псевдонім користувача.                                                                                            |
| `username`    | `string`   | Необов'язковий. Ім'я користувача.                                                                                                 |
| `email`       | `string`   | Необов'язковий. Електронна адреса користувача.                                                                                    |
| `phone`       | `string`   | Необов'язковий. Номер телефону користувача.                                                                                       |
| `departments` | `string[]` | Необов'язковий. Масив UID відділів, до яких належить користувач.                                                                  |
| `isDeleted`   | `boolean`  | Необов'язковий. Вказує, чи видалено запис.                                                                                        |
| `<field>`     | `any`      | Необов'язковий. Дані користувацьких полів у таблиці користувачів.                                                                 |

### Формат даних відділів

:::info
Для надсилання даних відділів необхідно, щоб плагін [Відділи](../../departments) був встановлений та активований.
:::

#### DepartmentData

| Параметр   | Тип                        | Опис                                                                                             |
| ---------- | -------------------------- | ------------------------------------------------------------------------------------------------ |
| `dataType` | `'user' \| 'department'`   | Обов'язковий. Тип даних, що надсилаються. Для даних відділів використовуйте `department`.        |
| `records`  | `DepartmentRecord[]`       | Обов'язковий. Масив записів даних відділів.                                                      |

#### DepartmentRecord

| Параметр    | Тип       | Опис                                                                                                                              |
| ----------- | --------- | --------------------------------------------------------------------------------------------------------------------------------- |
| `uid`       | `string`  | Обов'язковий. Унікальний ідентифікатор для вихідних даних відділу, що використовується для зв'язування вихідних даних із системним відділом. Незмінний. |
| `title`     | `string`  | Обов'язковий. Назва відділу.                                                                                                      |
| `parentUid` | `string`  | Необов'язковий. UID батьківського відділу.                                                                                        |
| `isDeleted` | `boolean` | Необов'язковий. Вказує, чи видалено запис.                                                                                        |
| `<field>`   | `any`     | Необов'язковий. Дані користувацьких полів у таблиці відділів.                                                                     |

:::info

1.  Багаторазове надсилання даних є ідемпотентною операцією.
2.  Якщо під час надсилання даних відділу батьківський відділ ще не створено, зв'язок не може бути встановлений. Ви можете надіслати дані повторно після створення батьківського відділу.
3.  Якщо під час надсилання даних користувача відповідний відділ ще не створено, користувач не може бути пов'язаний з цим відділом. Ви можете надіслати дані користувача повторно після надсилання даних відділу.
:::