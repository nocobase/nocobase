:::tip Повідомлення про переклад ШІ
Ця документація була автоматично перекладена штучним інтелектом.
:::


## Розширені можливості

### Нумерація сторінок

#### 1. Оновлення номерів сторінок

##### Синтаксис
Просто вставте у вашій Office програмі.

##### Приклад
У Microsoft Word:
- Використайте функцію "Вставка → Номер сторінки"  
У LibreOffice:
- Використайте функцію "Вставка → Поле → Номер сторінки"

##### Результат
У згенерованому звіті номери сторінок на кожній сторінці оновлюватимуться автоматично.


#### 2. Генерація змісту

##### Синтаксис
Просто вставте у вашій Office програмі.

##### Приклад
У Microsoft Word:
- Використайте функцію "Вставка → Індекс і таблиці → Зміст"  
У LibreOffice:
- Використайте функцію "Вставка → Зміст і покажчики → Зміст, покажчик або бібліографія"

##### Результат
Зміст звіту автоматично оновлюватиметься відповідно до вмісту документа.


#### 3. Повторення заголовків таблиць

##### Синтаксис
Просто вставте у вашій Office програмі.

##### Приклад
У Microsoft Word:
- Клацніть правою кнопкою миші на заголовку таблиці → Властивості таблиці → Поставте прапорець "Повторювати як рядок заголовка на кожній сторінці"  
У LibreOffice:
- Клацніть правою кнопкою миші на заголовку таблиці → Властивості таблиці → Вкладка "Потік тексту" → Поставте прапорець "Повторювати заголовок"

##### Результат
Коли таблиця займає кілька сторінок, заголовок автоматично повторюватиметься на початку кожної сторінки.


### Інтернаціоналізація (i18n)

#### 1. Переклад статичного тексту

##### Синтаксис
Використовуйте тег `{t(текст)}` для інтернаціоналізації статичного тексту:
```
{t(meeting)}
```

##### Приклад
У шаблоні:
```
{t(meeting)} {t(apples)}
```
У JSON-даних або зовнішньому словнику локалізації (наприклад, для "fr-fr") надаються відповідні переклади, наприклад, "meeting" → "rendez-vous", "apples" → "Pommes".

##### Результат
Під час генерації звіту текст буде замінено відповідним перекладом залежно від цільової мови.


#### 2. Переклад динамічного тексту

##### Синтаксис
Для вмісту даних можна використовувати форматер `:t`, наприклад:
```
{d.id:ifEQ(2):show({t(monday)}):elseShow({t(tuesday)})}
```

##### Приклад
У шаблоні:
```
{d.id:ifEQ(2):show({t(monday)}):elseShow({t(tuesday)})}
```
JSON-дані та словник локалізації надають відповідні переклади.

##### Результат
Залежно від умови, виводиться "lundi" або "mardi" (на прикладі цільової мови).


### Зіставлення ключ-значення

#### 1. Перетворення переліку (:convEnum)

##### Синтаксис
```
{дані:convEnum(ім'я_переліку)}
```
Наприклад:
```
0:convEnum('ORDER_STATUS')
```

##### Приклад
У прикладі опцій API передається наступне:
```json
{
  "enum": {
    "ORDER_STATUS": ["pending", "sent", "delivered"]
  }
}
```
У шаблоні:
```
0:convEnum('ORDER_STATUS')
```

##### Результат
Виводиться "pending"; якщо індекс виходить за межі переліку, виводиться вихідне значення.


### Динамічні зображення
:::info
Наразі підтримуються файли типів XLSX, DOCX
:::
Ви можете вставляти "динамічні зображення" у шаблони документів. Це означає, що зображення-заповнювачі у шаблоні автоматично замінюватимуться реальними зображеннями під час рендерингу на основі даних. Цей процес дуже простий і вимагає лише:

1. Вставити тимчасове зображення як заповнювач
2. Відредагувати "Альтернативний текст" цього зображення, щоб встановити мітку поля
3. Відрендерити документ, і система автоматично замінить його на фактичне зображення

Нижче ми розглянемо методи роботи для DOCX та XLSX на конкретних прикладах.


#### Вставка динамічних зображень у файли DOCX
##### Заміна одного зображення

1. Відкрийте свій DOCX-шаблон і вставте тимчасове зображення (це може бути будь-яке зображення-заповнювач, наприклад, [суцільне синє зображення](https://static-docs.nocobase.com/solid-color-image-2025-04-14-11-00-26.png))

:::info
**Інструкції щодо формату зображень**

- Наразі зображення-заповнювачі підтримують лише формат PNG. Рекомендуємо використовувати наш приклад [суцільного синього зображення](https://static-docs.nocobase.com/solid-color-image-2025-04-14-11-00-26.png)
- Цільові зображення для рендерингу підтримують лише формати PNG, JPG, JPEG. Інші типи зображень можуть не відрендеритися.

**Інструкції щодо розміру зображень**

Як для DOCX, так і для XLSX, кінцевий розмір зображення під час рендерингу відповідатиме розмірам тимчасового зображення у шаблоні. Тобто, фактичне зображення, яке буде вставлено, автоматично масштабуватиметься до розміру вставленого вами заповнювача. Якщо ви бажаєте, щоб відрендерене зображення мало розмір 150×150, будь ласка, використовуйте тимчасове зображення у шаблоні та налаштуйте його до цього розміру.
:::

2. Клацніть правою кнопкою миші на цьому зображенні, відредагуйте його "Альтернативний текст" (Alt Text) і введіть мітку поля зображення, яке ви хочете вставити, наприклад `{d.imageUrl}`:
   
![20250414211130-2025-04-14-21-11-31](https://static-docs.nocobase.com/20250414211130-2025-04-14-21-11-31.png)

3. Використайте наступні прикладні дані для рендерингу:
```json
{
  "name": "Apple",
  "imageUrl": "https://images.pexels.com/photos/206959/pexels-photo-206959.jpeg"
}
```

4. Після рендерингу тимчасове зображення буде замінено фактичним зображенням:

![20250414203444-2025-04-14-20-34-46](https://static-docs.nocobase.com/20250414203444-2025-04-14-20-34-46.png)

##### Заміна кількох зображень у циклі

Якщо ви хочете вставити групу зображень у шаблон, наприклад, список товарів, ви також можете реалізувати це за допомогою циклів. Конкретні кроки такі:
1. Припустімо, що ваші дані такі:
```json
{
  "products": [
    {
      "name": "Apple",
      "imageUrl": "https://images.pexels.com/photos/206959/pexels-photo-206959.jpeg"
    },
    {
      "name": "Banana",
      "imageUrl": "https://images.pexels.com/photos/61127/pexels-photo-61127.jpeg"
    }
  ]
}
```

2. У DOCX-шаблоні налаштуйте область циклу та вставте тимчасові зображення в кожен елемент циклу з альтернативним текстом, встановленим на `{d.products[i].imageUrl}`, як показано нижче:

![20250414205418-2025-04-14-20-54-19](https://static-docs.nocobase.com/20250414205418-2025-04-14-20-54-19.png)

3. Після рендерингу всі тимчасові зображення будуть замінені відповідними зображеннями з даних:
   
![20250414205503-2025-04-14-20-55-05](https://static-docs.nocobase.com/20250414205503-2025-04-14-20-55-05.png)

#### Вставка динамічних зображень у файли XLSX

Метод роботи в шаблонах Excel (XLSX) в основному такий самий, просто зверніть увагу на наступні моменти:

1. Після вставки зображення переконайтеся, що ви вибрали "зображення в комірці", а не зображення, що плаває над коміркою.

![20250414211643-2025-04-14-21-16-45](https://static-docs.nocobase.com/20250414211643-2025-04-14-21-16-45.png)

2. Після вибору комірки клацніть, щоб переглянути "Альтернативний текст" і ввести мітку поля, наприклад `{d.imageUrl}`.

### Штрих-коди
:::info
Наразі підтримуються файли типів XLSX, DOCX
:::

#### Генерація штрих-кодів (наприклад, QR-кодів)

Генерація штрих-кодів працює так само, як і динамічні зображення, і вимагає лише трьох кроків:

1. Вставте тимчасове зображення в шаблон, щоб позначити місце розташування штрих-коду
2. Відредагуйте "Альтернативний текст" зображення та введіть мітку поля формату штрих-коду, наприклад `{d.code:barcode(qrcode)}`, де `qrcode` — це тип штрих-коду (див. список підтримуваних нижче)

![20250414214626-2025-04-14-21-46-28](https://static-docs.nocobase.com/20250414214626-2025-04-14-21-46-28.png)

3. Після рендерингу це зображення-заповнювач буде автоматично замінено відповідним зображенням штрих-коду:
   
![20250414214925-2025-04-14-21-49-26](https://static-docs.nocobase.com/20250414214925-2025-04-14-21-49-26.png)

#### Підтримувані типи штрих-кодів

| Назва штрих-коду | Тип    |
| ---------------- | ------ |
| QR-код           | qrcode |