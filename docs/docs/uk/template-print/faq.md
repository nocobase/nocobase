:::tip Повідомлення про переклад ШІ
Ця документація була автоматично перекладена штучним інтелектом.
:::


## Поширені проблеми та їх вирішення

### 1. Порожні стовпці та клітинки в шаблонах Excel зникають у результатах рендерингу

**Опис проблеми**: В шаблонах Excel, якщо клітинка не містить жодного вмісту або стилю, вона може бути видалена під час рендерингу, що призведе до відсутності цієї клітинки у фінальному документі.

**Способи вирішення**:

-   **Заповніть фоновим кольором**: Застосуйте фоновий колір до порожніх клітинок у цільовій області, щоб вони залишалися видимими під час процесу рендерингу.
-   **Вставте пробіли**: Вставте символ пробілу в порожні клітинки, щоб зберегти їхню структуру, навіть якщо вони не містять фактичного вмісту.
-   **Налаштуйте межі**: Додайте стилі меж до таблиці, щоб підкреслити межі клітинок та запобігти їх зникненню під час рендерингу.

**Приклад**:

У шаблоні Excel встановіть світло-сірий фон для всіх цільових клітинок та вставте пробіли в порожні клітинки.

### 2. Об'єднані клітинки не працюють при виведенні

**Опис проблеми**: При використанні функції циклічного виведення таблиць, об'єднані клітинки в шаблоні можуть призвести до аномальних результатів рендерингу, таких як втрата ефекту об'єднання або зміщення даних.

**Способи вирішення**:

-   **Уникайте використання об'єднаних клітинок**: Намагайтеся не використовувати об'єднані клітинки в таблицях, що виводяться циклічно, щоб забезпечити коректний рендеринг даних.
-   **Використовуйте "Вирівняти по центру виділення"**: Якщо вам потрібно горизонтально вирівняти текст по центру кількох клітинок, використовуйте функцію "Вирівняти по центру виділення" замість об'єднання клітинок.
-   **Обмежте розташування об'єднаних клітинок**: Якщо використання об'єднаних клітинок є необхідним, об'єднуйте їх лише над таблицею або праворуч від неї, уникаючи об'єднання знизу або ліворуч, щоб запобігти втраті ефекту об'єднання під час рендерингу.

### 3. Вміст під областю циклічного рендерингу призводить до порушення форматування

**Опис проблеми**: В шаблонах Excel, якщо під областю циклічного рендерингу, яка динамічно розширюється залежно від елементів даних (наприклад, деталі замовлення), є інший вміст (наприклад, підсумок замовлення, примітки), то під час рендерингу згенеровані циклом рядки даних розширюватимуться вниз, безпосередньо перезаписуючи або зміщуючи статичний вміст, що знаходиться нижче. Це призводить до порушення форматування та накладання вмісту у фінальному документі.

**Способи вирішення**:

*   **Скоригуйте макет, розмістіть область циклу внизу**: Це найбільш рекомендований метод. Розмістіть область таблиці, яка потребує циклічного рендерингу, внизу всього робочого аркуша. Перемістіть всю інформацію, що спочатку знаходилася під нею (підсумок, підписи тощо), над областю циклу. Таким чином, циклічні дані зможуть вільно розширюватися вниз, не впливаючи на інші елементи.
*   **Зарезервуйте достатньо порожніх рядків**: Якщо вміст обов'язково має бути розміщений під областю циклу, ви можете оцінити максимальну кількість рядків, які може згенерувати цикл, і вручну вставити достатню кількість порожніх рядків як буфер між областю циклу та вмістом нижче. Однак цей метод має ризики: якщо фактичні дані перевищать оцінену кількість рядків, проблема виникне знову.
*   **Використовуйте шаблони Word**: Якщо вимоги до макета складні і їх неможливо вирішити шляхом коригування структури Excel, розгляньте можливість використання документів Word як шаблонів. Таблиці у Word автоматично зміщують вміст нижче при збільшенні кількості рядків, без проблем з накладанням вмісту, що робить їх більш придатними для створення таких динамічних документів.

**Приклад**:

**Неправильний підхід**: Розміщення інформації "Підсумок замовлення" безпосередньо під таблицею "Деталі замовлення", що генерується циклом.
![20250820080712](https://static-docs.nocobase.com/20250820080712.png)

**Правильний підхід 1 (Коригування макета)**: Перемістіть інформацію "Підсумок замовлення" над таблицею "Деталі замовлення", зробивши область циклу нижнім елементом сторінки.
![20250820082226](https://static-docs.nocobase.com/20250820082226.png)

**Правильний підхід 2 (Резервування порожніх рядків)**: Залиште багато порожніх рядків між "Деталями замовлення" та "Підсумком замовлення", щоб забезпечити достатній простір для розширення циклічного вмісту.
![20250820081510](https://static-docs.nocobase.com/20250820081510.png)

**Правильний підхід 3**: Використовуйте шаблони Word.

### 4. Під час рендерингу шаблону з'являються повідомлення про помилки

**Опис проблеми**: Під час рендерингу шаблону система відображає повідомлення про помилки, що призводить до збою рендерингу.

**Можливі причини**:

-   **Помилки в плейсхолдерах**: Назви плейсхолдерів не відповідають полям набору даних або містять синтаксичні помилки.
-   **Відсутність даних**: У наборі даних відсутні поля, на які посилається шаблон.
-   **Неправильне використання форматувальника**: Параметри форматувальника вказані невірно або використовується непідтримуваний тип форматування.

**Способи вирішення**:

-   **Перевірте плейсхолдери**: Переконайтеся, що назви плейсхолдерів у шаблоні відповідають назвам полів у наборі даних і мають правильний синтаксис.
-   **Перевірте набір даних**: Переконайтеся, що набір даних містить усі поля, на які посилається шаблон, і що формати даних відповідають вимогам.
-   **Налаштуйте форматувальники**: Перевірте методи використання форматувальників, переконайтеся, що параметри правильні, та використовуйте підтримувані типи форматування.

**Приклад**:

**Неправильний шаблон**:
```
Order ID: {d.orderId}
Order Date: {d.orderDate:format('YYYY/MM/DD')}
Total Amount: {d.totalAmount:format('0.00')}
```

**Набір даних**:
```json
{
  "orderId": "A123456789",
  "orderDate": "2025-01-01T10:00:00Z"
  // Відсутнє поле totalAmount
}
```

**Рішення**: Додайте поле `totalAmount` до набору даних або видаліть посилання на `totalAmount` із шаблону.